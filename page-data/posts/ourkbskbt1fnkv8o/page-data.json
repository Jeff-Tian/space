{"componentChunkName":"component---src-templates-post-js","path":"/posts/ourkbskbt1fnkv8o/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/ourkbskbt1fnkv8o","relativePath":"posts/ourkbskbt1fnkv8o","frontmatter":{"title":"使用 Keycloak 接管 SpringBoot 应用的用户认证功能","stackbit_url_path":"posts/ourkbskbt1fnkv8o","date":"2022-11-29T12:17:34","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p><a name=mIpkq></a></p>\n<h1>【问题与需求】</h1>\n<p>接手一个现有的 SpringBoot 应用，其已实现了用户登录功能，并且拥有自己的数据库存储，登录的方式是“用户名+密码”。现在希望将用户认证的部分迁移到 Keycloak，但是让用户完全无感知。</p>\n<p>也就是，继续使用原有的登录页面，用户继续输入原有的用户名和密码，但是 SpringBoot 服务不再做校验逻辑，而且委托给 Keycloak 完成。</p>\n<p><a name=h0c8f></a></p>\n<h1>【实施方案】</h1>\n<p><a name=FF0IX></a></p>\n<h2>一、将旧系统中的用户名和密码导入到 Keycloak 中</h2>\n<p>本文将重点介绍第二步。第一步，我们假设可以拿到系统中的所有明文用户名及密码，并且数量不多，那么可以通过 Keycloak 的添加用户界面去完成用户的导入。<br />添加用户的链接： <a href=\"https://keycloak.jiwai.win/auth/admin/master/console/#/create/user/UniHeart\">https://keycloak.jiwai.win/auth/admin/master/console/#/create/user/UniHeart</a><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.5945945945946%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2ElEQVR42nWRzU4TURiG5w4UK1BBsFBZqsHWSm28Da/AlZKRptOfmTk/M9Pa+LNwYbyButA7sFhL6B3IxqRuLYQGcOGKjXnMObUlLjzJk2/xfec97/sdZz27gSGzliWXu0cuPyGfL9haKGxRuL9FsViiVHpI8UHJYufM/N08m5s5bt2+Y3HmUgtcupzi+kqGiufhWSo0Gg28SoVut8vh4YjR6Afj8Zjx8bGtp6cnnP0849f5Od++DwnDECEETnpphdR8msz6TXzft40gCBBKU6nWODj4yn/Pb+DoiJPhkDhJiKIIZyG9zJWri6xmstRqNevMoLTG9wM6nQ6DwYBer0e/36e/94W9z/vs7n/iw+4rPgZ13rfbqChCSTlxaARvZLIzMeNQSmmp1+u4rov7zKW8U6bserjiMdsvH1FWT/FCQTXwEX+TOdeWV5lLTRxOxcwutNaWOI5JmgnNuEXSjJFvXeS7beKWJtFN4iiymLhm3plfXJpFNkJKqYs9CkEYhCgRIVo1/DdPCNseImnYKuMAJZW9Y9KYezayEV3LbiClso5MY4r5KPHCI3y9g44UWsYT9yqapTAYUcPModnh1JV5zUQIQ0E9qCKfN4hUQqRNNG17F/Vf/gBpJKvhTnkh2QAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/f09c68cd4ac1fc71d36bebdbee67e413/fcda8/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png\"\n        srcset=\"/static/f09c68cd4ac1fc71d36bebdbee67e413/12f09/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 148w,\n/static/f09c68cd4ac1fc71d36bebdbee67e413/e4a3f/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 295w,\n/static/f09c68cd4ac1fc71d36bebdbee67e413/fcda8/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 590w,\n/static/f09c68cd4ac1fc71d36bebdbee67e413/efc66/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 885w,\n/static/f09c68cd4ac1fc71d36bebdbee67e413/c83ae/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 1180w,\n/static/f09c68cd4ac1fc71d36bebdbee67e413/79538/1669722288754-a569c18d-6225-45de-82b4-f3442eeb4fee.png 2530w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>如果你现在知道更好的方式，欢迎留言告诉我。</p>\n<p><a name=I2Buf></a></p>\n<h2>二、将原有的登录校验功能改成调用 Keycloak 的 SPI 接口</h2>\n<p>建议先参考一下《 <a href=\"https://zhuanlan.zhihu.com/p/480816990\">Free Arch: 如何在 Spring Boot 应用中集成 Keycloak？ - Jeff Tian的文章 - 知乎</a>  》，了解一些前提。</p>\n<p><a name=sXOZ6></a></p>\n<h3>首先，需要在 Keycloak 中的相应 Realm 里配置一个客户端。</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.62162162162163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABwElEQVR42qVS227TQBD1BwCKnVIVHmjVSqmaIhKKTSEBxJciVXxBpCJl+8An8MRzpKY4tlwj2V6v19ccNNOkKEopEYx0NN6dneO5HGNvbx87O0+w9XgbltWG1d6CabXRMi2YZhumaaHVMvmb/IOHj+6FsXtwiKfP9nHQ6eLT2WeMRiN8OT+HEAJiPL6BEBizH+NCiN+4EBxbeoLRc4Y47p/i9fAjvOAn/teMV2/eo9t3YL/9gOkPly+zLEOSJJAEKfmstWZ/i8WZ7pVSKIoCVVXBODl9h87zE/SdIdzZjAnzPGfCvKpRliU/3ARcIbXaOX6Jnj1YIcxzje+hgswLAHM0TYP5fH4vmPDohc2EfXuA2czjQBAEiOMYsZRMTrZM+JMtSVcIlxUmi9nVZYFMqY1bZsJuz1kjzDLNLQcyg9IadV3/lYzerFRIM/Q8H01Tw/N9JHGEb36MJPvXlp0hLi+nLIEwDJHKBF9diUgXKwmbL8UZ4GqhwyiKEEcR3FhBF+XGhOst+z4nqzRl0TZVyVsmLRJoTiSfu0Cx2woPSdj2ANPpFWtOJjdyub4OMZlM4Louj4G2n6bpGkgR1BX99Bdhs6fQXgS57wAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/2b799d2e159d9e65bf41c11a7f037676/fcda8/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png\"\n        srcset=\"/static/2b799d2e159d9e65bf41c11a7f037676/12f09/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 148w,\n/static/2b799d2e159d9e65bf41c11a7f037676/e4a3f/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 295w,\n/static/2b799d2e159d9e65bf41c11a7f037676/fcda8/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 590w,\n/static/2b799d2e159d9e65bf41c11a7f037676/efc66/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 885w,\n/static/2b799d2e159d9e65bf41c11a7f037676/c83ae/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 1180w,\n/static/2b799d2e159d9e65bf41c11a7f037676/ddb69/1669722538379-5f1e4d53-1195-42e0-b05e-d50f8fffbdb2.png 2684w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=EVi63></a></p>\n<h3>然后，找到登录需要用到的 SPI 接口</h3>\n<p>即 OIDC 的 token 接口，形如： <a href=\"https://keycloak.jiwai.win/auth/realms/UniHeart/protocol/openid-connect/token\">https://keycloak.jiwai.win/auth/realms/UniHeart/protocol/openid-connect/token</a>。<br />这是从 Realm 的 well-known 接口中获取的：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+UlEQVR42p2SXU8TQRSGFyOteCmNxTSxF15I6Rftbsu2QBWQK8OfkF9BYoV/5i0CNVGjF3qjqTFgod1tu9v9mN3HzAgGUWLiJG9O5iTznPecM1puUSdfLJPNZslkMqTTc8zOppiZuU0ikSSZvMV0IsnN6QRTUzfQtH8oV10iX9a5n33A3bkMd1JpUul7PNve5kX7OTs7O7TbbXZ3d9nbk9q7FP+UptebVMwmC1WDUq1BsdqgbCzz5t17/udo9a1NHm2t0Xr6GGOjTskwKesNXh12iAB3MsGbTBiPRjiOw2Bg4bguw+FQ3R3HVdFVuRHa4uoy5voqRqtJyTTIL9aVjjqvVcU4jgmCQAGCMFQPwzBECKHiZcmcVqo0MJc3qNRWyBUN5gs680Wdg6OOAvq+T7/fZ2BZxEJALAiCUBW5CpQ5rVg1MVfXWVnbpKQ3eFiokisZHJ4DoyhSLQ1ti/7E57PtEQkJEMrRVWmFyhLV+gpGo6VA0p3UBVC2aNk2rjXm+zhmv3sqB/FrCXIknGekNOlKLmGhXPsrMApjPMena3/k2P/E2cDhxHY4thxs18MPBV4g8MKfUg4Ns3UtcCTO6AZv+TB5Sc/7yreTPse9U3p9i4FtI6Lo95alw2brCXKWFzC5nIOjQwRjesEXvHjMRV8iDIij6Np/+AOyK3/HaR/kzQAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/1baff1d5defcd1b43ee98c5df61f44c6/fcda8/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png\"\n        srcset=\"/static/1baff1d5defcd1b43ee98c5df61f44c6/12f09/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 148w,\n/static/1baff1d5defcd1b43ee98c5df61f44c6/e4a3f/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 295w,\n/static/1baff1d5defcd1b43ee98c5df61f44c6/fcda8/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 590w,\n/static/1baff1d5defcd1b43ee98c5df61f44c6/efc66/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 885w,\n/static/1baff1d5defcd1b43ee98c5df61f44c6/c83ae/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 1180w,\n/static/1baff1d5defcd1b43ee98c5df61f44c6/9e7e4/1669722699010-3bd8874c-f402-4d4b-9699-2c543e12cfaa.png 2056w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />比如，点击以上链接，打开的是 <a href=\"https://keycloak.jiwai.win/auth/realms/UniHeart/.well-known/openid-configuration\">https://keycloak.jiwai.win/auth/realms/UniHeart/.well-known/openid-configuration</a>，从返回的一系列自发现 url 中，就有这个 token 接口：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVUlEQVR42q3R60vCcBTG8f39RVe6EVT2Kuheb5IiKIiowDRKXHNLm5dtbpqbrqXb7/eNVCTfRgc+nHcPz+Eos4urLGzss76TJrV/wdbI5u45W3sXpA4uWds+ZGp2iam5ZabnV5hZWP1lbYLCP49iOjpa5QXdzqHVM5Q/shjNewzvDqP5QNG9peI/Uw/UkVdqgTpgdwyiXkgcx2NKydK4z93wpGbQahk074q8nebZOuPFSpOrnvJYOSJjHpCtHpOtnoz2Ma+Na9phnfCrhZRi2LDhuOiajqHrmGaZklng3VTxPBM/sPBDeywInbFu1KIbNRFCTJ5sOzbFYhGjrKKX87xbeWqOivOh4/pvNPyfbdDwDdzgbaREJ/KI+sGg3U/wZ6+NlBIl6LYwrQK2W6HttwCJRCBkMiQSEhEPiF/ipDchEf1hYC/pYrcL+J91Etkf9pZ///I3ewJMMPL8hxoAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/b1d07b60a8e20012cd225f94156f938f/fcda8/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png\"\n        srcset=\"/static/b1d07b60a8e20012cd225f94156f938f/12f09/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 148w,\n/static/b1d07b60a8e20012cd225f94156f938f/e4a3f/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 295w,\n/static/b1d07b60a8e20012cd225f94156f938f/fcda8/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 590w,\n/static/b1d07b60a8e20012cd225f94156f938f/efc66/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 885w,\n/static/b1d07b60a8e20012cd225f94156f938f/c83ae/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 1180w,\n/static/b1d07b60a8e20012cd225f94156f938f/04293/1669722777976-eaedb82f-2558-4f0b-b512-790c35ed42f0.png 2654w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=a9fgv></a></p>\n<h3>使用 Postman 手动调用测试</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33952b98a14c085f945078466c24e3e5/a1ccc/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABx0lEQVR42mWPCW4bMQxFdexerT1HU8SJE8Px7COJpBZKM1qmkA0ETfrx8MFPiCQkvPdEBIAAGgAQkYgQkZnDf2IOewwrxR8/w6/XJJjZO2edJQJ/l3Nu27b6VTnnfyPyzlsWxrlSa6lH8+Oox+GY49fhnHMIoZTy2dli8N6JtbvVGBqBa+AjBgYthz6ldBzH5+ujhS+RmQW9nauSZZ2rXA+1Hlpyd4vzdNTvSiWnnO9etlS2fRdorA1smTnGmPZS8v3Kd9Va95zuw2kv2YY95SK2GLWmUVEnqZfUKxrB9sp0yvba9roVA9hBW2UD+qhdhEYAIlFKPc/4p1dP3QP51MnfN/ncq5cRTqN+7tVp0M+DOg3qdYKXUb+MLc5SiZRSv+JN0oRuIZ7Q99qN4KRh8hF8RB+JN3BRuwCuRbjf14Bij1GPy6RwIi8tL8TKhNW0LTM1JvQTOu2CCZsJG/GDqBFFzrmXeJ7wutJV0vsM15UuC3bKfA6P6Gby2oUH4NufNYDYt70b5WlQbzNelrblfWmcJ7gs9GheFrquZgQ3gHv4AM5zEKXWEf2HNB/S3JQZtH2sV5aVZdn8Hg2v5BfihfyMdgIbt/0vqTHjXieARJ8AAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/33952b98a14c085f945078466c24e3e5/fcda8/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png\"\n        srcset=\"/static/33952b98a14c085f945078466c24e3e5/12f09/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 148w,\n/static/33952b98a14c085f945078466c24e3e5/e4a3f/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 295w,\n/static/33952b98a14c085f945078466c24e3e5/fcda8/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 590w,\n/static/33952b98a14c085f945078466c24e3e5/efc66/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 885w,\n/static/33952b98a14c085f945078466c24e3e5/c83ae/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 1180w,\n/static/33952b98a14c085f945078466c24e3e5/a1ccc/1669722939586-0dde6cf2-431d-4e88-8dc3-52bb98cbb54d.png 2776w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br />如上图所示，用这个接口可以成功登录。接下来，只需要在 SpringBoot 中，接收到用户名密码的部分，替换成以上对 Keycloak 的请求即可。这可以通过 Postman 的代码视图，选取 Java 即可。</p>\n<p>这样做，可以只需要一个 Http 客户端，就完成了将用户认证转移到 Keycloak 的需求，不需要额外引入 Keycloak 相关的插件。</p>\n<p>我在一个最简单的 SpringBoot 应用里，添加了以上代码，将获取到的用户名和密码，传入 Keycloak 的 token 接口，获取到了用户的访问令牌，以及身份令牌。完整的代码提交见： <a href=\"https://github.com/Jeff-Tian/keycloak-springboot/commit/b3bbe460589a76388243cf0413af4fdb0a06ed98\">https://github.com/Jeff-Tian/keycloak-springboot/commit/b3bbe460589a76388243cf0413af4fdb0a06ed98</a><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4UlEQVR42m2S2VLcMBBF51cYxqssW6steRt7lgCB//+dk7IhgSQ8nLq3+uFUq1oH5XpsO6J9T20CtQ4I6ciKhrxUZOV7nrKKh1PJMRF/ccokteq43d9Yz3cOibAkwnDMah7zhqL1FM6R6kBmOjLtyE2gsIG0MSS14vRBIt85CsmxqjlWDQdpe3Q3U6qOvFLY14h7HbHnke624G8z/jrTXhf8OmOWAbuO+MuMPUfMOlANniJqilZzKJsOP1ypdNyfV7aR3AWKWiNdQPqRyvdk2pPWlsdKc5LmC5pTpff5xuFUKLLKkQpDUmzCZ0R4pjAzpV0o7XlPsfdln2dqIlPjB9NnNgOHh1TylcLeEOGOsDO1X6n9hcote9+y0BN5M5CrgVRGEhlJ642eVAYO2zF+swnF0CFih9AGFQdUP9HEETss1N1A6TtK31I6T2ns3lOtSZQmafSncN8wk9i3YT+KHFrC04Xh5w/6lyfsbdlx9yv6uqAuM2qdqM89co57VmP8R5hK9EuPe5lIXUN7WQnPz+jLQrPM1MsmmJBzjxhayt6Td/qdoMm9/l9oXrcNJ8pg9y/h1nnHrhNq7imjpQjmj2TrO9GQt98Im2tEXXsKq6mCR8aA6DyZ2zYwe36L12RG8QvfPFsmhaOpUwAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/9112b7df821a4608a6b77c986c8467a3/fcda8/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png\"\n        srcset=\"/static/9112b7df821a4608a6b77c986c8467a3/12f09/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 148w,\n/static/9112b7df821a4608a6b77c986c8467a3/e4a3f/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 295w,\n/static/9112b7df821a4608a6b77c986c8467a3/fcda8/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 590w,\n/static/9112b7df821a4608a6b77c986c8467a3/efc66/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 885w,\n/static/9112b7df821a4608a6b77c986c8467a3/c83ae/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 1180w,\n/static/9112b7df821a4608a6b77c986c8467a3/1105b/1669723202408-21d533d9-0b79-459b-bdb4-6c12dbaf3af1.png 2940w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=Roe08></a></p>\n<h1>在线演示</h1>\n<p>如果你已经在我的 Keycloak 里有用户了（<a href=\"https://uniheart.pa-ca.me/keycloak/login\">https://uniheart.pa-ca.me/keycloak/login</a>），你可以使用你的用户名和密码，直接调用这个最简单的 SpringBoot 服务。为了保持简单，没有添加界面，所以用户名和密码是通过 url 参数传递的，完全可以模拟实际的 SpringBoot 效果。但是在真正的应用里，千万不要将用户名和密码通过 url 传递！<br /><a href=\"https://tranquil-plains-58233.herokuapp.com/login-by-username-password?username=jeff.tian@outlook.com&#x26;password=xxxx\">https://tranquil-plains-58233.herokuapp.com/login-by-username-password?username=jeff.tian@outlook.com&#x26;password=xxxx </a></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ec5d0ea6de3320471c457331ae45c89/f4fb1/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.21621621621621%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACvElEQVR42p1UaXPaQAz1nw80ocn0T/XIAUlMIARjbGPj22tjc4Y0r/O0wKQzmX6oZ96sVquVtE+SjcvLb7joXKHz9QqUP6LTuUKrdY6zsy+yttrnaLUu0G5fyP7j2m53RDbe399Q1QWqRYFmVUF/7wd89n12xv2bSEZWubDCn7CjGzhJD9PkDn7ehx3fCNy0h0n0C5PoGlb4Q2yJaXyLaXwHJ+kKaEu9US4jeNk9wvIZ82IgcrqwRZ7lj4JQPcPLHiRQqEaIyheE5UhsaZfVDqJyBD83YRSNrw2UVtDBXA0QFANxQEOCTuPK0ufFQOzjcqxRjREUT6I3soUrjpJqIg4o0yEPxUgNJKBf9A+6vmCWPUhQsVXDkw9DMiuY1RO8/B5u3oMdX2Oa3JzgpHewou+ycu+mXYGT3IpO5PQWXtaDEakx7LCLadSFnzwiiEzMS80lM+RTmRGNZ/mDrNTzmczsaMeMJcPNeovhYATLsuFNPFRpiV21wb7a4X8+o14V8OMxgtjGLHpBuYpQNiFUM0e5DFGtItTrFOVS74tmBtX4WKxi2VPPwnLNa1cXhfwl1RihGggnbAn9zHvBTFrG1HL+KJyFaihF0u2lz0mPkS0cBMpEWA4RqL5cYFXJC6G50zpyRlBPp8ce9Q/BWXGjXiqMLBNjewA/mogyXUyhmkCekDeePJtPJep1hs2uxmqrBJTXuwqrbSmysd28om8O4fs+smL+1+VmU+B1v8Fuv8Zuv8J6t8Db7/2/i1ItUzihiVkyRNG4kl1Wu0K0WgbimOTntSd6toueDktWjimfTSqkKHRADoPCPE0K+SAvbFwWhAUgZ9SzsTnXswP48zjeI7dGunDgpF2JwEjHWdUG/VOB9Pw+w816h9kennS04T0GNNLKlkIcJ4KQyuVHZ32RjxOhof9Ex6x0N+j2+gMJAx5clnsdRAAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/6ec5d0ea6de3320471c457331ae45c89/fcda8/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png\"\n        srcset=\"/static/6ec5d0ea6de3320471c457331ae45c89/12f09/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 148w,\n/static/6ec5d0ea6de3320471c457331ae45c89/e4a3f/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 295w,\n/static/6ec5d0ea6de3320471c457331ae45c89/fcda8/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 590w,\n/static/6ec5d0ea6de3320471c457331ae45c89/efc66/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 885w,\n/static/6ec5d0ea6de3320471c457331ae45c89/c83ae/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 1180w,\n/static/6ec5d0ea6de3320471c457331ae45c89/f4fb1/1669724052107-9c33f7f3-73c9-45ba-b660-76291f9225b8.png 1766w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=lf7yZ></a></p>\n<h1>本地运行这个示例</h1>\n<p>参考 <a href=\"https://github.com/Jeff-Tian/keycloak-springboot\">https://github.com/Jeff-Tian/keycloak-springboot</a>  的 README，\nshell\ngit clone <a href=\"https://github.com/Jeff-Tian/keycloak-springboot\">https://github.com/Jeff-Tian/keycloak-springboot</a>\ncd keycloak-springboot\nmvn clean install\nmvn spring-boot:run -f pom.xml</p>\n<p>open <a href=\"http://localhost:8080/login-by-username-password?username=jeff.tian@outlook.com&#x26;password=xxxx\">http://localhost:8080/login-by-username-password?username=jeff.tian@outlook.com&#x26;password=xxxx</a></p>\n<p>结果如下：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cd4b47e1d7296b92643ab8d345c57fcd/ae28e/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAADX0lEQVR42o1U2Y7cVBD150YMi/IUAZrAS15CEvEFycB/gCBkIUtPT2a6M723u93e1+t9P1HVjY2EhISlUi3XLledU3WVL86+xtmX3+DO2V18de8Bvn34FOePnuHHn3/Fdw+f4v7jC3z/0zPW548ucP74gu0fnvzCPtn3P9skSpZlyPICpuPDcnzsDhpsx4MXhAjCCHGcIElSRCKWEglEQrAdRgJCxHxO75KtJEmCpmnx76dpO7Rtj7br0XVA10lb+kNMxvseY5wTFmUB2zFgOyZ0Q0NWJOj6Gk1bjdJ2g9QsTVuibgsWsodzpSpruNEey9NzqPYUe2sC1Zng5F/j4F6yPvk30LwrmMEtVOc9y9Gbst7bb3FwJyzkK2VZIYhPsKIFrGgJW6xgR2u2rXAJK5K+Gd7CjlYwwwXbRvCRfSOY8zlp3Z9RhQ10/yN29t9Ymy+wMp5jY77E1nqFvfMOe0dWsLVe4/b0Gxb679jZb3B0p3wuq3yDjfWSqx5b1oMbrlL3b3AKrmGyPeNKqSJq++heQvM+wBEbrohgIKGfEjRWuIBSFCWCRMfBvobuLmBHG2jGFJa/gJeqDAG1SW25YgdHbLlV2f4tF0B6gIZZrqoKs9kcs5sZ1psN1PkacRQjNyNUcS7nqMf/eniwq7qA5Z5g2Edo+h6+sFE2KbI8RF4KFHWMsk5QNRnbeSVQVDHSwkNWhuyTkM0YOtEOW1uCqrpvsTb/YqBV5x2TQ6QsjT+wMV/wmBApROLGesWaCKN3idQxoWpPoHnXDDolJq0HMyaGACdfzuMHxovixLQk6opJYpbjOEbT1DgeD1APe2jaEWFsM7tRaiKvIm4lLfzPbQWIcwdp6aNuSnR9i7Zr0HUtuq6BEgQB6rrBfDbHYrGCZm7gRRq8ZM+s0YiIzOZkhGFZp5yU/L7/D1LyMobp7nCythCZhaRwZBWFh6Rwubq0DLgq8qnipPAQpjqLyC2Ok1bKsubV0/xLHLz3DC5hI3d5wpgNu0pYEQFExHBOQj5j706hlEUFV6gjEcOSk5Yr+Bor488xOX1M58T0kIwmgaaA3mWWw0Qft4Ewk5fCcrwASP7x19IP5eUhLwd5SdDGKFmWw+fbZslJ6WBYI0o+JBg+9GLq5gqu2PIP9DG+59gnhuC+A0PsSosAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/cd4b47e1d7296b92643ab8d345c57fcd/fcda8/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png\"\n        srcset=\"/static/cd4b47e1d7296b92643ab8d345c57fcd/12f09/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 148w,\n/static/cd4b47e1d7296b92643ab8d345c57fcd/e4a3f/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 295w,\n/static/cd4b47e1d7296b92643ab8d345c57fcd/fcda8/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 590w,\n/static/cd4b47e1d7296b92643ab8d345c57fcd/efc66/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 885w,\n/static/cd4b47e1d7296b92643ab8d345c57fcd/c83ae/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 1180w,\n/static/cd4b47e1d7296b92643ab8d345c57fcd/ae28e/1669724200041-2cfdbaac-9520-416f-8082-6b964f0253a4.png 1598w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}