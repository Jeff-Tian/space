{"componentChunkName":"component---src-templates-post-js","path":"/posts/iuwfv9","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/iuwfv9","relativePath":"posts/iuwfv9","frontmatter":{"title":"使用 jmeter 做压测，如何提供 cURL","stackbit_url_path":"posts/iuwfv9","date":"2021-08-11T04:18:00","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p><a name=sD0gp></a></p>\n<h1>问题背景</h1>\n<p>类似这种沟通很没有效率，不如直接扔一个 cURL，减少沟通来回次数。<br /><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628653292259-b9a31877-1379-42ad-a6b4-bef1bff25fcb.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=155&#x26;id=u6d5da377&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=309&#x26;originWidth=793&#x26;originalType=binary%E2%88%B6=1&#x26;size=36736&#x26;status=done&#x26;style=none&#x26;taskId=u31ee1941-e575-4fce-a1a7-26e73f8db4d&#x26;width=396.5\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628653356514-617314c7-09d1-4a23-9ba6-55f7fba9bc34.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=312&#x26;id=u8bad750c&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=623&#x26;originWidth=795&#x26;originalType=binary%E2%88%B6=1&#x26;size=61002&#x26;status=done&#x26;style=none&#x26;taskId=ue0cf41a3-0254-4dfe-85f0-dcfd9f115c4&#x26;width=397.5\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628653456402-c71b21e8-b231-4d43-b7ba-71bc80441a7d.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=363&#x26;id=ue5776cbd&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=725&#x26;originWidth=801&#x26;originalType=binary%E2%88%B6=1&#x26;size=87046&#x26;status=done&#x26;style=none&#x26;taskId=u53c8747b-6adf-46ea-9311-9172818ae59&#x26;width=400.5\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628653684817-51166594-59a3-428f-9b31-b22342d59218.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=215&#x26;id=ued5fb4c3&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=430&#x26;originWidth=569&#x26;originalType=binary%E2%88%B6=1&#x26;size=97655&#x26;status=done&#x26;style=none&#x26;taskId=u32255b65-8b41-495a-b191-4b1828431ce&#x26;width=284.5\" alt=\"image.png\"></p>\n<p>这种情况，在《<a href=\"https://zhuanlan.zhihu.com/p/375532394\">使用 cURL 提高前后端开发连调中的沟通效率</a>》一文里反复说明了并且给了解决方案。今天又遇到一个情况，就是测试和后端开发的沟通，而且是压测，具体地说，是使用 jmeter 做压测，碰到问题，该怎么把 cURL 导出呢？</p>\n<p>以及如果是其他前端开发，调用第三方库，碰到和后端交互的问题，该怎么把请求日志打出来并且打印成 cURL 格式呢？</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628654696487-67ab542f-585a-455c-a5d5-a661dd67543c.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=786&#x26;id=u0a863e7d&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1571&#x26;originWidth=953&#x26;originalType=binary%E2%88%B6=1&#x26;size=979381&#x26;status=done&#x26;style=none&#x26;taskId=u03c512ba-638b-495a-935c-b6ce0e11279&#x26;width=476.5\" alt=\"image.png\">\n<a name=L2DSn></a></p>\n<h1>解决方案</h1>\n<p>如果是开发想在日志里将请求打印成 cURL，可以参考《<a href=\"https://zhuanlan.zhihu.com/p/386126054\">将 FeignClient 的请求记录成 cURL 格式</a>》的思路。但如果不想开发，<strong>其实只需要抓包就行了</strong>。</p>\n<p>Web 开发，浏览器自带请求抓包；微信小程序开发，微信小程序开发者工具自带请求抓包。如果原生 APP 开发，或者使用 jmeter 做压测这种情况，就可以使用通用的系统级抓包工具。</p>\n<p><a name=IcJsi></a></p>\n<h1>抓包工具推荐</h1>\n<p>在 Windows 系统中，可以使用 Fiddler。在 mac OS 里，可以使用 Charles。</p>\n<p><a name=qRet2></a></p>\n<h1>jmeter 压测抓包举例</h1>\n<p>在 mac OS 里，把 Charles 打开，看一下代理设置：<br /><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628655052908-a7451a7a-9384-4582-b29e-ef951a7b9548.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=344&#x26;id=u35a294fe&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=687&#x26;originWidth=1247&#x26;originalType=binary%E2%88%B6=1&#x26;size=202751&#x26;status=done&#x26;style=none&#x26;taskId=u0f78625d-f784-45cd-8af8-af53cf8ba0b&#x26;width=623.5\" alt=\"image.png\"><br />记下端口，然后使用代理配置的方式执行 JMeter 命令（详见官方文档<a href=\"http://jmeter.apache.org/usermanual/get-started.html#proxy_server\">http://jmeter.apache.org/usermanual/get-started.html#proxy_server</a>），比如：</p>\n<p>shell\n➜ jmeter -H localhost -P 8888 -n -t /path/to/your/script.jmx -l test_result.jtl</p>\n<p>在 meter 命令跑起来后，你就可以在 Charles 里实时看到发出的请求了：</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628655351331-ddcb048a-826f-4966-a188-c7fe002a2844.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;height=295&#x26;id=uabf17c6f&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=589&#x26;originWidth=581&#x26;originalType=binary%E2%88%B6=1&#x26;size=197503&#x26;status=done&#x26;style=none&#x26;taskId=u7f740c80-cc5a-4211-afb6-d53c57abb33&#x26;width=290.5\" alt=\"image.png\"></p>\n<p>要拿到 cURL，只是一个右键的事情：</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1628655379542-b2ab0b38-9c59-41d7-a34d-95381694eba8.png#clientId=u72b221f5-9375-4&#x26;from=paste&#x26;id=u21e6d2dc&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=168&#x26;originWidth=307&#x26;originalType=binary%E2%88%B6=1&#x26;size=24284&#x26;status=done&#x26;style=none&#x26;taskId=u70a2b921-7873-4539-8536-cd5da31979b\" alt=\"image.png\"></p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","description":"Full Stack Developer, good at OAuth 2.0","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"本站源码","url":"https://github.com/Jeff-Tian/space","style":"link","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[]}