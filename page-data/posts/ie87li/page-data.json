{"componentChunkName":"component---src-templates-post-js","path":"/posts/ie87li/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/ie87li","relativePath":"posts/ie87li","frontmatter":{"title":"同步用户微信头像的 NodeJs 实现","stackbit_url_path":"posts/ie87li","date":"2021-06-29T09:53:58","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p>对于使用微信登录的系统，在用户授权后，将其微信头像直接同步到服务器，可以省去用户上传的操作。本文最终给出一个 NodeJs 中间层的实现，并展示实现的过程和在实施过程中几个需要注意的地方。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 413px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f5f25e7617ce42e62e21f87b5070e97a/6c1e7/1624879466049-62e9674d-08aa-41cb-b6a5-000e913020b1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 154.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFTklEQVR42oWT228UVRzH50+gSruNaDDRGDEmSkLig4aKD1BMr3u/zuzOnHNmt4UiFNeWcgkSH0jARGNiDCbKg9rEV0pjohK5lNYmFIgtZVt2kdp225m9zAYwPpivOWf21hb14Zvfb885v898f79zViLeZ0FCO0ACr4AEXwMJvwES2m5H/0vQ3JtBPA5o7iZonU3QOjZK7WgCcTUi6twCifieB5V3gUTeFJEqu0Hld0BjbSDB7dDcT9tAZxPU9iYbXIG5yh9xNoF0NkIRQE8zSOBlEH9ZgVfBPyIgwpnDzrvKELcNEKq4FnuboXQ9w4EOG+B/AcS31Y7eLdDcjeVWnwB01Ymvux3QOhorwGYQTyO07qeguZ+D5rLnZa/XpHU7oHY47LzTIUTczdC6+PlmkM4mRLu3QNJcDbb9rm0gkW6ondugdW+C5m6A2OOq5O2bEOtoQKy9AbG2hlre3gC1axNkpwMSVVqhtm0FCXeAUgK1/UUQ/w5xKXyPKnurUpV30e9/G0c9b2HA34IhfwuO+Fsw6G/B8eBOvOdrgcT0XmjenSChvaCxADTX66BqGCzeB8Z6wPSyWA+I3oukGsM+PYGgmoArzOCOMLgiDEFZx6FwGBJ3RVlciDEKSkKgVAOlVDiuiFECjTEMKkEkYxEkZBk0EAILhkCCIfSGgkgGPZAYY9B1HTxyCGO1nNJKpGA8MoYeouFkxIeBWAT9JIbDZSVpDHFFhqRpGvbs2YNAICDANpQK6FrZwDglOBN0gug6FE2DLxSCNxhEICIjqqq8ZYpIJAJVVeucbZROKaJ6HB+FPTgh+0XOCIGmqkKEaFBjsY0t/6v4OUrwua9NwKujKNdxRowDCSFoa2sTLcfj8eqhenGAoieEu9MhF6KJHkRlGU6nEx6PB263G16v1wZyAJ8jB/+fw6/creglKohwRURNRfxMFaiKGZAntl1z58Vn/g7I8cSaliswXlttubW1FT6fb0PL3BV/LirT8Y1rNw6pish1xkRXQX67gQDC4TAURUE0GoXEh1nR+tnFGUM0nsAp2Yfznr1QEj1irTrbujpuhncqcWrlC3yB265IjUYRIRTDnbuQDHkR1oh4GpV9WZaFOIOLPz8pmUwK0IEDBzA0NISBgQGhwYEP8P7RYzizj+FiqB2Hjx7HEb4+OCjE6/bv34++vj709/cLHTx4EFIul0Mun4dpmlXl83kUcjmYf/4F85MPYVz+EeajxzBXV9ecE7W5HAzDgGVZuHv3LqQHDzJYXl4Si1zZbBa3b93ErTuzWJm4CuPUIZhWCaZhVAHrxeEcmEqlIK1kl1EsFlC0LJRKJRQKBWQXF7Hy8BHMY72wvv8a1t+Ata6LelUcCuD8/DxGRkZw+fJljI6OYnJyErOzsxifmMD0DyP4afQirly9hrGxsWqb9e1ucMhbTGcy4GC+kE6nkclkBPT35SymZ2ZEzvf+y2HJKiGVmoM0l85geHgYmXRaFC4tLaFYLArxi+Fftn8XYJpGTYZRgxomTMvAndQMpEs//4KERjA1dUO0e//+fXHLRrXAjkahAKNYLMvOa68jB9NatYG82CqVBKRUjoZpIGfmkOfz4c9iZQWldBoP76VRmr+Hh/cyKM3Nw/xjAWYuX9dyCtL6WfDIb3o1Z2BxdQlmyRKwC1fO48uJc/ju1/M4N/4FLox/i8L0bZjcsbFau5T1D1XcWNHCkpnFzGIKK6UCHqfTOHvpNPaNn8SJybPouXYMH1//FNb0bxuB9Vdfn+dz/N+SR65QEK1lp8axcPM6FqbGsHBzHNkb12HOzcIsFNe8w38AQwtYwDUfEg8AAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/f5f25e7617ce42e62e21f87b5070e97a/6c1e7/1624879466049-62e9674d-08aa-41cb-b6a5-000e913020b1.png\"\n        srcset=\"/static/f5f25e7617ce42e62e21f87b5070e97a/12f09/1624879466049-62e9674d-08aa-41cb-b6a5-000e913020b1.png 148w,\n/static/f5f25e7617ce42e62e21f87b5070e97a/e4a3f/1624879466049-62e9674d-08aa-41cb-b6a5-000e913020b1.png 295w,\n/static/f5f25e7617ce42e62e21f87b5070e97a/6c1e7/1624879466049-62e9674d-08aa-41cb-b6a5-000e913020b1.png 413w\"\n        sizes=\"(max-width: 413px) 100vw, 413px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=V5Kpa></a></p>\n<h1>BFF 架构</h1>\n<p>微服务架构已然成为了企业信息化架构中的主流，这种架构风格给前端带来了挑战。为了灵活应对业务需求的变化和适配不同的前端用户体验，BFF 层应运而生。</p>\n<p>由于天然的限制或者使用场景的区别，不同的前端用户体验并不一致。拿阿迪达斯的微信小程序和其原生 APP 举例，你会看到用户体验完全不同，有些是因为微信小程序的限制（比如分享体验），有些是不同的产品运营需要。</p>\n<table>\n<thead>\n<tr>\n<th><strong>小程序</strong></th>\n<th><strong>APP</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fad186c1015f126e25e2c85b5c74626e/d9199/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.89189189189187%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/fad186c1015f126e25e2c85b5c74626e/fcda8/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png\"\n        srcset=\"/static/fad186c1015f126e25e2c85b5c74626e/12f09/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png 148w,\n/static/fad186c1015f126e25e2c85b5c74626e/e4a3f/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png 295w,\n/static/fad186c1015f126e25e2c85b5c74626e/fcda8/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png 590w,\n/static/fad186c1015f126e25e2c85b5c74626e/efc66/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png 885w,\n/static/fad186c1015f126e25e2c85b5c74626e/d9199/1624880156326-3cf94d3b-3b20-46ec-963e-68ccdc664158.png 960w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></td>\n<td><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d014c20be2c269b0726803aac730d02f/d9199/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 216.89189189189187%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/d014c20be2c269b0726803aac730d02f/fcda8/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png\"\n        srcset=\"/static/d014c20be2c269b0726803aac730d02f/12f09/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png 148w,\n/static/d014c20be2c269b0726803aac730d02f/e4a3f/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png 295w,\n/static/d014c20be2c269b0726803aac730d02f/fcda8/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png 590w,\n/static/d014c20be2c269b0726803aac730d02f/efc66/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png 885w,\n/static/d014c20be2c269b0726803aac730d02f/d9199/1624880164682-0aea42b9-79a7-4542-bb07-9f12c31dedcc.png 960w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></td>\n</tr>\n</tbody>\n</table>\n<p>BFF 是 Backend for Frontend 的简称，它用来对众多后端微服务进行聚合和裁剪，以适配前端。如今，<strong>端用户体验层 -> 网关层 -> BFF 层 -> 微服务层</strong>这种分层模式已经成为了典型的现代微服务架构分层方式。</p>\n<p><a name=L4Pkg></a></p>\n<h1>NodeJs</h1>\n<p>NodeJs 的出现使得 JavaScript 可以运行在服务器上，并且天然适合网络 IO 密集型的场景，以及不适合计算密集型场景。这使得它作为 BFF 层非常适合，因为 BFF 层通常只是联结前端与后端，做一些透传，没有密集的计算，但是重网络传输。</p>\n<p><a name=pXaj6></a></p>\n<h1>分析微信头像的存储方案</h1>\n<p><a name=h7ysH></a></p>\n<h2>直接存储微信头像的 url</h2>\n<p>比如，我目前的微信头像 url 是 <a href=\"https://thirdwx.qlogo.cn/mmopen/vi_32/rgPgbf5XE2ancz9ibobSibZEMPOibp4LdsQEXiaQeRZ78WJgVe7xgMamYXd6eibo9rg0Wje1rnh9aLMc87DVS4vrItA/132\">https://thirdwx.qlogo.cn/mmopen/vi_32/rgPgbf5XE2ancz9ibobSibZEMPOibp4LdsQEXiaQeRZ78WJgVe7xgMamYXd6eibo9rg0Wje1rnh9aLMc87DVS4vrItA/132</a>。显然后端可以很简单的接收一个字符串，将其存储起来，这样前端下次拿到这个 url，就可以展示出来。</p>\n<p>但是这样做有个问题，以上链接是微信的 CDN 地址。一旦用户在微信端更新了头像，那么上面的地址将不再被使用。如果某一天它被清除了，那么系统的前端展示用户头像时将是一个死链接的图片。所以方案得改成：</p>\n<p><a name=b1BEz></a></p>\n<h2>将微信头像 url 下载下来以图片文件格式存储</h2>\n<p>这样就需要后端实现一个文件上传的接口，然后由 BFF 层把前端传过来的 url 转成表单数据传输给后端。所以最终后端不是存储一个字符串，而是存储图片文件。</p>\n<p>这样就没有用户更改微信头像后，系统中的头像失效的问题。至于微信头像更新后，系统中还是老的图片的不同步问题，第一种方案也不能解决。实际上这种情况下只需要再次同步即可，至于如何自动同步，不在本文讨论范围内。</p>\n<p><a name=kvpFi></a></p>\n<h2>结论</h2>\n<p>只需要在 BFF 层使用 NodeJs 将微信头像的 url 下载下来，再调用后端的文件上传接口即可。</p>\n<p><a name=vHkrS></a></p>\n<h1>代码实现</h1>\n<p>需求分析明确后，只差写代码了。经常有人问，高手写代码是不是不用百度，直接啪啪啪就能写出来？实际上，不需要搜索就能写代码的，那说明是熟练工，同样的事情干过很多回了。对于高手，也可能接到不熟悉的任务，这时他可能不用百度，而是用 Google 和 StackOverflow。</p>\n<p><a name=n0Qn6></a></p>\n<h2>Axios</h2>\n<p>既然要使用 NodeJs 上传文件到后端，那么就需要给后端发起一个 Http 请求。通过简单搜索就能知道在 NodeJs 的世界里，Axios 是一个不错的 Http 客户端，因此再进一步搜索如何使用 Axios 发起一个文件上传的 Http 请求。</p>\n<p><a name=wLNiD></a></p>\n<h2>坑</h2>\n<p>搜索工具是程序员经常要使用的，虽然说如今搜索方便，但是要甄别结果的可靠性并没那么容易。被一些答案带到坑里是常有的事情。比如搜索使用 NodeJs 上传文件，多数答案如下：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/89be934f5a0c727702ff47ba9c15aeff/a1792/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.432432432432435%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVR42o2S627bMAxG+/6vtmEX9II2xVq3TezItmRdfZHtnEFqYzTrnxEgKEvU8SeSVwAhBGohEEJgjOFsp9PpIn62tDXPMzFGfD8zxTXtcpUO5xgZximDh2HISeM4EuN88T1NU16nuK5rjun8nJvsKlH9MKPcjPc+Q70PaGNysjE2Q6xzOOcZhpG+7/PlBHLObT/7AMI4jRhrsM5inMV5t/l6en/K/1gqTQZ6G6jeBNW+ptoLpNDIRtO1FtUYmqMiuIExRMYw09uJOC4b5OybQqM8xa7k8FRnf7x54en+jd11we6m4PDU0AlHWxqavUYUHV3tWNblonGbwvS04vWFt8OeSlTITiKVpFUtjWzQTuccHxzWGfoxvJfH2C+TkIF9iLwWCtUaZCOx2qKVxhqHMw7VKrQ2GZBi1+kcleq2Bl0olHXP7lryvOt4flD8uZMUO5XXxaPi4brBmYGyqmjalrppOZRVnsPPNdyATTtwc6u4vVX8+i358bPl2/eGu7uO+weNVFPudoIkdZ3WlNWRZVm+DP57l33keAwI0VOLnrIMHA4e5yLLvJ6HgmVZWT+UJNi/DUkK/wL0uVDG/QfXWQAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/89be934f5a0c727702ff47ba9c15aeff/fcda8/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png\"\n        srcset=\"/static/89be934f5a0c727702ff47ba9c15aeff/12f09/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png 148w,\n/static/89be934f5a0c727702ff47ba9c15aeff/e4a3f/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png 295w,\n/static/89be934f5a0c727702ff47ba9c15aeff/fcda8/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png 590w,\n/static/89be934f5a0c727702ff47ba9c15aeff/a1792/1624955881002-971a3f3f-34c6-4971-9d1b-5ed3df6958b6.png 780w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\njavascript\nvar formData = new FormData();\nformData.append(image, yourFile);\naxios.post(upload_file, formData, {\nheaders: {\nContent-Type: multipart/form-data\n}\n})</p>\n<p>注意上面的代码显式指定了 Content-Type 这个请求头，然后实际试过后你就知道这并不工作！</p>\n<p><a name=Uy8z7></a></p>\n<h2>Postman</h2>\n<p>Postman 是一个强大的 Http 请求监控工具，可以按需定制请求体。BFF 层要同步微信头像，无非就是要调用后端接口，发送一个 Http 请求，将用户头像存储起来。因此真正的高手对这个需求是真的不会去搜索的，而是直接使用 Postman 构造一个 Http 请求，手动上传文件，拿到后端的响应结果。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.10810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABw0lEQVR42pWS627UMBCF87A8FD94EiReAakSpaqE0HZp2W53Y8f3uw+acZKl/GOk0ciJ/XnOGU8xRlAIKaC1RmsNSikcj0deb9F735PCOQchBHIpsMZCG8NnJ2stKOlnCAHeezjnYYzh77SWUjKActuvjUUOBp/vND58esPHLwtfNAXvoZWGMhrGaNjgscgZzhLwBiAYXVhr5U5qbeitYXEV988ZP9/yAEbvYI3hzZY7MDALdTS6Gx0PGMklWCmF682PilYLyIxJSInVFjIKfRFo4gp1ucCHiH8j58x2UKWorcGQBavf0/PhHr8P33A6fsfrr0e8/rjD6fErTocHvDw9QFzPQ946kCG33ga0dzMGN1ktoJcLp7VqlUoSHbyzCMGjtQFiWKsodUhuneAdpd5ewOR8QMyZ5YWc2K+cx4He+n4zeRhSQMoJkTJFxBxhY8VVRcS0DmWeZ+7IWINAdX0uVGlgDN6UvVe4R4qR9zOw1IooJX/QPuN/4u+Hvvk60Uv3lzNOZ4mXq4V2AdpFhJTZChsStEtQNkHoiFkFSBORS3sHHUoImDNaKYi5IqTCmUrdB0ETLmsSZMvWN38HlDgE/AN7GqZN2BnGLgAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/7d029356536f4bb89b9999f6637d3ffc/fcda8/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png\"\n        srcset=\"/static/7d029356536f4bb89b9999f6637d3ffc/12f09/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png 148w,\n/static/7d029356536f4bb89b9999f6637d3ffc/e4a3f/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png 295w,\n/static/7d029356536f4bb89b9999f6637d3ffc/fcda8/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png 590w,\n/static/7d029356536f4bb89b9999f6637d3ffc/efc66/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png 885w,\n/static/7d029356536f4bb89b9999f6637d3ffc/7b1dc/1624956609988-7e3879c5-0f50-43a7-b370-b389ee53428d.png 956w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />然后，点击代码，就能选择将刚才手动构造的 Http 请求，转换成可以构造同样请求的代码。我们选择 NodeJs Axios：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABn0lEQVR42oWS3Y7TMBCF8/5PwpMgrhEg7QVbKLRp2vw0jeOxZ2x/yOm27BUcaWRLto6/GZ9mGAZ2ux2n04mu62jblnVdUTP86hivCx9fHO2+Y95/Z+xOZO/IwVNVSnlWzplmcQsSBOcWbreZECPee5xbSaY4r3z45Hg9G2Xu6b9+4/L5C9PLKzpdqyMPpZRopmnCzLYXzBRVfV6IMVJKBpSSjZShP165/BpZJodfZmI0NNa74L3SVLKKWlWNReTeSi6beT2zlJ7rOC4sThGxzcA0s7q7qSWjUY2oKVHvdI9Z1BlGi0Qz1lANC7lkbrPwe290beJ0zHTHTHuo+8J1UprrNOFF8OK32QURbDPOb+2ChLjRVwUpHH5mzqfCpcv058y5y1y6wtDHSqi4cWSYPZbyRpdLIW0tVtJ7q5U8JUP6genHgaUdqNMRX7YKAuuqNKm25oXbGgma3kwLagkfjFUMibbRBlVu84L4QEmVuLwrtk9t/n76v3TPWVBjuIz03cQ8eyToFpWHVI3mfTD/V5VavLA6wSw9k1HHVtcasz96IwtgRyrPmAAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/e424cf714619ef56c33471b1f45b2db9/fcda8/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png\"\n        srcset=\"/static/e424cf714619ef56c33471b1f45b2db9/12f09/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 148w,\n/static/e424cf714619ef56c33471b1f45b2db9/e4a3f/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 295w,\n/static/e424cf714619ef56c33471b1f45b2db9/fcda8/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 590w,\n/static/e424cf714619ef56c33471b1f45b2db9/efc66/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 885w,\n/static/e424cf714619ef56c33471b1f45b2db9/c83ae/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 1180w,\n/static/e424cf714619ef56c33471b1f45b2db9/5440e/1624956825959-645ef07f-d26e-488d-8ad1-46add66bcf21.png 1419w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=GemWL></a></p>\n<h2>抄作业</h2>\n<p>从 Postman 生成的代码可以看出，第一 NodeJs 的世界里，没有原生的表单数据结构，需要引入 form-data 包；第二在请求头里不能直接写死 Content-Type = multipart/form-data，而是要用 form-data 生成的请求头。</p>\n<p><a name=VEf3d></a></p>\n<h2>题外话</h2>\n<p>如果是前端直接文件上传，那么在 Browser 的 JavaScript 世界里，是自带 FormData 数据结构的，这时候要显式<strong>不指定</strong>  Content-Type，以实现自动生成 Content-Type 请求头。对于文件上传不能显示指定 Content-Type 的原因是，构造 Http 请求时，payload 中要使用 Content-Type 请求头中的 boundary 来分割文件和其他非文件字段，而这个 boundary 需要动态生成。如果不显示指定 Content-Type，就能享受浏览器端 FormData 或者 NodeJs 端的 form-data 自动生成的 Content-Type 以及 boundary。</p>\n<p><a name=bEXn1></a></p>\n<h2>TDD</h2>\n<p>在写实现代码前，建议先将自动化测试代码写上，以便构建重构屏障。详细步骤参考 TDD 相关的文章。</p>\n<p><a name=WJ8V2></a></p>\n<h2>jest/nock/TypeScript</h2>\n<p>在实际的 NodeJs 工程项目中，还是建议引入 TypeScript，以享受类型系统带来的好处。这里使用 jest 测试框架。为了控制后端的 Http 响应，可以使用 nock 将之前的 Postman 抓到的后端服务器响应作为 mock。</p>\n<p>后端服务器的 API 可能做了 token 验证，只信任指定的客户端（BFF 层）发来的请求，因此还需要做好相关 Token 端点的 nock，最终测试代码如下（假定要将实现写在一个叫 MemberService 的类中）：</p>\n<p>typescript\nimport { MemberService } from ./member.service\nimport * as nock from nock</p>\n<p>describe(MemberService, () => {\nbeforeEach(async () => {\nconst mockConfig = {\nbackend: {\nurl: <a href=\"https://your.back.end\">https://your.back.end</a>,\nauth: {\nurl: <a href=\"https://your.back.end/auth/token\">https://your.back.end/auth/token</a>,\nclientId: fakeId,\nclientSecret: fakeSecret,\nclientKey: fakeKey\n}\n}\n}</p>\n<pre><code>describe(update users head image, () => {\n  it(pipe weixin head img to back end, async () => {\n    const mockRes = {\n      code: 200,\n      message: 操作成功,\n      success: true,\n      data: https://upload.image.url,\n      time: 2021-06-29 11:20:30\n    }\n    \n    nock(mockConfig.backend.url).post(/auth/token).reply(200, {status: SUCCESS, data: {access_token: xxx, expires_in: 3600, refresh_token: yyy}})\n    nock(mockConfig.backend.url).put(/upload/image/head/abcdefg).reply(200, mockRes)\n    \n    const sut = new MemberService(nockConfig)\n    \n    const res = await sut.updateAvatar(abcdefg, https://thirdwx.qlogo.cn/mmopen/vi_32/rgPgbf5XE2ancz9ibobSibZEMPOibp4LdsQEXiaQeRZ78WJgVe7xgMamYXd6eibo9rg0Wje1rnh9aLMc87DVS4vrItA/132)\n    expect(res).toStrictEqual(mockRes)\n  })\n})\n</code></pre>\n<p>})\n})</p>\n<p><a name=MuB0l></a></p>\n<h2>流到流</h2>\n<p>前面分析了，实现代码只需要将微信的 url 对应的图片下载下来，再上传到后端服务器即可，但是为了提高效率，可以不用等待先全部下载完毕再进行上传，而是将下载流直接对接到上传流上。这只需要对 Postman 生成的代码稍加改造。仔细观察 Postman 生成的代码，由于我们是从本地文件系统选择的文件构造出的请求，因此生成的代码创建了一个本地文件读取流，我们需要把这个本地文件读取流改造成远程文件下载流。</p>\n<p>下载文件其实也就是想微信服务器（CDN）端构造一个 Http GET 请求，仍然采用 Axios，那么只需要设置 responseType 为 stream，就能得到文件下载流：</p>\n<p>typescript\nimport axios from axios\nimport * as FormData from form-data</p>\n<p>export class MemberService {\nconstructor(private readonly config: Config) {}</p>\n<p>async updateAvatar(userId: string, avatar: string | undefined) {\nif (!avatar) {\nreturn undefined\n}</p>\n<pre><code>// 大致逻辑，实际上从统一的令牌管理类中拿可用的 token\n\nconst {data: {access_token}} = await axios.post(this.config.backend.auth.url, {clientId, clientSecret, ...})\n\nconst formData = new FormData()\nformData.append(headImg, (await axios.get(avatar, { responseType: stream })).data, headImage.jpg)\n\nreturn axios.put(${this.config.backend.url}/upload/image/head/${userId}, {\n  data: formData,\n  headers: {\n    Authorization: Bearer ${access_token},\n    ...formData.getHeaders(),\n  }\n})\n</code></pre>\n<p>}\n}</p>\n<p><a name=cRIOS></a></p>\n<h1>总结</h1>\n<p>在实际的 BFF 开发中，可以使用 Postman 手动调用后端服务，然后生成实际的代码，这节省了搜索的工作，而且保证代码可靠。</p>\n<p>对于微信头像的同步，一定不能只保存微信的 CDN url，而要下载后保存图片。通过使用 NodeJs Axios，下载到上传是可以很方便地流到流接上的。</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}