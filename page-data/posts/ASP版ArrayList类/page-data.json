{"componentChunkName":"component---src-templates-post-js","path":"/posts/ASP版ArrayList类/","result":{"data":{"sitePage":{"id":"SitePage /posts/ASP版ArrayList类/"}},"pageContext":{"url":"/posts/ASP版ArrayList类/","relativePath":"posts/ASP版ArrayList类.md","relativeDir":"posts","base":"ASP版ArrayList类.md","name":"ASP版ArrayList类","frontmatter":{"title":"ASP版ArrayList类","stackbit_url_path":"posts/ASP版ArrayList类","date":"2010-04-04 17:58:53","excerpt":"","comments_count":0,"positive_reactions_count":0,"tags":[null],"canonical_url":"https://be-net.azurewebsites.net/post/2010/04/04/ASP版ArrayList类","template":"post"},"html":"<pre><code>    &#x3C;p>一个ASP版的ArrayList类，写得很好。&#x3C;/p>\n</code></pre>\n<p>我今天为了找到它，在网上的搜索结果里，往后翻了n页！因为排在前面的，全是垃圾站，贴出来的代码已经不成样子，很多ASP中的关键字符如注释的单引号等，都显示成了&amp;quot;等之类的HTML转义标签。粘贴到项目中，根本无法直接使用，还需要大量的查找替换操作。</p>\n<p>我不理解为什么质量好的网站都排到后面去了？为了省去后来者再搜索此ArrayList类时，需要大量翻页的痛苦，我在我的这篇文章里放上一个格式良好的版本，因为我的博文往往是靠前的。</p>\n<pre class=\"brush: vb\">&lt;%\n'/******************************\n'类名：CArrayList\n'名称：数组操作类\n'日期：2007-11-6\n'作者：西楼冷月\n'网址：www.xilou.net | www.chinaCMS.org\n'描述：对数组的各种操作\n'版权：转载请注名出处，作者\n'******************************\n'最后修改：2007-11-6\n'修改次数：0\n'修改说明：\n'目前版本：v1.0\n'******************************/\nClass CArrayList\n        Private arrList'//内部数组\n    Private arrLength'//记录数组的长度\n<pre><code>Private Sub Class_Initialize()\n    arrList=Array()\n    arrLength=0\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Erase arrList\n    End Sub\n\n'//数组长度,只读\nPublic Property Get Length\n    Length=arrLength\nEnd Property\n\n'//取得某个索引的值\nPublic Function GetValue(index)\n    On Error Resume Next\n    GetValue=arrList(index)\n    If Err Then showErr \"ArrayList.GetValue()\"&#x26;amp;Err.Description:Err.Clear:Exit Function\nEnd Function\n\n    '//返回整个Array数组\n    Public Function GetArray()\n    GetArray=arrList\nEnd Function\n\n'//添加元素,将值添加到ArrayList的结尾处\nPublic Sub Add(v)\n        ReDim Preserve arrList(arrLength)\n    arrList(arrLength)=v\n    arrLength=arrLength+1\nEnd Sub\n'//将数组添加到ArrayList的结尾处\nPublic Sub AddArray(arr)\n    If Not IsArray(arr) Then showErr \"参数不是数组(arr):ArrayList.AddArray()\":Exit Sub\n    Dim I,L,J\n    On Error Resume Next\n        If arrLength = 0 Then '//如果ArrayList为空则直接附值\n        arrList=arr\n        arrLength=arrLength+UBound(arr)+1\n    Else\n            L=arrLength+UBound(arr)'//新的数组长度\n        J=0\n            ReDim Preserve arrList(L)\n        For I = arrLength To L\n            arrList(I)=arr(J)\n            J=J+1\n        Next\n        arrLength=arrLength+UBound(arr)+1\n    End If\n    If Err Then showErr \"ArrayList.AddArray()\"&#x26;amp;Err.Description:Err.Clear:Exit Sub\n    \nEnd Sub\n'//将元素插入ArrayList的指定index索引处,原有的arrList(index)及后面的元素都往后排\nPublic Sub Insert(index,v)\n    Dim I,v2\n    If index&#x26;lt;arrLength And index&#x26;gt;=0 Then\n        ReDim Preserve arrList(arrLength)\n    arrLength=arrLength+1\n    For I = index To arrLength - 1\n        v2=arrList(I)'//交换值\n        arrList(I)=v\n        v=v2\n    Next\n    Else\n            showErr \"下标越界:ArrayList.Insert()\"\n    End If\nEnd Sub\n'//将一组数组插入到指定的index处\nPublic Sub InsertArray(index,arr)\n    If index = \"\" Or Not IsNumeric(index) Then \n        showErr \"非法的参数:ArrayList.InsertArray()\":Exit Sub\n    End If\n    If index &#x26;lt; 0 Or index &#x26;gt; arrLength-1 Then\n        showErr \"下标越界:ArrayList.InsertArray()\":Exit Sub\n    End If\n    If Not IsArray(arr) Then showErr \"参数不是数组:ArrayList.InsertArray()\":Exit Sub\n    Dim I,L1,L2,J:J=0\n    On Error Resume Next\n    L1=UBound(arr)\n    L2=arrLength+L1\n    ReDim Preserve arrList(L2)\n    For I = arrLength -1 To index Step -1\n        arrList(I+L1+1)=arrList(I)'//把index之后的值往后移\n    Next\n    For I = index To index+L1\n        arrList(I)=arr(J)\n    J=J+1\n    Next\n    If Err Then showErr \"ArrayList.InsertArray()\"&#x26;amp;Err.Description:Err.Clear:Exit Sub\n    arrLength=arrLength+L1+1'//新的数组长度\nEnd Sub\n'//更新数组中索引为index的对应值\n'//by xilou 39949376\nPublic Sub Update(index,v)\n    If index = \"\" Or Not IsNumeric(index) Then \n        showErr \"非法的参数(index):ArrayList.Update()\":Exit Sub\n    End If\n    If index &#x26;lt; 0 Or index &#x26;gt; arrLength-1 Then\n        showErr \"下标越界(index):ArrayList.Update()\":Exit Sub\n    End If\n    arrList(index)=v\nEnd Sub\n\n'//从ArrayList中删除第一个匹配项,注意是第一个,将会得到一新的数组\nPublic Sub Remove(v)\n    Dim I,index\n    index = -1 '//第一个匹配的索引\n    For I = 0 To arrLength - 1\n        If arrList(I)=v Then index = I : Exit For\n    Next\n    If index &#x26;lt;&#x26;gt; -1 Then\n        For I = index To arrLength - 2\n        arrList(I) = arrList(I+1)'//值向前填充\n    Next\n    ReDim Preserve arrList(arrLength-1)'//收缩数组\n    arrLength = arrLength - 1\n    End If\nEnd Sub\n'//移除ArrayList的指定索引处的元素,将会得到一新的数组\nPublic Sub RemoveAt(index)\n    If index = \"\" Or Not IsNumeric(index) Then \n        showErr \"非法的参数(index):ArrayList.RemoveAt()\":Exit Sub\n    End If\n    If index &#x26;lt; 0 Or index &#x26;gt; arrLength-1 Then\n        showErr \"下标越界(index):ArrayList.RemoveAt()\":Exit Sub\n    End If\n    If index &#x26;gt; 0 Then\n        For I = index To arrLength - 2\n        arrList(I) = arrList(I+1)'//值向前填充\n        Next\n        ReDim Preserve arrList(arrLength-1)'//收缩数组\n        arrLength = arrLength - 1\n    End If\nEnd Sub\n'//从一个数组中移除从索引m到索引n的一段元素,并返回这段移除的数组\nPublic Function Splice(m,n)\n    If m = \"\" Or n = \"\" Or Not IsNumeric(m) Or Not IsNumeric(n) Then \n        showErr \"非法的参数(m,n):ArrayList.Splice()\":Exit Function\n    End If\n    If m &#x26;lt; 0 Or m &#x26;gt; arrLength-1 Or n &#x26;lt; 0 Or n &#x26;gt; arrLength-1 Then\n        showErr \"下标越界(m,n):ArrayList.Splice()\":Exit Function\n    End If\n    Dim newArr,x,L,I,J\n    newArr=Array()\n    If m &#x26;gt; n Then x=m:m=n:n=x '//交换数值\n    L=n-m\n    ReDim Preserve newArr(L)\n    For I = m To n\n        newArr(J)=arrList(I)'要移除的元素\n    J=J+1\n    Next\n    '//把n后面的元素的值移前\n    For I = (n+1) To arrLength -1\n        arrList(I-L-1)=arrList(I)\n    Next\n    arrLength=arrLength-L-1\n    ReDim Preserve arrList(arrLength)\n    Splice=newArr\nEnd Function\n'//清空数组,数组将变为空,长度Length=0\nPublic Sub Clear()\n    Erase arrList\n    arrLength=0\nEnd Sub\n'//将整个 ArrayList 中元素的顺序反转\nPublic Sub Reverse()\n    Dim L,I,J,v\n    J=arrLength-1\n        If arrLength &#x26;gt; 0 Then\n        L=Int(arrLength/2)\n    For I = 0 To L-1\n        v=arrList(I)\n        arrList(I)=arrList(J)\n        arrList(J)=v\n        J=J-1\n    Next\n    End If\nEnd Sub\n'//返回字符串值，其中包含了连接到一起的数组的所有元素，元素由指定的分隔符分隔开来\nPublic Function Implode(separator)\n    Implode=Join(arrList,separator)\nEnd Function\n'//返回ArrayList从m到n的一段数组\nPublic Function Slice(m,n)\n    If m = \"\" Or n = \"\" Or Not IsNumeric(m) Or Not IsNumeric(n) Then \n        showErr \"非法的参数:ArrayList.Slice()\":Exit Function\n    End If\n    If m &#x26;lt; 0 Or m &#x26;gt; arrLength-1 Or n &#x26;lt; 0 Or n &#x26;gt; arrLength-1 Then\n        showErr \"下标越界:ArrayList.Slice()\":Exit Function\n    End If\n    Dim I,J,newArr()\n    J=0\n    If m&#x26;lt;=n Then\n        ReDim Preserve newArr(n-m)\n    For I = m To n\n        newArr(J)=arrList(I)\n        J=J+1\n    Next\n    Else\n        ReDim Preserve newArr(m-n)\n    For I = n To m\n        newArr(J)=arrList(I)\n        J=J+1\n    Next\n    End If\n    Slice=newArr\n    Erase newArr\nEnd Function\n\n'//查找,返回ArrayList第一个匹配项的从零开始的索引。没找到返回-1。\n'//by xilou 39949376\nPublic Function IndexOf(v)\n    Dim I\n    For I = 0 To arrLength - 1\n    If arrList(I)=v Then IndexOf=I:Exit Function\n    Next\n    IndexOf=-1\nEnd Function\n'//返回ArrayList的最后一个匹配项的从零开始的索引。没找到返回-1。\nPublic Function LastIndexOf(v)\n    Dim I\n    If arrLength=0 Then\n        LastIndexOf=-1:Exit Function\n    Else\n        For I = (arrLength-1) To 0 Step -1\n        If arrList(I)=v Then LastIndexOf=I:Exit Function\n        Next\n    End If\n    LastIndexOf=-1\nEnd Function\n\n'//显示错误\nPrivate Sub showErr(errInfo)\n    Response.Write \"&#x26;lt;div id=\"\"ERRORINFO\"\" style=\"\"font-size:12px;color:#990000;font-family:\"\"新宋体\"\", Arial\"\"&#x26;gt;\"\n    Response.Write errInfo\n    Response.Write \"&#x26;lt;/div&#x26;gt;\"\n    Response.End()\nEnd Sub\n</code></pre>\n<p>End Class\n%>\n</pre></p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}}}},"staticQueryHashes":[],"slicesMap":{}}