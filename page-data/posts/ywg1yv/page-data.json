{"componentChunkName":"component---src-templates-post-js","path":"/posts/ywg1yv","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/ywg1yv","relativePath":"posts/ywg1yv","frontmatter":{"title":"Free Arch: Keycloak vs Authing","stackbit_url_path":"posts/ywg1yv","date":"2022-02-18T07:01:37","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p>纯粹出于个人兴趣，研究并实现了一个“关注微信公众号即登录”的社交登录方案。第一个版本为了验证可行快速出一个版本，没有从 0 开始，直接基于 Keycloak 做二次开发，将“微信”做为一个 IDP 插件集成进入 Keycloak。</p>\n<p>点击以下可以体验：</p>\n<p><a href=\"https://keycloak.jiwai.win/auth/realms/UniHeart/protocol/openid-connect/auth?response_type=code&#x26;redirect_uri=http%3A%2F%2Fsso.jiwai.win%2Fkeycloak%2Flogin&#x26;client_id=UniHeart-Client-Local-3000\">https://keycloak.jiwai.win/auth/realms/UniHeart/protocol/openid-connect/auth?response_type=code&#x26;redirect_uri=http%3A%2F%2Fsso.jiwai.win%2Fkeycloak%2Flogin&#x26;client_id=UniHeart-Client-Local-3000</a></p>\n<p>这篇文章分享出去后，收到一大波和 Keycloak 相关的付费咨询： <a href=\"https://www.zhihu.com/consult/people/1073548674713423872\">https://www.zhihu.com/consult/people/1073548674713423872</a>。</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645164292811-cc953842-a484-4c4c-90f3-12f00791f0d0.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=871&#x26;id=u4588b9dc&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1742&#x26;originWidth=1524&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=423332&#x26;status=done&#x26;style=none&#x26;taskId=ubd68408a-3689-477f-87c5-5aa420093a5&#x26;title=&#x26;width=762\" alt=\"image.png\"></p>\n<p>甚至有人找到了我所在的群，直接在微信里问我和 Keycloak 相关的问题。<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645164383440-c960d9ae-5ee3-4351-b51c-2bae1c194719.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=632&#x26;id=ufbccbc9f&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1264&#x26;originWidth=2002&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=1134644&#x26;status=done&#x26;style=none&#x26;taskId=u21c69c77-6dcb-4767-903d-b954c8e4c16&#x26;title=&#x26;width=1001\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645164652742-23303b8b-29c0-41f3-a0bb-b571f0a1ae5d.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=310&#x26;id=u95bf17d7&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=620&#x26;originWidth=1500&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=227907&#x26;status=done&#x26;style=none&#x26;taskId=u4c2d2e67-a379-4856-80d8-8d42b987a64&#x26;title=&#x26;width=750\" alt=\"image.png\"><br />这些咨询都是尝试解决企业里碰到的问题，而我，实际上还只在个人项目中使用 Keycloak。自己所在的企业其实面临着类似的问题，不过相关的决策权不在我手上，所以暂时没有机会真正在企业环境里应用 Keycloak。</p>\n<p>但是我对企业级的认证授权以及单点登录方案以及 Keycloak 这个开源项目特别有兴趣，因此非常乐意接受相关的（付费）咨询。 尽管我自认为我能得到这样的付费咨询，可能部分原因得益于 Keycloak 的中文化做得不够好。甚至它们的中文翻译有明显错误的地方，我因此还专门给 Keycloak 项目提过 PR：<a href=\"https://github.com/keycloak/keycloak/pull/7045\">https://github.com/keycloak/keycloak/pull/7045</a></p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165023008-a479fc64-33ec-427e-a7f7-1ebf83261f3f.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=886&#x26;id=uffdd3597&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1772&#x26;originWidth=2272&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=460387&#x26;status=done&#x26;style=none&#x26;taskId=u3a2c384c-115e-4f78-b6e6-5029e2d2641&#x26;title=&#x26;width=1136\" alt=\"image.png\"></p>\n<p>既然 Keycloak 对中文不太友好，那么是否存在对中文特别友好的其他的认证授权以及单点登录的方案呢？</p>\n<p>有！本文就是来分享身份云 Authing.cn 的（这是要断自己的财路呀……），并把它和 Keycloak 做一个简要对比。</p>\n<p>对比前，我在知乎上看到了 authing.cn 自己发的一篇文章：</p>\n<p>这篇文章留言不多，都是怼它的。我的留言也表示了这篇文章有误导，这里先详细解释一下。它的对比图里，最大的问题在于说 authing.cn 支持自定义数据库，但是 Keycloak 不支持：<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165427970-7b82f4e6-87ad-4fd3-8abb-1a36c03778ab.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=143&#x26;id=u60219252&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=286&#x26;originWidth=1198&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=81237&#x26;status=done&#x26;style=none&#x26;taskId=ue39c8927-f5ae-451d-9ce9-89a788ca78d&#x26;title=&#x26;width=599\" alt=\"image.png\"><br />这就扯蛋了。 Keycloak 原生支持的数据库（<a href=\"https://www.keycloak.org/server/db\">https://www.keycloak.org/server/db</a>）有：</p>\n<table>\n<thead>\n<tr>\n<th>数据库</th>\n<th>测试过的版本</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>mariadb</td>\n<td>10</td>\n</tr>\n<tr>\n<td>mssql</td>\n<td>2016</td>\n</tr>\n<tr>\n<td>mysql</td>\n<td>8</td>\n</tr>\n<tr>\n<td>oracle</td>\n<td>12c</td>\n</tr>\n<tr>\n<td>postgres</td>\n<td>10</td>\n</tr>\n</tbody>\n</table>\n<p>AWS 也提供了专门的 Keycloak 解决方案，同时支持 PostgreSQL 和 MySQL。</p>\n<p>还有以下这些它打叉的，其实都应该打勾。<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165612916-809f9cbf-8034-47a9-95b4-e54924cffd1b.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=71&#x26;id=uc924b647&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=142&#x26;originWidth=1144&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=40367&#x26;status=done&#x26;style=none&#x26;taskId=ua3fe57ca-052b-4c2b-8b37-188007a82db&#x26;title=&#x26;width=572\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165654156-2818fe2b-49a9-4edb-82a1-e55f92394264.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=30&#x26;id=ua92d8682&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=60&#x26;originWidth=760&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=16755&#x26;status=done&#x26;style=none&#x26;taskId=u81e6a7cb-84c4-4385-9ef8-56ee988a03e&#x26;title=&#x26;width=380\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165670700-0dde5d97-3037-4d57-822e-855b702d8b34.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=40&#x26;id=uf7ecad3d&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=80&#x26;originWidth=802&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=24800&#x26;status=done&#x26;style=none&#x26;taskId=u69ac6645-6efa-4dc2-8491-5a06d4b49c3&#x26;title=&#x26;width=401\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165680099-0694f630-017d-4cf3-b72e-2c6d9cfb599a.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=32&#x26;id=uc14227e8&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=64&#x26;originWidth=774&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=17043&#x26;status=done&#x26;style=none&#x26;taskId=uaa0ba88b-56f5-4143-8abb-7cc84c389c7&#x26;title=&#x26;width=387\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165699522-38d3dbe4-a44e-43e2-86c8-9aff99d02d07.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=54&#x26;id=ufe9c3e09&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=108&#x26;originWidth=804&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=18936&#x26;status=done&#x26;style=none&#x26;taskId=ud9b2ca1e-a9d2-45d0-9a9a-8e538476c28&#x26;title=&#x26;width=402\" alt=\"image.png\"></p>\n<p>不一一赘述。但是最后一个秒级安装部署，Keycloak 太支持啦。除开前面提到的 AWS 提供的部署方案（可能要钱），Free Arch 还给你提供了一种（几乎）免费的一键部署方案，即部署到 Heroku：</p>\n<p><a href=\"https://github.com/Jeff-Tian/keycloak-heroku\">https://github.com/Jeff-Tian/keycloak-heroku</a></p>\n<p>你只需要点一下“Deploy to Heroku”按钮，就能拥有自己的 Keycloak 了： <br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645165882937-efad2e0d-6f3d-41ef-9ca1-b8bde8e65842.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=784&#x26;id=uad790344&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1568&#x26;originWidth=2506&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=467935&#x26;status=done&#x26;style=none&#x26;taskId=udc2abfef-2a25-405e-8dfd-1291fc48294&#x26;title=&#x26;width=1253\" alt=\"image.png\"></p>\n<p>驳斥完 authing.cn 自己和 Keycloak 的对比文章，就要开始我做的对比了：</p>\n<p><a name=pLS4j></a></p>\n<h1>结论</h1>\n<p>authing.cn 为中国市场提供了丰富的特性。总的来说，虽然 authing.cn 能做的， Keycloak 也完全可以，但是 authing.cn 内置了很多特别的功能，使得开发者不用二次开发，就能直接对接。比如发送手机短信验证码，尽管 authing.cn 还不支持自定义短信验证码模板，但是默认的却可以立即使用。又比如它的微信生态，做得相当完整，还独创了 Web 应用的扫描小程序太阳码登录。但是它没有做“关注公众号即登录”，这有点遗憾（如果你想使用这个方案，可以直接使用我写的 Keycloak 微信插件；另外 authing.cn 的扫描小程序码登录的确很创新，我准备后面有空了也集成到 Keycloak 微信插件里）。</p>\n<p><a name=HLbk7></a></p>\n<h1>对 2B 的支持</h1>\n<p>authing 内置对 2B 的支持，而且做了专门的优化。而 Keycloak 虽然也能支持 2B 场景，但并未区分 2B 和 2C。</p>\n<p><a name=kCLuT></a></p>\n<h1>RBAC 的界面</h1>\n<p>都支持，但不得不说，authing.cn  的界面更加漂亮（它们自己的文章也说了这点，我同意）。Keycloak 的界面目前还是使用 Angular Js 开发的（不是 Angular！），的确有点过时的感觉。</p>\n<p><a name=SrAHG></a></p>\n<h2>Authing.cn 的界面</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166476025-7c46bf8a-9f8b-4fd2-ba3f-40322da0aebe.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=661&#x26;id=ue2113c65&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1322&#x26;originWidth=2912&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=441668&#x26;status=done&#x26;style=none&#x26;taskId=u89a047ee-74ab-451e-bc70-93aa8ba61b8&#x26;title=&#x26;width=1456\" alt=\"image.png\">\n<a name=KOqda></a></p>\n<h2>Keycloak 的界面</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166482305-5f6a67cb-6638-4a64-b56e-f8d56aca8670.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=324&#x26;id=u04b187cd&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=647&#x26;originWidth=1275&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=86364&#x26;status=done&#x26;style=none&#x26;taskId=u090d775b-378a-4c7d-b300-aed063d91e4&#x26;title=&#x26;width=637.5\" alt=\"image.png\"></p>\n<p><a name=RGQ32></a></p>\n<h1>管理门户</h1>\n<p>authing 有个用户池的概念，相应地，Keycloak 有个领域 (realm) 的概念。\n<a name=oHRYv></a></p>\n<h2>Authing.cn 的管理门户</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166551365-5936d38a-6214-4158-a56f-f79d3f1a2f37.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=475&#x26;id=u4b433954&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=950&#x26;originWidth=1768&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=154208&#x26;status=done&#x26;style=none&#x26;taskId=u5fd70f0a-a77d-4688-a0c1-c1151578382&#x26;title=&#x26;width=884\" alt=\"image.png\">\n<a name=lUw6N></a></p>\n<h2>Keycloak 的管理门户</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166569250-ab5c7435-292c-488d-abe4-7ba424c7c083.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=329&#x26;id=u22baf520&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=657&#x26;originWidth=1259&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=93108&#x26;status=done&#x26;style=none&#x26;taskId=u5c58eba1-a906-41ec-be10-76ab45ef219&#x26;title=&#x26;width=629.5\" alt=\"image.png\">\n<a name=ox4V2></a></p>\n<h1>对业务流程的支持（比如登录、登出、忘记密码等）</h1>\n<p>都支持，并且都可以通过 UI 或者代码进行自定义。\n<a name=taoGE></a></p>\n<h2>Authing.cn 对业务流程的支持</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166638748-90d3d76b-a4a6-49f6-9a62-8c2b9303774d.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=437&#x26;id=u6f9eb1a2&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=874&#x26;originWidth=1186&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=171755&#x26;status=done&#x26;style=none&#x26;taskId=u3563fb9d-8f01-452c-a391-5ee9b6a9c90&#x26;title=&#x26;width=593\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166657644-db5e0175-0e53-4b86-a964-f89c4df0a3de.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=943&#x26;id=uad850b0f&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1886&#x26;originWidth=2492&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=526164&#x26;status=done&#x26;style=none&#x26;taskId=u282ed9c6-8c79-43df-a76d-b01537ba714&#x26;title=&#x26;width=1246\" alt=\"image.png\"><br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166662912-d3c8188e-305f-41ab-a821-2edee94d1d7b.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=266&#x26;id=udc484648&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=532&#x26;originWidth=1257&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=171701&#x26;status=done&#x26;style=none&#x26;taskId=u818227b8-5955-409c-bca0-4649d975020&#x26;title=&#x26;width=628.5\" alt=\"image.png\">\n<a name=KVoOG></a></p>\n<h2>Keycloak 对业务流程的支持</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166692036-004dec60-5a61-48e5-806f-7d7f2b224420.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=328&#x26;id=ufc57d4df&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=655&#x26;originWidth=920&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=86907&#x26;status=done&#x26;style=none&#x26;taskId=uc716440f-087a-49ce-923f-ecf1be70d86&#x26;title=&#x26;width=460\" alt=\"image.png\">\n<a name=raCrj></a></p>\n<h1>短信通知集成</h1>\n<p>Authing 内置，使用 Keycloak 需要自行对接。\n<a name=JX7el></a></p>\n<h2>authing.cn 对短信通知的集成</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166799631-e1d5e50a-d0e4-4a19-98f6-f74225eff716.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=788&#x26;id=u7e8233c3&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1576&#x26;originWidth=1986&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=1211688&#x26;status=done&#x26;style=none&#x26;taskId=uadd05ecd-c447-42a5-8e03-a3bd6385935&#x26;title=&#x26;width=993\" alt=\"image.png\"><br />但是，它们不支持算定义短信模板，并且 QPS 限制在 100。<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166818518-635da592-8f08-4783-9f0e-bba4d09a7a95.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=362&#x26;id=ued39b33e&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=724&#x26;originWidth=1292&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=190202&#x26;status=done&#x26;style=none&#x26;taskId=u07594c9e-955b-4d8b-852d-6f974d7d176&#x26;title=&#x26;width=646\" alt=\"image.png\">\n<a name=vIAhX></a></p>\n<h2>Keycloak 的短信通知方案需要自己集成</h2>\n<p>Keycloak 只内置 Email 验证通知方案。</p>\n<p><a name=h2Jrs></a></p>\n<h1>审计日志</h1>\n<p>都支持。\n<a name=kXOlS></a></p>\n<h2>Authing.cn 的审计日志</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166891742-3ec38a29-7e6e-48f7-a716-59e30ae8d9f7.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=456&#x26;id=ud8be91b8&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=911&#x26;originWidth=1633&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=239013&#x26;status=done&#x26;style=none&#x26;taskId=u8a255c8e-ae48-47fb-a2b7-350eec78c43&#x26;title=&#x26;width=816.5\" alt=\"image.png\"></p>\n<p><a name=rJunR></a></p>\n<h2>Keycloak 的审计日志</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166903337-5a91a568-467e-4246-83d5-8a4acc504901.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=333&#x26;id=uf9811e1c&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=665&#x26;originWidth=1162&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=86219&#x26;status=done&#x26;style=none&#x26;taskId=u8dba963c-8451-49f9-ae85-1bfa48182a0&#x26;title=&#x26;width=581\" alt=\"image.png\">\n<a name=NGmal></a></p>\n<h1>数据迁移和备份</h1>\n<p>都支持。\n<a name=SYZX9></a></p>\n<h2>authing.cn</h2>\n<p>数据可以从管理门户直接导出：</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166945806-55f3ed04-7301-41c0-a866-6d4589a3aa18.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=354&#x26;id=u9642ac5c&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=707&#x26;originWidth=1901&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=149029&#x26;status=done&#x26;style=none&#x26;taskId=u45796d63-ccd9-430f-b5a5-630c27ae41e&#x26;title=&#x26;width=950.5\" alt=\"image.png\"><br />并且提供流水线自动化，这可以用来做数据备份：<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645166975443-f5660c4c-e93a-423d-97c8-e505732e6b8d.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=100&#x26;id=ua35138ce&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=199&#x26;originWidth=360&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=18084&#x26;status=done&#x26;style=none&#x26;taskId=ub3e5ffa2-775c-4b07-a5a5-8fd51f29bb6&#x26;title=&#x26;width=180\" alt=\"image.png\"><br />当然，也可以做私有化部署，应用和数据全部掌控在自己的环境中：<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167008356-6b3adbf8-3137-4a58-a689-92ee1ea3a329.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=508&#x26;id=uc496b876&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1015&#x26;originWidth=997&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=188065&#x26;status=done&#x26;style=none&#x26;taskId=u9256a523-34a0-4480-a6e2-52b55ed3b3a&#x26;title=&#x26;width=498.5\" alt=\"image.png\">\n<a name=VsTED></a></p>\n<h2>Keycloak</h2>\n<p>数据也可以从管理门户直接导出：<br /><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167033774-9fb6c0fb-1619-47d9-8e4f-82dd3f6e6c01.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=330&#x26;id=u86e4fd62&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=660&#x26;originWidth=837&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=62070&#x26;status=done&#x26;style=none&#x26;taskId=uf3e03f30-b14f-429a-9cce-1ad8bb52e4a&#x26;title=&#x26;width=418.5\" alt=\"image.png\"><br />而且它们支持多个数据存储源。如果采用 PostgreSQL，可以采用 Bucardo 来做跨数据中心的双活互备，当然，这是我在它们的老版本中这样实现的。它们最新的版本，会内置跨数据中心的双活部署方案：<br /><a href=\"https://www.keycloak.org/docs/latest/server_installation/#crossdc-mode\">https://www.keycloak.org/docs/latest/server_installation/#crossdc-mode</a><br />#<img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167154129-7eaa25f9-77c0-4e23-a0cf-34f3dbd3f902.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=499&#x26;id=ub40de628&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=998&#x26;originWidth=1487&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=274345&#x26;status=done&#x26;style=none&#x26;taskId=u41978aa8-a849-4a88-b74d-8ab6952dc3b&#x26;title=&#x26;width=743.5\" alt=\"image.png\">\n<a name=pKQBf></a></p>\n<h1>对 OAuth 2 和 jwt 的支持</h1>\n<p>都支持。\n<a name=eHJTj></a></p>\n<h2>authing 的 jwt 结构</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167224019-566e9513-27ee-41e6-b8d3-f1804f391015.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=508&#x26;id=u52e6e5ef&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1016&#x26;originWidth=1464&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=437270&#x26;status=done&#x26;style=none&#x26;taskId=u333f3410-767b-4bfb-8258-0b8e031d02a&#x26;title=&#x26;width=732\" alt=\"image.png\"></p>\n<p><a name=NnyYF></a></p>\n<h2>Keycloak 的 jwt 结构</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167258878-75f97c86-0c33-408d-8721-623c4e2c99d0.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=503&#x26;id=u0697f6e6&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1006&#x26;originWidth=1402&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=1288589&#x26;status=done&#x26;style=none&#x26;taskId=uafb93886-b9bf-422f-8494-4455a9ef101&#x26;title=&#x26;width=701\" alt=\"image.png\"></p>\n<p><a name=xwyfd></a></p>\n<h1>对微信生态的支持</h1>\n<p>这个只有 authing 内置了，Keycloak 需要自行开发，或者基于我的微信插件扩展。</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167300947-215f1167-271e-4ebf-9f56-07d0ef3f1ea7.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=485&#x26;id=u9462a6e4&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=970&#x26;originWidth=1254&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=203657&#x26;status=done&#x26;style=none&#x26;taskId=u02349ccf-0dde-4ad2-98b7-057ba488bad&#x26;title=&#x26;width=627\" alt=\"image.png\"></p>\n<p><a name=dhKGb></a></p>\n<h1>结束语</h1>\n<p>文章的开头有我做的 Keycloak 登录演示链接，在最后，放一个使用 authing.cn 登录的例子吧：欢迎通过 authing.cn 登录哈德韦小程序，成为哈德韦的朋友。🤝🤝🤝</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/221736/1645167682132-2f695768-a0d7-4d7e-95ff-48c52f300cb7.png#clientId=uf24b4cda-adc6-4&#x26;crop=0&#x26;crop=0&#x26;crop=1&#x26;crop=1&#x26;from=paste&#x26;height=215&#x26;id=u893caf29&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=430&#x26;originWidth=430&#x26;originalType=binary%E2%88%B6=1&#x26;rotation=0&#x26;showTitle=false&#x26;size=85118&#x26;status=done&#x26;style=none&#x26;taskId=u1da2a1d7-cb4c-4e38-a0f0-9069b2022db&#x26;title=&#x26;width=215\" alt=\"image.png\"></p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"本站源码","url":"https://github.com/Jeff-Tian/space","style":"link","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[]}