{"componentChunkName":"component---src-templates-post-js","path":"/posts/在ASP中组装QueryString的函数/","result":{"data":{"sitePage":{"id":"SitePage /posts/在ASP中组装QueryString的函数/"}},"pageContext":{"url":"/posts/在ASP中组装QueryString的函数/","relativePath":"posts/在ASP中组装QueryString的函数.md","relativeDir":"posts","base":"在ASP中组装QueryString的函数.md","name":"在ASP中组装QueryString的函数","frontmatter":{"title":"在ASP中组装QueryString的函数","stackbit_url_path":"posts/在ASP中组装QueryString的函数","date":"2009-12-25 16:20:24","excerpt":"","comments_count":0,"positive_reactions_count":0,"tags":[null],"canonical_url":"https://be-net.azurewebsites.net/post/2009/12/25/在ASP中组装QueryString的函数","template":"post"},"html":"<pre><code>    &#x3C;div style=\"text-indent: 2em;\">\n</code></pre>\n<p>在网址中，可以设置一些查询参数（网址带个问号?，问号?后面的内容即为查询参数），如 http://www.myfootprints.cn/?functions=sin(x%2B1/x)，就设置了functions为sin(x+1/x)。利用这些查询参数，可以预先对网页进行一些个性化定制（当然，这需要在网页里头设置好个性化定制的功能），上面的那个网址，即是说，打开 http://www.myfootprints.cn 这个网页，并在打开时呈现 y = sin(x+1/x) 函数的图像。</p>\n<p>在 ASP 开发中，有时需要根据当前页面的网址，给它指定一些查询参数（QueryString），并且不影响已经指定的其他参数。即，假如当前页面的网址为 http://www.myfootprints.cn，给它指定一个参数 functions=sin(x%2B1/x)。这种情况下，直接在网址后面添加一个问号?，然后再添加字符串“functions=sin(x%2B1/x)即可；然而如果传递过来的网址是 http://www.myfootprints.cn/?functions=x，那么，指定新参数 functions=sin(x%2B1/x) 的过程，就是直接将 functions=x 替换成 functions=sin(x%2B1/x) 就行了。</p>\n<p>为了能够方便并且统一地处理这种指定查询参数的过程（有时是在最后添加，有时是对某些参数进行替换，有时两者都要进行），我设计了如下的函数来做这件事情。有了此函数GetQueryString()，在ASP开发中，对某个网址进行查询参数的设定，只需要这样调用就行了：</p>\n<pre class=\"brush: vb\" style=\"text-indent: 0;\">Dim sUrl\nsUrl = Request.ServerVariables(\"PATH_INFO\") &amp; GetQueryString(\"functions=sin(x%2B1/x)\")\n</pre>\n<p>如果要指定多个参数，则将这些参数用数组的形式传递给GetQueryString()就行了。如：</p>\n<pre class=\"brush: vb\" style=\"text-indent: 0;\">Dim sUrl\nsUrl = Request.ServerVariables(\"PATH_INFO\") &amp; GetQueryString(Array(\"functions=sin(x%2B1/x)\", \"minOfx=-10\", \"maxOfx=10\"))\n</pre>\n<p>以下是GetQueryString()的源代码：</p>\n<pre class=\"brush: vb\" style=\"text-indent: 0;\">Public Function GetQueryString(saSpecQueryStrings)\n    Dim sCurQueryString, sSpecField, vSpecValue, i, lIndex, lIndex2\n<pre><code>' 获取当前的查询字符串\nsCurQueryString = Request.ServerVariables(\"QUERY_STRING\")\nIf Len(sCurQueryString) &#x26;gt; 0 Then\n    If IsArray(saSpecQueryStrings) Then\n        For i = LBound(saSpecQueryStrings) To UBound(saSpecQueryStrings)\n            sSpecField = Split(saSpecQueryStrings(i), \"=\")(0)\n            vSpecValue = Split(saSpecQueryStrings(i), \"=\")(1)\n            ' 找到形如 sField=vValue&#x26;amp; 的开始和结束位置\n            lIndex = InStr(1, sCurQueryString, sSpecField &#x26;amp; \"=\")                                            \n            If lIndex &#x26;gt; 0 Then\n                lIndex2 = InStr(lIndex, sCurQueryString, \"&#x26;amp;\")\n                ' 如果指定的查询字符串(i)在当前查询字符串中已经存在，则用指定的查询字符串(i)替换\n                GetQueryString = Left(sCurQueryString, lIndex-1) &#x26;amp; sSpecField &#x26;amp; \"=\" &#x26;amp; vSpecValue \n                If lIndex2 &#x26;gt; 0 Then\n                    GetQueryString = GetQueryString &#x26;amp; Right(sCurQueryString, Len(sCurQueryString) - lIndex2 + 1)\n                End If\n                sCurQueryString = GetQueryString\n            Else\n                ' 否则，将指定的查询字符串接在最后\n                sCurQueryString = sCurQueryString &#x26;amp; \"&#x26;amp;\" &#x26;amp; saSpecQueryStrings(i)\n            End If\n        Next\n    Else\n        sSpecField = Split(saSpecQueryStrings, \"=\")(0)\n        vSpecValue = Split(saSpecQueryStrings, \"=\")(1)\n        ' 找到形如 sField=vValue&#x26;amp; 的开始和结束位置\n        \n        lIndex = InStr(1, sCurQueryString, sSpecField &#x26;amp; \"=\")\n        \n        If lIndex &#x26;gt; 0 Then\n            lIndex2 = InStr(lIndex, sCurQueryString, \"&#x26;amp;\")\n            ' 如果指定的查询字符串(i)在当前查询字符串中已经存在，则用指定的查询字符串(i)替换\n            GetQueryString = Left(sCurQueryString, lIndex-1) &#x26;amp; sSpecField &#x26;amp; \"=\" &#x26;amp; vSpecValue \n            If lIndex2 &#x26;gt; 0 Then\n                GetQueryString = GetQueryString &#x26;amp; Right(sCurQueryString, Len(sCurQueryString) - lIndex2)\n            End If\n            sCurQueryString = GetQueryString\n        Else\n            ' 否则，将指定的查询字符串接在最后\n            sCurQueryString = sCurQueryString &#x26;amp; \"&#x26;amp;\" &#x26;amp; saSpecQueryStrings\n        End If\n    End If\nElse\n    sCurQueryString = Join(saSpecQueryStrings, \"&#x26;amp;\")\nEnd If\nGetQueryString = sCurQueryString\n</code></pre>\n<p>End Function\n</pre></p>\n</div>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}}}},"staticQueryHashes":[],"slicesMap":{}}