{"componentChunkName":"component---src-templates-post-js","path":"/posts/使用-JavaScript-将网页中的数据下载为Excel文件/","result":{"data":{"sitePage":{"id":"SitePage /posts/使用-JavaScript-将网页中的数据下载为Excel文件/"}},"pageContext":{"url":"/posts/使用-JavaScript-将网页中的数据下载为Excel文件/","relativePath":"posts/使用-JavaScript-将网页中的数据下载为Excel文件.md","relativeDir":"posts","base":"使用-JavaScript-将网页中的数据下载为Excel文件.md","name":"使用-JavaScript-将网页中的数据下载为Excel文件","frontmatter":{"title":"使用 JavaScript 将网页中的数据下载为Excel文件","stackbit_url_path":"posts/使用-JavaScript-将网页中的数据下载为Excel文件","date":"2010-05-13 07:44:27","excerpt":"","comments_count":0,"positive_reactions_count":0,"tags":[null],"canonical_url":"https://be-net.azurewebsites.net/post/2010/05/13/使用-JavaScript-将网页中的数据下载为Excel文件","template":"post"},"html":"<pre><code>    &#x3C;p>&#x26;nbsp;&#x3C;/p>\n</code></pre>\n<p>数据导出的方法可以分为两大类：第一类是在Web服务器端生成符合Excel格式的字符串或文件流供用户下载；第二类是在客户端使用Script脚本调用本地Excel对象。将数据直接插入到Excel文件中。</p>\n<p>&nbsp;</p>\n<p>数据导出既可以在Web服务器端，也可以在客户端实现，在客户端配置允许的情况下。一般建议使用客户端方式，具体实现方法，举例如下。</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<pre class=\"brush: javascript\">        function exportToExcel(sheetName) {\n            // 启动 Excel 和获取 Application 对象\n            var excelApp;\n<pre><code>        try {\n            excelApp = new ActiveXObject(\"Excel.Application\");\n        } catch (e) {\n            alert(\"Excel 创建失败。可能是因为浏览器安全设置未允许ActiveXObject的运行，或者你使用的浏览器不支持ActiveXObject，也可能是由于你的系统未安装Excel。\\n详细信息：\\n\" + e);\n            return;\n        }\n\n        // 增加工作薄和Sheet，指定Sheet名称\n        var wkb = excelApp.Workbooks.Add;\n        var wks = wkb.ActiveSheet;\n        wks.Name = sheetName;\n\n        var row, col;\n\n        row = 1;\n        col = 1;\n\n        // 表头\n        row++;\n        wks.Cells(row, col).Value = \"入仓储确认单\";\n\n        row++;\n        wks.Cells(row, col).Value = \"部门：\";\n        col++;\n        wks.Cells(row, col).Value = \"NOKIA 仓储组\";\n        col--;\n        row++;\n        wks.Cells(row, col).Value = \"入货日期：\";\n        col++;\n        wks.Cells(row, col).Value = \"2010年5月4日\";\n        col++;\n        wks.Cells(row, col).Value = \"共（）箱\";\n\n        var subTotalRow = row;\n        var subTotalCol = col;\n\n        // 表身\n        var table = document.getElementById(\"ctl00_ctl00_ContentPlaceHolder1_nwmsOperatorContentPlaceHolder_GridView_Warehousing\");\n        \n        for (var curRow = 1; curRow &#x26;lt; table.rows.length + 1; curRow++) {\n            theRow = table.rows[curRow - 1];\n            if (curRow &#x26;gt; 1) {\n                wks.Cells(curRow + row, 1).Value = curRow - 1;\n            } else {\n                wks.Cells(curRow + row, 1).Value = \"序列号\";\n            }\n            for (var curCell = 2; curCell &#x26;lt; theRow.cells.length + 1; curCell++) {\n                wks.Cells(curRow + row, curCell).Value = theRow.cells[curCell - 1].innerText;\n            }\n        }\n\n        wks.Cells(subTotalRow, subTotalCol).Value = \"共（\" + (curRow - 2) + \"）箱\";\n\n        // 表尾\n        row = curRow + row + 1;\n        col = 1;\n\n        wks.Cells(row, col).Value = \"NOKIA项目入货人：\";\n        col++;\n        wks.Cells(row, col).Value = \"张惠娟\";\n        col++;\n        wks.Cells(row, col).Value = \"大通仓储收货人：\";\n        col = 1;\n        row++;\n        wks.Cells(row, col).Value = \"入货日期：\";\n        col++;\n        var date = new Date();\n        wks.Cells(row, col).Value = date.getFullYear() + '-' + (date.getMonth()+1) + '-' + date.getDate();\n        col++;\n        wks.Cells(row, col).Value = \"收货日期：\";\n        \n        \n\n        // 显示 Excel\n        excelApp.Visible = true;\n    }&#x3C;font class=\"Apple-style-span\" face=\"Arial, Verdana, sans-serif\">&#x3C;span class=\"Apple-style-span\" style=\"white-space: normal;\"> &#x3C;/span>&#x3C;/font>&#x3C;/pre>\n</code></pre>\n<p>&nbsp;</p>\n<p>客户端导出方式的优势在于：首先。它采用的是客户端代码，不占用任何服务器资源；其次．采用了Excel Application对象编程，所有的格式和样式都可以通过编程实现，比较灵活；并且，生成的文件即为Excel 工作簿格式，无须转换即可导入。</p>\n<p>&nbsp;</p>\n<p>然而．正是因为在户端操作，就要求客户端安装Excel．并且在导出时最好不要进行别的Excel操作；同样，IE对安全性也有一些专门的要求，必须修改IE的安全配置：</p>\n<p>&nbsp;</p>\n<p>●将IIS站点加入IE的信任站点中，此时程序可以运行；</p>\n<p>&nbsp;</p>\n<p>●当打开Excel时．IE会弹出如图l提示要屏蔽此提示。可以更改IE安全设置或修改以下注册表键值：</p>\n<p>&nbsp;</p>\n<p>【HKEY_CURRENT_USERLSofiware\\Microsofl\\Windows\\CurrentVersion\\lntemet Settings\\Zones\\2】”1201”=dword：00000001</p>\n<p>\n</p><p>将”1201” 从dword：00000001 设为dword：00000000。</p>\n<p></p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[]}