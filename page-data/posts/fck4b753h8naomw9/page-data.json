{"componentChunkName":"component---src-templates-post-js","path":"/posts/fck4b753h8naomw9/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/fck4b753h8naomw9","relativePath":"posts/fck4b753h8naomw9","frontmatter":{"title":"对接 OIDC 服务的一般性步骤","stackbit_url_path":"posts/fck4b753h8naomw9","date":"2023-12-02T13:38:45","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p>前面的博文中反复提及一些对接 OIDC 服务的身份认证平台的具体案例，它们在工作中可能会非常频繁地使用到，因为身份认证是一个非常基础的功能，几乎所有的应用都需要。今天在这里来做个回顾总结，对它们的一般步骤进行一个统一梳理。\n<a name=wlbPp></a></p>\n<h1>（1）在身份认证平台注册应用</h1>\n<p>首先，我们需要在身份认证平台注册应用，这是接入身份认证的第一步。在注册应用时，我们需要提供应用的基本信息，例如应用名称、应用图标、应用描述等。但是，最重要的是我们需要提供应用的回调地址，这是身份认证平台用来将用户重定向回应用的地址。当然，我们还需要给应用起个名字，这个名字在身份认证平台中被称为客户端 ID。<br /> <br />表：注册应用时需要提供的信息</p>\n<table>\n<thead>\n<tr>\n<th><strong>信息</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>㊔ 应用名称</td>\n<td>应用的名称，用来标识一个客户端</td>\n</tr>\n<tr>\n<td>🔙 重定向地址</td>\n<td>您的应用端点将在用户被授权后从身份认证平台接收一些安全信息。</td>\n</tr>\n</tbody>\n</table>\n<p><a name=Y2lOJ></a></p>\n<h1>（2）在应用中配置身份认证平台的信息</h1>\n<p>一般的 OIDC 客户端都会默认从 OIDC 服务器的 /.well-known/openid-configuration 端点获取 OIDC 服务器的配置信息，这个端点是 OIDC 协议规定的，所有的 OIDC 服务器都必须实现。在这个端点中，OIDC 服务器会返回一些重要的信息，例如 OIDC 服务器的地址、支持的 OIDC 协议版本、支持的 OIDC 授权类型、支持的 OIDC Response Type、支持的 OIDC Scope、支持的 OIDC 签名算法、支持的 OIDC JWK 签名密钥等等。OIDC 客户端会根据这些信息来配置自己的 OIDC 客户端，以便与 OIDC 服务器进行交互。<br />如果您的 OIDC 客户端不支持从 /.well-known/openid-configuration 端点获取 OIDC 服务器的配置信息，那么您可以手动配置 OIDC 客户端，将 OIDC 服务器的地址、支持的 OIDC 协议版本、支持的 OIDC 授权类型、支持的 OIDC Response Type、支持的 OIDC Scope、支持的 OIDC 签名算法、支持的 OIDC JWK 签名密钥等信息填写到 OIDC 客户端中。\n<a name=qUm4h></a></p>\n<h1>（3）构造 OIDC 授权请求</h1>\n<p>在 OIDC 协议中，OIDC 授权请求是 OIDC 客户端向 OIDC 服务器发起的第一个请求，用于请求 OIDC 服务器对用户进行身份认证和授权。OIDC 授权请求中包含了 OIDC 客户端的身份信息，以及 OIDC 客户端请求的 OIDC 授权类型、OIDC Response Type、OIDC Scope、OIDC 随机数、OIDC 重定向地址等信息。<br />这个请求地址可以从 OIDC 服务器的 /.well-known/openid-configuration 端点中获取，一般是 <a href=\"https://oidc-server.com/connect/authorize\">https://oidc-server.com/connect/authorize</a> 。如下图所示：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVR42l2PUU/CMBSF9/9/j4ovGhNAREUCS2Rj7QqkgwGzXcvae9vNzUCiRk++nJyX7+EE7hwvSsV3+S7fCymV1qXWpVKl0idj0DlAd2n8R1BVFaITUpe6KrWx1gF452pEj+iNBQtoLFTG1nXT/U2gtXbeAzpXe2gMNNb4k/EnWxtooGnbtus+L7Tfzs8IKmOwOMTjYbYIeTJaR/2MPG7o3Ybcb1dDmYUimws+E3wus7DgU5mFdk9bh7/ycjRYjAbL8Zi/v+bpE6cPLL4l0RWLeizupdFNGl1vaV/yEA+rVhw7786yUgoAloTECYmThKRsJ+n6Y8qKCT08x/lgLWaseKPHF1ZMNmKu4Pjz+QtxvEympqunaQAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/e35304b2800f7d97012064d7ca5233b5/fcda8/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png\"\n        srcset=\"/static/e35304b2800f7d97012064d7ca5233b5/12f09/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 148w,\n/static/e35304b2800f7d97012064d7ca5233b5/e4a3f/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 295w,\n/static/e35304b2800f7d97012064d7ca5233b5/fcda8/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 590w,\n/static/e35304b2800f7d97012064d7ca5233b5/efc66/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 885w,\n/static/e35304b2800f7d97012064d7ca5233b5/c83ae/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 1180w,\n/static/e35304b2800f7d97012064d7ca5233b5/769f8/1701523551136-035dfe0b-f385-46f5-88e7-9c430da175ec.png 1924w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />一个授权请求的 URL 示例如下：</p>\n<p><a href=\"https://oidc-server.com/connect/authorize\">https://oidc-server.com/connect/authorize</a>?\nclient_id=client_id&#x26;\nresponse_type=code&#x26;\nscope=openid%20profile&#x26;\nredirect_uri=https%3A%2F%2Fclient.com%2Fcallback&#x26;\nstate=state&#x26;</p>\n<p>这时浏览器就会被重定向至身份认证平台的域，而身份认证平台最终会展示一个登录页面，让用户输入用户名和密码（或者其他凭据）进行登录。登录成功后，身份认证平台会将用户重定向回应用的回调地址，并在 URL 中带上授权码和状态码，如：</p>\n<p><a href=\"https://client.com/callback\">https://client.com/callback</a>?\ncode=code&#x26;\nstate=state</p>\n<p><a name=xQvac></a></p>\n<h1>（4）构造 OIDC Token 请求</h1>\n<p>在上面的一步中，你的应用已经接收到了来自 OIDC 服务器的授权码，接下来你的应用需要使用这个授权码来向 OIDC 服务器请求 OIDC Token。OIDC Token 请求是 OIDC 客户端向 OIDC 服务器发起的第二个请求，用于请求 OIDC 服务器颁发 OIDC Token。OIDC Token 请求中包含了 OIDC 客户端的身份信息，以及 OIDC 客户端请求的 OIDC Token 类型、OIDC 授权码、OIDC 重定向地址等信息。<br />这个请求地址可以从 OIDC 服务器的 /.well-known/openid-configuration 端点中获取，一般是 <a href=\"https://oidc-server.com/connect/token\">https://oidc-server.com/connect/token</a> 。如下图所示：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.486486486486484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42l2Oa2+CMBiF+f8/aM5MN+Mubk6RZC6A2lIKggJyKbT0gnVRl2zx5Mk5X94neQ2lVEPZPs3ifZJmh5KQqq7PTc5dU8qFuNJyfoPBuShKkuVlllekZpTxlkshFOeStqKhjLK2oYw0VEh5+o2+jsE5747HC0p1UnT8jOKyE7KT+t+tPt3GUEoFyPMBPBS+F33gyELxFESveDeL0q+C4JIEReWXBBckSCqQEa9oQqHYRa5KbM3syavz/hYsTW85jsEErwfB5hG6PbTqI/ceuX3o9rbuMC1B3oRcNlofL3LLAvt7bZnO/HO1MBNsB/gFeU8eHK7WdwA8+GgM4RDCAfJGUW5TUWit/94Ow63jugBC23HCMIpLB2Umyhab3cSNn/3MQukcJlOYzpztCCVz1Ymr/APlR4Id5E8s+AAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/4f71c9a06bf11294e020f1b251af97f0/fcda8/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png\"\n        srcset=\"/static/4f71c9a06bf11294e020f1b251af97f0/12f09/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 148w,\n/static/4f71c9a06bf11294e020f1b251af97f0/e4a3f/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 295w,\n/static/4f71c9a06bf11294e020f1b251af97f0/fcda8/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 590w,\n/static/4f71c9a06bf11294e020f1b251af97f0/efc66/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 885w,\n/static/4f71c9a06bf11294e020f1b251af97f0/c83ae/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 1180w,\n/static/4f71c9a06bf11294e020f1b251af97f0/565cc/1701523688675-c60afd10-b8bf-4a92-badf-96f9ebc2844c.png 1806w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />一个 OIDC Token 请求的 URL 示例如下：\nlatex\n<a href=\"https://oidc-server.com/connect/token\">https://oidc-server.com/connect/token</a>?\nclient_id=client_id&#x26;\nclient_secret=client_secret&#x26;\ngrant_type=authorization_code&#x26;\ncode=code&#x26;\nredirect_uri=https%3A%2F%2Fclient.com%2Fcallback</p>\n<p>这个请求可以使用 HTTP GET 或者 HTTP POST 方法发送，但是一般情况下，我们会使用 HTTP POST 方法发送这个请求，因为这个请求中包含了客户端的机密信息，例如客户端的密钥，如果使用 HTTP GET 方法发送这个请求，那么这些机密信息会暴露在 URL 中，这是非常危险的。</p>\n<p>以上请求得到的成功响应往往是类似下面这样的格式：</p>\n<p>json\n{\nid_token: eyJhbGciOi...,\naccess_token: eyJhbGciOi...,\nexpires_in: 1800,\ntoken_type: Bearer,\nrefresh_token: D8C63836215563320F809E29EB57D1B23DD3792722C6DFE07B99199E154B4412-1,\nscope: openid email profile offline_access\n}</p>\n<p><a name=AX6SB></a></p>\n<h1>（5）使用 OIDC Token 请求 OIDC 用户信息</h1>\n<p>在上一步中，我们已经成功地从 OIDC 服务器获取到了 OIDC Token，接下来我们需要使用这个 OIDC Token 来请求 OIDC 用户信息。OIDC 用户信息请求是 OIDC 客户端向 OIDC 服务器发起的第三个请求，用于请求 OIDC 服务器返回 OIDC 用户信息。OIDC 用户信息请求中包含了 OIDC 客户端的身份信息，以及 OIDC 客户端请求的 OIDC Token、OIDC 用户信息等信息。</p>\n<p>这个请求地址可以从 OIDC 服务器的 /.well-known/openid-configuration 端点中获取，一般是 <a href=\"https://oidc-server.com/connect/userinfo\">https://oidc-server.com/connect/userinfo</a> 。如下图所示：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVR42k2O2W7aQBhG/f4P1Co0jUKRQiDEuKGF8TpeMF7GMxjq2X87DTdRjs7Nd3GkzzHWDgM/nqq8LItjWTdtRxnpaEu6jrKWdNd/Axfy04GLTx2lNaF93dKyIqy/DJwLKYVUXEghJReCC6mUFlIJoYy10xccrTUAWABrR2un27ITwAQwAkxaW6WNtaC0UcoAjO9fcLTSfd8zxqTuGc8usuyuMbncPA9HofppGmE042jGycJoADSANlbaUTsAEMTxn/0BH7Gfb/d4k3UobJeoXoTtc9K5mLop9ZLuFVM3Y28p9TL21l4xV2fHnNlp5yWbFXpaFN7vJtw2ybLByzJ6LIKfefCjjB5P8bwIH4rwgaRrXgW2ziYx3G6b/tzsd+l2k3kb7K7LnUfwugjvc3+W+zOMvqXo+ymeZ/5d5t/l/qwI7lnyYobzLbYARVn+PSAUhnuEoiRlvIrIKmNe2D4fqjmqFyn1IrIKmqeYvKDqF+5cZcVH/B97OrYxxFf6AQAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/68eebe95dea64a4004e648a3ecc56be3/fcda8/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png\"\n        srcset=\"/static/68eebe95dea64a4004e648a3ecc56be3/12f09/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 148w,\n/static/68eebe95dea64a4004e648a3ecc56be3/e4a3f/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 295w,\n/static/68eebe95dea64a4004e648a3ecc56be3/fcda8/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 590w,\n/static/68eebe95dea64a4004e648a3ecc56be3/efc66/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 885w,\n/static/68eebe95dea64a4004e648a3ecc56be3/c83ae/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 1180w,\n/static/68eebe95dea64a4004e648a3ecc56be3/56caf/1701523800514-6ef5adf7-2e6c-4c27-832a-21b70e41234c.png 1712w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />![OIDC 用户信息请求](../resources/oidc-userinfo.png#id=z4Stj&#x26;originalType=binary∶=1&#x26;rotation=0&#x26;showTitle=true&#x26;status=done&#x26;style=none&#x26;title=OIDC%20%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E8%AF%B7%E6%B1%82 OIDC 用户信息请求)</p>\n<p>一个 OIDC 用户信息请求的 URL 示例如下：</p>\n<p>latex\n<a href=\"https://oidc-server.com/connect/userinfo\">https://oidc-server.com/connect/userinfo</a>?\naccess_token=access_token</p>\n<p>这个请求可以使用 HTTP GET 或者 HTTP POST 方法发送，但是一般情况下，我们会使用 HTTP GET 方法发送这个请求，因为这个请求中不包含任何机密信息。</p>\n<p>以上请求得到的成功响应往往是类似下面这样的格式：</p>\n<p>json\n{\nsub: d9df1959-7a18-4753-8642-c0ec0d20ae67,\nemail: <a href=\"mailto:jeff.tian@outlook.com\">jeff.tian@outlook.com</a>,\npreferred_username: jeff-tian,\nname: jeff,\nemail_verified: true\n}</p>\n<p><a name=tPLo1></a></p>\n<h1>（6）调用退出端点</h1>\n<p>当您想要登出用户时，您需要将用户重定向到身份认证平台的结束会话端点，同时带有从令牌端点获取的id_token以及应用程序的URL。例如：</p>\n<p>latex\n<a href=\"https://oidc-server.com/connect/endsession?id_token_hint=$%7Bid_token%7D&#x26;post_logout_redirect_uri=$%7BencodeURIComponent(%E5%BA%94%E7%94%A8%E5%9C%B0%E5%9D%80)%7D\">https://oidc-server.com/connect/endsession?id_token_hint=${id_token}&#x26;post_logout_redirect_uri=${encodeURIComponent(应用地址)}</a></p>\n<p>具体的退出登录端点地址可以从 OIDC 服务器的 /.well-known/openid-configuration 端点中获取，一般是 <a href=\"https://oidc-server.com/connect/endsession\">https://oidc-server.com/connect/endsession</a> 。如下图所示：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR42l2LiU7CQBRF+/9/YzQxSFASgwoUxIhU2k6nKy3d2+nMdJa2SiDEeHPuy8tNjsI550KUVeUdQscLgjBKsizN8yS93LKqMKVXGkKuKE3TUNomWXFM8/CYljVCmGDSUsowoaghqMGY0AaTGuGW8eFPFIQQY6w7pz9VSHn+uq6Tl7Xv+17Kvu+H/zLnPIrCIi8qfMiQlSEY5lpU7OPKLHEgJBWSckHOUFYz3hBWctmeZCEEsIAFbS9wDfcTeNsg14xoBtMViBdWvICJaicrEM/d7CModn6+LXDIRavUCPGqgJv1Xl3s5m/u1/YA1cB5cawpNMeGfmeZDzaYQHMMzJFvP+fhlhfHoa4HKZWyRjxL3PclWC/tjarPXyNNi+yZb0498xHu78H3rW8+ucbE1keO/mBoN64xaSPrV/4BxROBy8KRi5wAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/8f03568f553e9e5f64c448a180a0351b/fcda8/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png\"\n        srcset=\"/static/8f03568f553e9e5f64c448a180a0351b/12f09/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 148w,\n/static/8f03568f553e9e5f64c448a180a0351b/e4a3f/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 295w,\n/static/8f03568f553e9e5f64c448a180a0351b/fcda8/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 590w,\n/static/8f03568f553e9e5f64c448a180a0351b/efc66/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 885w,\n/static/8f03568f553e9e5f64c448a180a0351b/c83ae/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 1180w,\n/static/8f03568f553e9e5f64c448a180a0351b/2ed34/1701523929010-9a2242af-e935-46a6-aac0-a54f9d79266f.png 1776w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span><br />![OIDC 退出端点](../resources/oidc-logout.png#id=TNBcw&#x26;originalType=binary∶=1&#x26;rotation=0&#x26;showTitle=true&#x26;status=done&#x26;style=none&#x26;title=OIDC%20%E9%80%80%E5%87%BA%E7%AB%AF%E7%82%B9 OIDC 退出端点)</p>\n<p>一个典型的退出时序图如下图所示：</p>\n<p><a name=56ffb8bf></a></p>\n<h1>相关故障排除指引</h1>\n<p>这里列出一些常常遇到的问题，以及解决方案：</p>\n<p><a name=84cb7b6b></a></p>\n<h2>为什么无法从用户信息接口里获取到 Email</h2>\n<p>检查在构造授权请求的环节，传递给授权端点的范围（scope）。如果没有请求电子邮件（email），那么它就不会返回。典型的范围是 openid profile email。</p>\n<p><a name=3b2b42f1></a></p>\n<h2>为什么无法退出</h2>\n<p>检查您的应用程序是否正确配置，特别是关于结束会话端点的部分。否则，很可能只是假地重定向到了一个退出登录的页面而已，一旦点击重新登录，都不需要输入用户凭据，就直接进入了登录态。</p>\n<p><a name=eug4o></a></p>\n<h1>总结</h1>\n<p>本文总结了接入 OIDC 服务的一般步骤，具体如下：</p>\n<ol>\n<li>在身份认证平台注册应用：提供应用基本信息和回调地址。</li>\n<li>在应用中配置身份认证平台信息：默认从 OIDC 服务器的 /.well-known/openid-configuration 获取配置信息，或手动配置 OIDC 客户端。</li>\n<li>构造 OIDC 授权请求：包括客户端身份信息、授权类型、响应类型等，重定向至身份认证平台进行用户登录验证。</li>\n<li>构造 OIDC Token 请求：使用授权码向 OIDC 服务器请求 OIDC Token，包括身份信息、授权码等。</li>\n<li>使用 OIDC Token 请求 OIDC 用户信息：使用 OIDC Token 向 OIDC 服务器请求用户信息，包括用户ID、邮箱、用户名等。</li>\n<li>调用退出端点：当需要退出用户时，重定向至 OIDC 服务器的结束会话端点，并传递 id_token 和应用回调地址。</li>\n</ol>\n<p>文章还提供了一些常见故障排除指引，例如无法获取邮箱信息或退出登录问题。</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}