{"componentChunkName":"component---src-templates-post-js","path":"/posts/ASP-操作数据库的一个数据库类文件-CDatabaseasp/","result":{"data":{"sitePage":{"id":"SitePage /posts/ASP-操作数据库的一个数据库类文件-CDatabaseasp/"}},"pageContext":{"url":"/posts/ASP-操作数据库的一个数据库类文件-CDatabaseasp/","relativePath":"posts/ASP-操作数据库的一个数据库类文件-CDatabaseasp.md","relativeDir":"posts","base":"ASP-操作数据库的一个数据库类文件-CDatabaseasp.md","name":"ASP-操作数据库的一个数据库类文件-CDatabaseasp","frontmatter":{"title":"ASP 操作数据库的一个数据库类文件 CDatabase.asp","stackbit_url_path":"posts/ASP-操作数据库的一个数据库类文件-CDatabaseasp","date":"2009-11-16 15:59:46","excerpt":"","comments_count":0,"positive_reactions_count":0,"tags":[null],"canonical_url":"https://be-net.azurewebsites.net/post/2009/11/16/ASP-操作数据库的一个数据库类文件-CDatabaseasp","template":"post"},"html":"<pre><code>    &#x3C;div style=\"text-indent: 2em;\">\n</code></pre>\n<p>为了能在世界各地方便地管理服务器上的数据库,我建立了一个基于网页的数据库管理系统。</p>\n<p>为了能方便地对数据库进行操作,我建立了一个基于ASP的数据库类。用来封装与数据库相关的常用操作，如连接数据库，关闭数据库连接，获取一个查询记录，或者执行指定的SQL语句等。</p>\n<p>代码如下:</p>\n<div style=\"text-indent: 0;\">\n<pre class=\"brush: vb\">&lt;!--#include file=\"adovbs.inc\"--&gt;\n&lt;%\n'\n' Author:       Jeff Tian, admin@myfootprints.cn\n'\n<p>'#* Using ../inc/adovbs.inc *#\nClass CError\nPublic Number\nPublic Description\nPublic Source</p>\n<pre><code>Public Sub CopyErrorObject(oErr)\n    Number = oErr.number\n    Description = oErr.Description\n    Source = oErr.Source\nEnd Sub\n</code></pre>\n<p>End Class</p>\n<p>Class CDatabase\n' 数据库连接对象\nPublic oConn\n' 数据集对象\nPublic oRS\n' 错误对象，用来记录最近的一次错误\nPublic oError</p>\n<pre><code>Private Sub Class_Initialize()\n    Set oConn = CreateObject(\"ADODB.Connection\")\n    Set oRS = CreateObject(\"ADODB.Recordset\")\n    Set oError = New CError\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    CloseRecordset\n    Disconnect\n    Set oConn = Nothing\n    Set oRS = Nothing\n    Set oError = Nothing\nEnd Sub\n\n'\n' 获取数据集对象的记录数\n'\nPublic Property Get RecordCount()\n    If Me.oRS.State &#x26;gt; 0 Then\n        RecordCount = Me.oRS.RecordCount\n    Else\n        RecordCount = 0\n    End If\nEnd Property\n\n'\n' 将游标回到记录集的第一行\n'\nPublic Sub MoveFirst()\n    If Me.oRS.State &#x26;gt; 0 Then\n        If Me.oRS.RecordCount &#x26;gt; 0 Then\n            Me.oRS.MoveFirst\n        End If\n    End If\nEnd Sub\n\n'\n' 获取连接SQL Server数据库的字符串\n'\nPublic Function GetConnectionString2SQLServer(ByVal sIP, ByVal sUID, ByVal sPwd, ByVal sDB)\n    GetConnectionString2SQLServer = \"Driver={SQL Server};Server=\" &#x26;amp; sIP &#x26;amp; \";UID=\" &#x26;amp; sUID &#x26;amp; \";PWD=\" &#x26;amp; sPWD &#x26;amp; \";database=\" &#x26;amp; sDB &#x26;amp; \";\"\nEnd Function\n\n'\n' Get base connection string syntax.\n'\nPublic Function GetBaseConnectionString2SQLServer(ByVal sIP, ByVal sDB)\n    GetBaseConnectionString2SQLServer = \"Provider=SQLOLEDB;\" &#x26;amp; _\n                                        \"Data Source=\" &#x26;amp; sIP &#x26;amp; \";\" &#x26;amp; _\n                                        \"Initial Catalog=\" &#x26;amp; sDB &#x26;amp; \";\"\nEnd Function\n\n'\n' Get standard security connection string\n'\nPublic Function GetStandardSecurityConnectionString2SQLServer(ByVal sIP, ByVal sUID, ByVal sPwd, ByVal sDB)\n    GetStandardSecurityConnectionString2SQLServer = \"Provider=SQLOLEDB;\" &#x26;amp; _\n                                                    \"Data Source=\" &#x26;amp; sIP &#x26;amp; \";\" &#x26;amp; _\n                                                    \"Initial Catalog=\" &#x26;amp; sDB &#x26;amp; \";\" &#x26;amp; _\n                                                    \"User ID=\" &#x26;amp; sUID &#x26;amp; \";\" &#x26;amp; _\n                                                    \"Password=\" &#x26;amp; sPwd &#x26;amp; \";\"\nEnd Function\n\n'\n' Get Windows integrated security connection string\n'\nPublic Function GetWindowsIntegratedSecurityConnectionString2SQLServer(ByVal sIP, ByVal sDB)\n    GetWindowsIntegratedSecurityConnectionString2SQLServer = \"Provider=SQLOLEDB;\" &#x26;amp; _\n                                                                \"Data Source=\" &#x26;amp; sIP &#x26;amp; \";\" &#x26;amp; _\n                                                                \"Initial Catalog=\" &#x26;amp; sDB &#x26;amp; \":\" &#x26;amp; _\n                                                                \"Integrated Security=SSIP\"\nEnd Function\n\n'\n' Get an ADO connection string to Access database.\n'\nPublic Function GetADOConnectionString2Access(ByVal sDBPath, ByVal sUID, ByVal sPwd)\n    GetADOConnectionString2Access = \"Provider=Microsoft.Jet.OLEDB.4.0;\" &#x26;amp; _\n                                    \"Data Source=\" &#x26;amp; sDBPath &#x26;amp; \";\" &#x26;amp; _\n                                    \"User ID=\" &#x26;amp; sUID &#x26;amp; \";\" &#x26;amp; _\n                                    \"Password=\" &#x26;amp; sPwd &#x26;amp; \";\"\nEnd Function\n\n'\n' Get an ADO Connection String to an Excel workbook\n'\nPublic Function GetADOConnectionString2Excel(ByVal sDBPath)\n    GetADOConnectionString2Excel = \"Provider=Microsoft.Jet.OLEDB.4.0;\" &#x26;amp; _\n                                    \"Data Source=\" &#x26;amp; sDBPath &#x26;amp; \";\" &#x26;amp; _\n                                    \"Extended Properties=\"\"Excel 8.0;HDR=YES\"\";\"\nEnd Function\n\n'\n' Get an DBQ Connection String to an MSAccess\n'\nPublic Function GetDBQConnectionString2Access(ByVal sDBPath, ByVal sUID, ByVal sPwd)\n    GetDBQConnectionString2Access = \"Driver={Microsoft Access Driver (*.mdb)};Dbq=\" &#x26;amp; sDBPath &#x26;amp; \";Uid=\" &#x26;amp; sUID &#x26;amp; \";Pwd=\" &#x26;amp; sPwd &#x26;amp; \";\"\nEnd Function\n\n'\n' Connect to Access\n'\nPublic Function Connect2Access(ByVal sDBPath, ByVal sUID, ByVal sPwd)\n    Const sSOURCE = \"Connect2Acess()\"\nOn Error Resume Next\n        ' 如果不是关闭状态，则先关闭它\n        If oConn.State &#x26;lt;&#x26;gt; adStateClosed Then\n            Me.Disconnect\n        End If\n        Me.oConn.Open GetDBQConnectionString2Access(sDBPath, sUID, sPwd)\n'ErrorExit:\n        Connect2Access = oConn.State\n        Exit Function\nEnd Function\n\n'\n' 连接到SQL Server\n'\nPublic Function Connect2SQLServer(ByVal sIP, ByVal sUID, ByVal sPwd, ByVal sDB)\n    Const sSOURCE = \"Connect2SQLServer()\"\n    'On Error Resume Next\n        ' 如果不是关闭状态，则先关闭\n        If oConn.State &#x26;lt;&#x26;gt; adStateClosed Then\n            Me.Disconnect\n        End If\n        oConn.Open GetConnectionString2SQLServer(sIP, sUID, sPwd, sDB)\nErrorExit:\n    ' 将数据库连接对象的状态值作为返回值\n        Connect2SQLServer = oConn.State\n        Exit Function\nEnd Function\n\n'\n' 从当前SQL Server连接断开\n'\nPublic Function Disconnect()\n    If oConn.State &#x26;lt;&#x26;gt; adStateClosed Then\n        oConn.Close\n    End If\n    Disconnect = oConn.State\nEnd Function\n\n'\n' 执行查询\n'\nPublic Function OpenRecordset(ByVal sSQL)\n    ' 当数据集对象不是关闭状态时，先关闭\n    CloseRecordset\n    ' 当数据库连接对象是关闭状态时，不能打开\n    If oConn.State = adStateClosed Then\n        OpenRecordset = oConn.State\n        Exit Function\n    End If\n    On Error Resume Next\n    oRS.Open sSQL, oConn, AdOpenKeyset, AdLockReadOnly\n    If Err.number &#x26;lt;&#x26;gt; 0 Then\n        oError.CopyErrorObject Err\n    End If\n    On Error Goto 0\n    OpenRecordset = oRS.State\nEnd Function\n\n'\n' 执行查询，不指定Cursor类型和Lock类型\n' \nPublic Function OpenRecordsetWithoutCursorAndLockType(ByVal sSQL)\n    CloseRecordset\n    If oConn.State = adStateClosed Then\n        OpenRecordsetWithoutCursorAndLockType = oConn.State\n        Exit Function\n    End If\n    On Error Resume Next\n    oRS.Open sSQL, oConn\n    If Err.number &#x26;lt;&#x26;gt; 0 Then\n        oError.CopyErrorObject Err\n    End If\n    On Error Goto 0\n    OpenRecordsetWithoutCursorAndLockType = oRS.State\nEnd Function\n\n'\n' HTML格式化错误信息\n'\nPublic Function FormatError(oError)\n    dim sErr\n    \n    sErr = \"错误号： \" &#x26;amp; oError.Number\n    sErr = sErr &#x26;amp; \"错误描述： \" &#x26;amp; oError.Description\n    \n    FormatError = sErr\nEnd Function\n\n'\n' 执行指定的SQL语句\n'\nPublic Function Execute(ByRef sSQL, ByRef lRecordsAffected)\n    If oConn.State = adStateClosed Then\n        Execute = Me.oConn.State\n        Exit Function\n    End If\n    \n    On Error Resume Next\n    Set Me.oRS = Me.oConn.Execute(sSQL, lRecordsAffected)\n    If Err.number &#x26;lt;&#x26;gt; 0 Then\n        oError.CopyErrorObject Err\n    End If\n    On Error Goto 0\n    Execute = Me.oConn.State\n    Exit Function\nEnd Function\n\n'\n' 关闭数据集\n'\nPublic Function CloseRecordset()\n    If oRS.State &#x26;lt;&#x26;gt; adStateClosed Then\n        oRS.Close\n    End If\n    \n    CloseRecordset = oRS.State\nEnd Function\n\n'\n' 输出数据集\n' 本想用回调函数，可是在VB里实现起来很困难\n'\n'Public Function OutputRecordset(ByVal CallBack, ByRef vDest)\n'    If orS.State = adStateClosed Then\n'        OutputRecordset = orS.State\n'        Exit Function\n'    Else\n'        CallBack orS, vDest\n'    End If\n'End Function\n</code></pre>\n<p>End Class\n%>\n</pre></p>\n</div>\n<p>其中有用到一个常用的常量集合，即包含文件adovbs.inc。该文件的源代码为：</p>\n<div style=\"text-indent: 0;\">\n<pre class=\"brush: vb\">&lt;%\n'--------------------------------------------------------------------\n' Microsoft ADO\n'\n' Copyright (c) 1996-1998 Microsoft Corporation.\n'\n'\n'\n' ADO constants include file for VBScript\n'\n'--------------------------------------------------------------------\n<p>'---- CursorTypeEnum Values ----\nConst adOpenForwardOnly = 0\nConst adOpenKeyset = 1\nConst adOpenDynamic = 2\nConst adOpenStatic = 3</p>\n<p>'---- CursorOptionEnum Values ----\nConst adHoldRecords = &#x26;H00000100\nConst adMovePrevious = &#x26;H00000200\nConst adAddNew = &#x26;H01000400\nConst adDelete = &#x26;H01000800\nConst adUpdate = &#x26;H01008000\nConst adBookmark = &#x26;H00002000\nConst adApproxPosition = &#x26;H00004000\nConst adUpdateBatch = &#x26;H00010000\nConst adResync = &#x26;H00020000\nConst adNotify = &#x26;H00040000\nConst adFind = &#x26;H00080000\nConst adSeek = &#x26;H00400000\nConst adIndex = &#x26;H00800000</p>\n<p>'---- LockTypeEnum Values ----\nConst adLockReadOnly = 1\nConst adLockPessimistic = 2\nConst adLockOptimistic = 3\nConst adLockBatchOptimistic = 4</p>\n<p>'---- ExecuteOptionEnum Values ----\nConst adAsyncExecute = &#x26;H00000010\nConst adAsyncFetch = &#x26;H00000020\nConst adAsyncFetchNonBlocking = &#x26;H00000040\nConst adExecuteNoRecords = &#x26;H00000080\nConst adExecuteStream = &#x26;H00000400</p>\n<p>'---- ConnectOptionEnum Values ----\nConst adAsyncConnect = &#x26;H00000010</p>\n<p>'---- ObjectStateEnum Values ----\nConst adStateClosed = &#x26;H00000000\nConst adStateOpen = &#x26;H00000001\nConst adStateConnecting = &#x26;H00000002\nConst adStateExecuting = &#x26;H00000004\nConst adStateFetching = &#x26;H00000008</p>\n<p>'---- CursorLocationEnum Values ----\nConst adUseServer = 2\nConst adUseClient = 3</p>\n<p>'---- DataTypeEnum Values ----\nConst adEmpty = 0\nConst adTinyInt = 16\nConst adSmallInt = 2\nConst adInteger = 3\nConst adBigInt = 20\nConst adUnsignedTinyInt = 17\nConst adUnsignedSmallInt = 18\nConst adUnsignedInt = 19\nConst adUnsignedBigInt = 21\nConst adSingle = 4\nConst adDouble = 5\nConst adCurrency = 6\nConst adDecimal = 14\nConst adNumeric = 131\nConst adBoolean = 11\nConst adError = 10\nConst adUserDefined = 132\nConst adVariant = 12\nConst adIDispatch = 9\nConst adIUnknown = 13\nConst adGUID = 72\nConst adDate = 7\nConst adDBDate = 133\nConst adDBTime = 134\nConst adDBTimeStamp = 135\nConst adBSTR = 8\nConst adChar = 129\nConst adVarChar = 200\nConst adLongVarChar = 201\nConst adWChar = 130\nConst adVarWChar = 202\nConst adLongVarWChar = 203\nConst adBinary = 128\nConst adVarBinary = 204\nConst adLongVarBinary = 205\nConst adChapter = 136\nConst adFileTime = 64\nConst adPropVariant = 138\nConst adVarNumeric = 139\nConst adArray = &#x26;H2000</p>\n<p>'---- FieldAttributeEnum Values ----\nConst adFldMayDefer = &#x26;H00000002\nConst adFldUpdatable = &#x26;H00000004\nConst adFldUnknownUpdatable = &#x26;H00000008\nConst adFldFixed = &#x26;H00000010\nConst adFldIsNullable = &#x26;H00000020\nConst adFldMayBeNull = &#x26;H00000040\nConst adFldLong = &#x26;H00000080\nConst adFldRowID = &#x26;H00000100\nConst adFldRowVersion = &#x26;H00000200\nConst adFldCacheDeferred = &#x26;H00001000\nConst adFldIsChapter = &#x26;H00002000\nConst adFldNegativeScale = &#x26;H00004000\nConst adFldKeyColumn = &#x26;H00008000\nConst adFldIsRowURL = &#x26;H00010000\nConst adFldIsDefaultStream = &#x26;H00020000\nConst adFldIsCollection = &#x26;H00040000</p>\n<p>'---- EditModeEnum Values ----\nConst adEditNone = &#x26;H0000\nConst adEditInProgress = &#x26;H0001\nConst adEditAdd = &#x26;H0002\nConst adEditDelete = &#x26;H0004</p>\n<p>'---- RecordStatusEnum Values ----\nConst adRecOK = &#x26;H0000000\nConst adRecNew = &#x26;H0000001\nConst adRecModified = &#x26;H0000002\nConst adRecDeleted = &#x26;H0000004\nConst adRecUnmodified = &#x26;H0000008\nConst adRecInvalid = &#x26;H0000010\nConst adRecMultipleChanges = &#x26;H0000040\nConst adRecPendingChanges = &#x26;H0000080\nConst adRecCanceled = &#x26;H0000100\nConst adRecCantRelease = &#x26;H0000400\nConst adRecConcurrencyViolation = &#x26;H0000800\nConst adRecIntegrityViolation = &#x26;H0001000\nConst adRecMaxChangesExceeded = &#x26;H0002000\nConst adRecObjectOpen = &#x26;H0004000\nConst adRecOutOfMemory = &#x26;H0008000\nConst adRecPermissionDenied = &#x26;H0010000\nConst adRecSchemaViolation = &#x26;H0020000\nConst adRecDBDeleted = &#x26;H0040000</p>\n<p>'---- GetRowsOptionEnum Values ----\nConst adGetRowsRest = -1</p>\n<p>'---- PositionEnum Values ----\nConst adPosUnknown = -1\nConst adPosBOF = -2\nConst adPosEOF = -3</p>\n<p>'---- BookmarkEnum Values ----\nConst adBookmarkCurrent = 0\nConst adBookmarkFirst = 1\nConst adBookmarkLast = 2</p>\n<p>'---- MarshalOptionsEnum Values ----\nConst adMarshalAll = 0\nConst adMarshalModifiedOnly = 1</p>\n<p>'---- AffectEnum Values ----\nConst adAffectCurrent = 1\nConst adAffectGroup = 2\nConst adAffectAllChapters = 4</p>\n<p>'---- ResyncEnum Values ----\nConst adResyncUnderlyingValues = 1\nConst adResyncAllValues = 2</p>\n<p>'---- CompareEnum Values ----\nConst adCompareLessThan = 0\nConst adCompareEqual = 1\nConst adCompareGreaterThan = 2\nConst adCompareNotEqual = 3\nConst adCompareNotComparable = 4</p>\n<p>'---- FilterGroupEnum Values ----\nConst adFilterNone = 0\nConst adFilterPendingRecords = 1\nConst adFilterAffectedRecords = 2\nConst adFilterFetchedRecords = 3\nConst adFilterConflictingRecords = 5</p>\n<p>'---- SearchDirectionEnum Values ----\nConst adSearchForward = 1\nConst adSearchBackward = -1</p>\n<p>'---- PersistFormatEnum Values ----\nConst adPersistADTG = 0\nConst adPersistXML = 1</p>\n<p>'---- StringFormatEnum Values ----\nConst adClipString = 2</p>\n<p>'---- ConnectPromptEnum Values ----\nConst adPromptAlways = 1\nConst adPromptComplete = 2\nConst adPromptCompleteRequired = 3\nConst adPromptNever = 4</p>\n<p>'---- ConnectModeEnum Values ----\nConst adModeUnknown = 0\nConst adModeRead = 1\nConst adModeWrite = 2\nConst adModeReadWrite = 3\nConst adModeShareDenyRead = 4\nConst adModeShareDenyWrite = 8\nConst adModeShareExclusive = &#x26;Hc\nConst adModeShareDenyNone = &#x26;H10\nConst adModeRecursive = &#x26;H400000</p>\n<p>'---- RecordCreateOptionsEnum Values ----\nConst adCreateCollection = &#x26;H00002000\nConst adCreateStructDoc = &#x26;H80000000\nConst adCreateNonCollection = &#x26;H00000000\nConst adOpenIfExists = &#x26;H02000000\nConst adCreateOverwrite = &#x26;H04000000\nConst adFailIfNotExists = -1</p>\n<p>'---- RecordOpenOptionsEnum Values ----\nConst adOpenRecordUnspecified = -1\nConst adOpenOutput = &#x26;H00800000\nConst adOpenAsync = &#x26;H00001000\nConst adDelayFetchStream = &#x26;H00004000\nConst adDelayFetchFields = &#x26;H00008000\nConst adOpenExecuteCommand = &#x26;H00010000</p>\n<p>'---- IsolationLevelEnum Values ----\nConst adXactUnspecified = &#x26;Hffffffff\nConst adXactChaos = &#x26;H00000010\nConst adXactReadUncommitted = &#x26;H00000100\nConst adXactBrowse = &#x26;H00000100\nConst adXactCursorStability = &#x26;H00001000\nConst adXactReadCommitted = &#x26;H00001000\nConst adXactRepeatableRead = &#x26;H00010000\nConst adXactSerializable = &#x26;H00100000\nConst adXactIsolated = &#x26;H00100000</p>\n<p>'---- XactAttributeEnum Values ----\nConst adXactCommitRetaining = &#x26;H00020000\nConst adXactAbortRetaining = &#x26;H00040000</p>\n<p>'---- PropertyAttributesEnum Values ----\nConst adPropNotSupported = &#x26;H0000\nConst adPropRequired = &#x26;H0001\nConst adPropOptional = &#x26;H0002\nConst adPropRead = &#x26;H0200\nConst adPropWrite = &#x26;H0400</p>\n<p>'---- ErrorValueEnum Values ----\nConst adErrProviderFailed = &#x26;Hbb8\nConst adErrInvalidArgument = &#x26;Hbb9\nConst adErrOpeningFile = &#x26;Hbba\nConst adErrReadFile = &#x26;Hbbb\nConst adErrWriteFile = &#x26;Hbbc\nConst adErrNoCurrentRecord = &#x26;Hbcd\nConst adErrIllegalOperation = &#x26;Hc93\nConst adErrCantChangeProvider = &#x26;Hc94\nConst adErrInTransaction = &#x26;Hcae\nConst adErrFeatureNotAvailable = &#x26;Hcb3\nConst adErrItemNotFound = &#x26;Hcc1\nConst adErrObjectInCollection = &#x26;Hd27\nConst adErrObjectNotSet = &#x26;Hd5c\nConst adErrDataConversion = &#x26;Hd5d\nConst adErrObjectClosed = &#x26;He78\nConst adErrObjectOpen = &#x26;He79\nConst adErrProviderNotFound = &#x26;He7a\nConst adErrBoundToCommand = &#x26;He7b\nConst adErrInvalidParamInfo = &#x26;He7c\nConst adErrInvalidConnection = &#x26;He7d\nConst adErrNotReentrant = &#x26;He7e\nConst adErrStillExecuting = &#x26;He7f\nConst adErrOperationCancelled = &#x26;He80\nConst adErrStillConnecting = &#x26;He81\nConst adErrInvalidTransaction = &#x26;He82\nConst adErrUnsafeOperation = &#x26;He84\nConst adwrnSecurityDialog = &#x26;He85\nConst adwrnSecurityDialogHeader = &#x26;He86\nConst adErrIntegrityViolation = &#x26;He87\nConst adErrPermissionDenied = &#x26;He88\nConst adErrDataOverflow = &#x26;He89\nConst adErrSchemaViolation = &#x26;He8a\nConst adErrSignMismatch = &#x26;He8b\nConst adErrCantConvertvalue = &#x26;He8c\nConst adErrCantCreate = &#x26;He8d\nConst adErrColumnNotOnThisRow = &#x26;He8e\nConst adErrURLIntegrViolSetColumns = &#x26;He8f\nConst adErrURLDoesNotExist = &#x26;He8f\nConst adErrTreePermissionDenied = &#x26;He90\nConst adErrInvalidURL = &#x26;He91\nConst adErrResourceLocked = &#x26;He92\nConst adErrResourceExists = &#x26;He93\nConst adErrCannotComplete = &#x26;He94\nConst adErrVolumeNotFound = &#x26;He95\nConst adErrOutOfSpace = &#x26;He96\nConst adErrResourceOutOfScope = &#x26;He97\nConst adErrUnavailable = &#x26;He98\nConst adErrURLNamedRowDoesNotExist = &#x26;He99\nConst adErrDelResOutOfScope = &#x26;He9a\nConst adErrPropInvalidColumn = &#x26;He9b\nConst adErrPropInvalidOption = &#x26;He9c\nConst adErrPropInvalidValue = &#x26;He9d\nConst adErrPropConflicting = &#x26;He9e\nConst adErrPropNotAllSettable = &#x26;He9f\nConst adErrPropNotSet = &#x26;Hea0\nConst adErrPropNotSettable = &#x26;Hea1\nConst adErrPropNotSupported = &#x26;Hea2\nConst adErrCatalogNotSet = &#x26;Hea3\nConst adErrCantChangeConnection = &#x26;Hea4\nConst adErrFieldsUpdateFailed = &#x26;Hea5\nConst adErrDenyNotSupported = &#x26;Hea6\nConst adErrDenyTypeNotSupported = &#x26;Hea7\nConst adErrProviderNotSpecified = &#x26;Hea9\nConst adErrConnectionStringTooLong = &#x26;Heaa</p>\n<p>'---- ParameterAttributesEnum Values ----\nConst adParamSigned = &#x26;H0010\nConst adParamNullable = &#x26;H0040\nConst adParamLong = &#x26;H0080</p>\n<p>'---- ParameterDirectionEnum Values ----\nConst adParamUnknown = &#x26;H0000\nConst adParamInput = &#x26;H0001\nConst adParamOutput = &#x26;H0002\nConst adParamInputOutput = &#x26;H0003\nConst adParamReturnValue = &#x26;H0004</p>\n<p>'---- CommandTypeEnum Values ----\nConst adCmdUnknown = &#x26;H0008\nConst adCmdText = &#x26;H0001\nConst adCmdTable = &#x26;H0002\nConst adCmdStoredProc = &#x26;H0004\nConst adCmdFile = &#x26;H0100\nConst adCmdTableDirect = &#x26;H0200</p>\n<p>'---- EventStatusEnum Values ----\nConst adStatusOK = &#x26;H0000001\nConst adStatusErrorsOccurred = &#x26;H0000002\nConst adStatusCantDeny = &#x26;H0000003\nConst adStatusCancel = &#x26;H0000004\nConst adStatusUnwantedEvent = &#x26;H0000005</p>\n<p>'---- EventReasonEnum Values ----\nConst adRsnAddNew = 1\nConst adRsnDelete = 2\nConst adRsnUpdate = 3\nConst adRsnUndoUpdate = 4\nConst adRsnUndoAddNew = 5\nConst adRsnUndoDelete = 6\nConst adRsnRequery = 7\nConst adRsnResynch = 8\nConst adRsnClose = 9\nConst adRsnMove = 10\nConst adRsnFirstChange = 11\nConst adRsnMoveFirst = 12\nConst adRsnMoveNext = 13\nConst adRsnMovePrevious = 14\nConst adRsnMoveLast = 15</p>\n<p>'---- SchemaEnum Values ----\nConst adSchemaProviderSpecific = -1\nConst adSchemaAsserts = 0\nConst adSchemaCatalogs = 1\nConst adSchemaCharacterSets = 2\nConst adSchemaCollations = 3\nConst adSchemaColumns = 4\nConst adSchemaCheckConstraints = 5\nConst adSchemaConstraintColumnUsage = 6\nConst adSchemaConstraintTableUsage = 7\nConst adSchemaKeyColumnUsage = 8\nConst adSchemaReferentialConstraints = 9\nConst adSchemaTableConstraints = 10\nConst adSchemaColumnsDomainUsage = 11\nConst adSchemaIndexes = 12\nConst adSchemaColumnPrivileges = 13\nConst adSchemaTablePrivileges = 14\nConst adSchemaUsagePrivileges = 15\nConst adSchemaProcedures = 16\nConst adSchemaSchemata = 17\nConst adSchemaSQLLanguages = 18\nConst adSchemaStatistics = 19\nConst adSchemaTables = 20\nConst adSchemaTranslations = 21\nConst adSchemaProviderTypes = 22\nConst adSchemaViews = 23\nConst adSchemaViewColumnUsage = 24\nConst adSchemaViewTableUsage = 25\nConst adSchemaProcedureParameters = 26\nConst adSchemaForeignKeys = 27\nConst adSchemaPrimaryKeys = 28\nConst adSchemaProcedureColumns = 29\nConst adSchemaDBInfoKeywords = 30\nConst adSchemaDBInfoLiterals = 31\nConst adSchemaCubes = 32\nConst adSchemaDimensions = 33\nConst adSchemaHierarchies = 34\nConst adSchemaLevels = 35\nConst adSchemaMeasures = 36\nConst adSchemaProperties = 37\nConst adSchemaMembers = 38\nConst adSchemaTrustees = 39\nConst adSchemaFunctions = 40\nConst adSchemaActions = 41\nConst adSchemaCommands = 42\nConst adSchemaSets = 43</p>\n<p>'---- FieldStatusEnum Values ----\nConst adFieldOK = 0\nConst adFieldCantConvertValue = 2\nConst adFieldIsNull = 3\nConst adFieldTruncated = 4\nConst adFieldSignMismatch = 5\nConst adFieldDataOverflow = 6\nConst adFieldCantCreate = 7\nConst adFieldUnavailable = 8\nConst adFieldPermissionDenied = 9\nConst adFieldIntegrityViolation = 10\nConst adFieldSchemaViolation = 11\nConst adFieldBadStatus = 12\nConst adFieldDefault = 13\nConst adFieldIgnore = 15\nConst adFieldDoesNotExist = 16\nConst adFieldInvalidURL = 17\nConst adFieldResourceLocked = 18\nConst adFieldResourceExists = 19\nConst adFieldCannotComplete = 20\nConst adFieldVolumeNotFound = 21\nConst adFieldOutOfSpace = 22\nConst adFieldCannotDeleteSource = 23\nConst adFieldReadOnly = 24\nConst adFieldResourceOutOfScope = 25\nConst adFieldAlreadyExists = 26\nConst adFieldPendingInsert = &#x26;H10000\nConst adFieldPendingDelete = &#x26;H20000\nConst adFieldPendingChange = &#x26;H40000\nConst adFieldPendingUnknown = &#x26;H80000\nConst adFieldPendingUnknownDelete = &#x26;H100000</p>\n<p>'---- SeekEnum Values ----\nConst adSeekFirstEQ = &#x26;H1\nConst adSeekLastEQ = &#x26;H2\nConst adSeekAfterEQ = &#x26;H4\nConst adSeekAfter = &#x26;H8\nConst adSeekBeforeEQ = &#x26;H10\nConst adSeekBefore = &#x26;H20</p>\n<p>'---- ADCPROP_UPDATECRITERIA_ENUM Values ----\nConst adCriteriaKey = 0\nConst adCriteriaAllCols = 1\nConst adCriteriaUpdCols = 2\nConst adCriteriaTimeStamp = 3</p>\n<p>'---- ADCPROP_ASYNCTHREADPRIORITY_ENUM Values ----\nConst adPriorityLowest = 1\nConst adPriorityBelowNormal = 2\nConst adPriorityNormal = 3\nConst adPriorityAboveNormal = 4\nConst adPriorityHighest = 5</p>\n<p>'---- ADCPROP_AUTORECALC_ENUM Values ----\nConst adRecalcUpFront = 0\nConst adRecalcAlways = 1</p>\n<p>'---- ADCPROP_UPDATERESYNC_ENUM Values ----\nConst adResyncNone = 0\nConst adResyncAutoIncrement = 1\nConst adResyncConflicts = 2\nConst adResyncUpdates = 4\nConst adResyncInserts = 8\nConst adResyncAll = 15</p>\n<p>'---- MoveRecordOptionsEnum Values ----\nConst adMoveUnspecified = -1\nConst adMoveOverWrite = 1\nConst adMoveDontUpdateLinks = 2\nConst adMoveAllowEmulation = 4</p>\n<p>'---- CopyRecordOptionsEnum Values ----\nConst adCopyUnspecified = -1\nConst adCopyOverWrite = 1\nConst adCopyAllowEmulation = 4\nConst adCopyNonRecursive = 2</p>\n<p>'---- StreamTypeEnum Values ----\nConst adTypeBinary = 1\nConst adTypeText = 2</p>\n<p>'---- LineSeparatorEnum Values ----\nConst adLF = 10\nConst adCR = 13\nConst adCRLF = -1</p>\n<p>'---- StreamOpenOptionsEnum Values ----\nConst adOpenStreamUnspecified = -1\nConst adOpenStreamAsync = 1\nConst adOpenStreamFromRecord = 4</p>\n<p>'---- StreamWriteEnum Values ----\nConst adWriteChar = 0\nConst adWriteLine = 1</p>\n<p>'---- SaveOptionsEnum Values ----\nConst adSaveCreateNotExist = 1\nConst adSaveCreateOverWrite = 2</p>\n<p>'---- FieldEnum Values ----\nConst adDefaultStream = -1\nConst adRecordURL = -2</p>\n<p>'---- StreamReadEnum Values ----\nConst adReadAll = -1\nConst adReadLine = -2</p>\n<p>'---- RecordTypeEnum Values ----\nConst adSimpleRecord = 0\nConst adCollectionRecord = 1\nConst adStructDoc = 2\n%>\n</pre></p>\n</div>\n</div>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","description":"Full Stack Developer, good at OAuth 2.0","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"本站源码","url":"https://github.com/Jeff-Tian/space","style":"link","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[]}