{"componentChunkName":"component---src-templates-post-js","path":"/posts/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET/","result":{"data":{"sitePage":{"id":"SitePage /posts/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET/"}},"pageContext":{"url":"/posts/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET/","relativePath":"posts/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET.md","relativeDir":"posts","base":"The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET.md","name":"The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET","frontmatter":{"title":"The fix for bug “Cannot delete subscribers” in BlogEngine.NET","stackbit_url_path":"posts/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET","date":"2012-02-20 07:01:00","excerpt":"","comments_count":0,"positive_reactions_count":0,"tags":["BUG","BlogEngine.NET"],"canonical_url":"https://be-net.azurewebsites.net/post/2012/02/20/The-fix-for-bug-“Cannot-delete-subscribers”-for-BlogEngineNET","template":"post"},"html":"<h2><span style=\"color: #800080;\">[Background]</span></h2>\n<p>There is a bug in BlogEngine.NET 2.5.</p>\n<h2><span style=\"color: #800080;\">[Bug Description]</span></h2>\n<p>You cannot delete the subscribers from the newsletter widget.</p>\n<h2><span style=\"color: #800080;\">[Repro Steps]</span></h2>\n<ol>\n<li>Navigate to your BlogEngine.NET blog</li>\n<li>Log in as administrator</li>\n<li>Navigate to the Newsletter widget</li>\n<li>Click “edit” button on the right top of the widget\n<ul>\n<li><a href=\"https://raw.githubusercontent.com/Jeff-Tian/blogengine.net/master/Source/BlogEngine/BlogEngine.NET/App_Data/files/image_478.png\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 244px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 68.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSklEQVR42qWTyW/TQBjF8zdx4ABX/kLEAQkJKiE4VVBRLm1JxKIuifHWrHZo45TEdtLYjmM7iaOWH5rJogCFC5aevjcz9pv3LS7EcUyapiRJIpFlmYTYH4/HdyOOmVxdEfs+48mEKIqYTCb4vk9hdH2NZVn0ej2cTgfbtrFsG9f1/hSKIiIhcHVFoCgEmkocRfIsTRP6/T6F4XBAqfSBw6MjDg8O2N/fZ29vj1qjRZplG7G14yhJiBwH//SMYaXC0PUYBSHjcYzruhS2Xxa2hQuxjuOxTCVarbeFRWns0y98ev+ajqOhqiXK5QM07YxCEAQ0Gw2azQa1Wh1NValWq1hWC9M0adTrXHYcGc/FfqspS6KfGxyffaRarVAuf+LkpISqViiMRiOqpoFpGhiGgaZqdByHMIoIw3CDaLUWBsJ13ZKMJEkl5vMc3x9QiFapZmkmU5E8W3LR/el0KvmyDPEq7WX60UpYXCTO+v3essutVou6SO3ykm7XwbbbdB2Hi4sL6rUaTrcrP1jXdC22zcWlsilSsNmkVq9hWTbtdptmsyVHSHDT0Pne621cr51vRyEouBQUN//Pc3NzsxGUcygss5jB7QJuc/ixjIs8Zy4wn5Pn+Z1YLBbMZrNfUx4GITuGx5OvHk9Vj8eKxzPNoz8M5Ez+3uVtvq6j4KKZ0qEbxjx44/Lw7YBH7wbc2/W4v+vy7XpCPs1I0lSm8y8Id8Kp/JfN8yqvShWeFxV2igovigovixU+H5+g6xqapqPrupxREf/GRVQUhZ/IRwgTFEWJIwAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"The fix for bug “Cannot delete subscribers” for BlogEngine.NET\" title=\"The fix for bug “Cannot delete subscribers” for BlogEngine.NET\" src=\"/static/45e3931c9f764823efb0c62830f1b3a9/0cba8/image_thumb_208.png\" srcset=\"/static/45e3931c9f764823efb0c62830f1b3a9/12f09/image_thumb_208.png 148w,\n/static/45e3931c9f764823efb0c62830f1b3a9/0cba8/image_thumb_208.png 244w\" sizes=\"(max-width: 244px) 100vw, 244px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\" loading=\"lazy\">\n    </span></a></li>\n</ul>\n</li>\n<li>Click “Delete” link on the edit panel</li>\n<li>Click “Save” button on the edit panel</li>\n<li>Repeat step 4 and observe the email list\n<ul>\n<li><a href=\"https://raw.githubusercontent.com/Jeff-Tian/blogengine.net/master/Source/BlogEngine/BlogEngine.NET/App_Data/files/image_479.png\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 584px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVR42s2TXWvCMBiF+/9/0ubNLnSVrQHXzYu1NR/9CEMcjgq7aPKekaCZrQV13uzAgSQveXJ4k0T3kzsUnCNNlyhWHLXWqOomuNEaOedIGMPLYgEpBZRSUEoGu7WmqcEYQ/Q6e8Ku1L7QGQMigIh6ttbCGOM9rDkbY+FUlgpROn1GW2/xtf30G70cNeh4PK7DPg/kYtUrjiU45x4wz/NwCu2TEZ1PdRzgF1j2gfsG4hqdAou814drNZIw+wfAQ1tOLmUA/MsN0/DZFDf2EGRD4solzLJ3P+m6zkMvsrGwLl3b4nu9wU5/+N/ChUA0n8eoqgqccwghLreUKJdvSOIE08kDWMIwe4zxAzv27/apkb5eAAAAAElFTkSuQmCC'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"The fix for bug “Cannot delete subscribers” for BlogEngine.NET\" title=\"The fix for bug “Cannot delete subscribers” for BlogEngine.NET\" src=\"/static/51142142ae8474c6a856601e67ad7478/e05eb/image_thumb_209.png\" srcset=\"/static/51142142ae8474c6a856601e67ad7478/12f09/image_thumb_209.png 148w,\n/static/51142142ae8474c6a856601e67ad7478/e4a3f/image_thumb_209.png 295w,\n/static/51142142ae8474c6a856601e67ad7478/e05eb/image_thumb_209.png 584w\" sizes=\"(max-width: 584px) 100vw, 584px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\" loading=\"lazy\">\n    </span></a></li>\n</ul>\n</li>\n</ol>\n<h2><span style=\"color: #800080;\">[Actual Result]</span></h2>\n<p>The email address hadn’t been deleted from the email list.</p>\n<h2><span style=\"color: #800080;\">[Expected Result]</span></h2>\n<p>The email address should be deleted from the email list successfully.</p>\n<h2><span style=\"color: #800080;\">[Cause]</span></h2>\n<p>Code defect. The relative code file is ~\\BlogEngine.NET\\widgets\\Newsletter\\edit.ascx.cs.</p>\n<p>If you investigate it you will find the doc variable always read the original email list from disk, even if you clicked the save button, in which case it should keep the new email list has some email addresses deleted.</p>\n<h2><span style=\"color: #800080;\">[Solution]</span></h2>\n<p>You can download the revised code file from the below link and replace the original file with this one.</p>\n<h2><span style=\"color: #800080;\">[File download]</span></h2>\n<p style=\"font-family: Simsun; font-size: medium; display: inline !important;\"><a href=\"/blog/file.axd?file=2012%2f2%2fedit.ascx.cs\">edit.ascx.cs (5.47 kb)</a></p>\n<p style=\"font-family: Simsun; font-size: medium; display: inline !important;\">&nbsp;</p>\n<h2><span style=\"color: #800080;\">[Remark to Solution]</span></h2>\n<p>The revised code file added 2 event handlers (Onunload(), OnLoad()) and modified 1 event handler (SaveEmails()). It uses the Session variable to store the modified doc (has some email addresses deleted).</p>\n<p>&nbsp;</p>\n<h2><span style=\"color: #800080;\">[Updated code]</span></h2>\n<pre class=\"brush: csharp\">\t// This event handler is append to the orignal file\n        protected override void OnLoad(EventArgs e)\n        {\n            if (IsPostBack)\n            {\n                if (Session[\"docEmailList\"] != null)\n                {\n                    doc = (XmlDocument)Session[\"docEmailList\"];\n                }\n            }</pre>\n<pre><code>        base.OnLoad(e);\n    }\n\n// This event handler is append to the orignal file\n    protected override void OnUnload(EventArgs e)\n    {\n        Session[\"docEmailList\"] = doc;\n\n        base.OnUnload(e);\n    }\n\n    /// \n    /// Saves the emails.\n    /// \n/// This event handler has already in the original file. I just append a statement (Session.Remove()) to it. \n    private void SaveEmails()\n    {\n        using (var ms = new MemoryStream())\n        using (var fs = File.Open(fileName, FileMode.Create, FileAccess.Write))\n        {\n            doc.Save(ms);\n            ms.WriteTo(fs);\n        }\n\t\n\t// I append this statement:\n        Session.Remove(\"docEmailList\");\n    }&#x3C;/pre>\n</code></pre>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}