{"componentChunkName":"component---src-templates-post-js","path":"/posts/rdxby2/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/rdxby2","relativePath":"posts/rdxby2","frontmatter":{"title":"将 Keycloak 从 16 粗暴升级到 21 的丝滑体验","stackbit_url_path":"posts/rdxby2","date":"2023-04-07T11:22:43","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p>周末终于将几年前部署到 Heroku 的 Keycloak 实例，从 16 升级到了 21。在升级 Heroku 的 16 版本之前，我同步部署了一个版本 21 到 Okteto，对新版观察了一段时间（即 Heroku 上的实例是 16，而 Okteto 上的实例是 21）。</p>\n<p>要说升级，服务器端整体的感觉还是很丝滑的，但是有一个破坏性的改动导致有很多关联改动：即新版本的 Keycloak 中的 url，将 /auth 部分去掉了，所以之前对接过 <a href=\"https://keycloak.jiwai.win\">https://keycloak.jiwai.win</a> 的客户端，都需要相应地修改配置。</p>\n<p><a name=b7vvM></a></p>\n<h1>步骤 0: 备份！</h1>\n<p>升级过程会对数据库做改动，为了防止万一，还是先做个备份。尽管后来发现过程特别丝滑，其实没有用到备份数据（这真是省心！）。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1064094c587eb24f18586ffd65b98017/5d942/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.621621621621614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVR42q2RXU/CMBSG9///jWIYUzB+BKNXJhouuCLCvhCYo123bt32mHUQhTsTmzx5m/PVnnOcyyuPjsHgmsGVx8Wli+tNcEcTRt6Em/GdZeSNGbo3DEc97kE7+/j2nsfpM9OnF5wWqBswhn85TllWFEVp0WWF1hXG1Bbd2fNTcqWpKmP9nR4xpsc5Kd+2tG1LXddkUpEmoudLILYp28+EZLu3PlMbG3uOc7x0xxbKMjabDVEUEccRgR+wWvmEfsByuWK9jgmCwMbkStmck5bPZ9D/sKFpGqu2zUyjMm3vR19P22t9oGlwVF4gpUJmir2QaF12nR8Sf7VzfKz5KWhjzpfSDVmKDCGlpayqP23V7L4I3xf4bwvSjxhns92R5zm7JEEIiVKK5dK3tjTdE8UxRVGwF4IwjFAqt75OC61JViGz6Yz5wyvh25xvsq2vMBa/HUEAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"WX20230406-214302.png\"\n        title=\"WX20230406-214302.png\"\n        src=\"/static/1064094c587eb24f18586ffd65b98017/fcda8/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png\"\n        srcset=\"/static/1064094c587eb24f18586ffd65b98017/12f09/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 148w,\n/static/1064094c587eb24f18586ffd65b98017/e4a3f/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 295w,\n/static/1064094c587eb24f18586ffd65b98017/fcda8/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 590w,\n/static/1064094c587eb24f18586ffd65b98017/efc66/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 885w,\n/static/1064094c587eb24f18586ffd65b98017/c83ae/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 1180w,\n/static/1064094c587eb24f18586ffd65b98017/5d942/1680865051067-b670bb70-5fee-43d8-ad45-4331833afed4.png 1343w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=BEUBf></a></p>\n<h1>步骤 1: 修改启动脚本，在应用启动时自动升级数据库</h1>\n<p>由于 Heroku 上部署的 Keycloak 实例，只是我个人的玩具项目，我就直接在线升级了（项目挂了一会儿）。如果是真实项目，可以考虑离线升级。</p>\n<p>要升级数据库，需要在启动时，指定如下选项：</p>\n<p>--spi-connections-jpa-legacy-migration-strategy=update</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/09f7cbab31e1887de93d4dd23ecc8cc4/61583/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.72972972972973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR42k2Q226DMBBE+f9/q5S3NGqrlCZcTHzFYJsQcSo7pOrDaNZazXh2ql4ILtcrmcUw0HY92hikUtyE5K09cuhPWG1RxqD0E3mvlN7fGutcQdX1HU3bIIRg8iMxzKzryjzPjNbxYzrO8oq6SZRWSCnx40iKkRgjKSWWZYFtY9s2qvzrqW74vLQ0g2T0nsfjgfcTSimcsThtGcexwDlHCKGYvAzjbh5TpMrLczvsEAxKF8M5BLTW5XzvPTEmQngKs2aewx9P07QnvVMtKfLV9Bw+at7rBlcSrkWY0+RUOa0xBq3NznqfbeFcw9N0obovibofOH431N2ANLZ0mFNlce4yn/c6LfML8V+Pr/kXjvzJw29HiX4AAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/09f7cbab31e1887de93d4dd23ecc8cc4/fcda8/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png\"\n        srcset=\"/static/09f7cbab31e1887de93d4dd23ecc8cc4/12f09/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 148w,\n/static/09f7cbab31e1887de93d4dd23ecc8cc4/e4a3f/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 295w,\n/static/09f7cbab31e1887de93d4dd23ecc8cc4/fcda8/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 590w,\n/static/09f7cbab31e1887de93d4dd23ecc8cc4/efc66/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 885w,\n/static/09f7cbab31e1887de93d4dd23ecc8cc4/c83ae/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 1180w,\n/static/09f7cbab31e1887de93d4dd23ecc8cc4/61583/1680865514157-d03eae11-b712-4dc1-8720-382a5131ce3d.png 1616w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>我在本地修改了 Dockerfile，并使用 docker compose up --build启动了服务器。这时，发现访问 <a href=\"http://localhost:8080\">http://localhost:8080</a> 得到了  empty response，线上服务也挂掉了。</p>\n<p>这时是数据库在升级，由于使用的是共享的 mini heroku-postgres，性能似乎不高，这个升级过程执行了好久，<a href=\"http://localhost:8080\">http://localhost:8080</a> 才显示出界面。说明数据库升级完成了。</p>\n<p>这时线上服务仍然挂着，因为应用本身还是老的，不认识新的数据库模式。这时我再修改 Dockerfile，并且去掉 --spi-connections-jpa-legacy-migration-strategy=update选项，并绑定到 heroku 指定的端口启动应用，推送代码，在自动重新部署完毕的后，应用恢复正常。相关的提交见： <a href=\"https://github.com/Jeff-Tian/keycloak-heroku/commit/3123f73e850e9717f7d72992d3b9691e9c95c901\">https://github.com/Jeff-Tian/keycloak-heroku/commit/3123f73e850e9717f7d72992d3b9691e9c95c901</a> 以前前面几个。总之，之前对 Keycloak 的魔改以适应 heroku 的特殊需求全部去掉了，改成了标准的 Dockerfile 方式启动 Keycloak 应用：\ndockerfile\nFROM quay.io/keycloak/keycloak:latest</p>\n<p>COPY idps/wechat-mobile/keycloak-services-social-weixin.jar\n/opt/keycloak/providers/\nCOPY idps/wechat-mobile/templates/realm-identity-provider-weixin-ext.html\n/opt/keycloak/themes/base/admin/resources/partials\nCOPY idps/wechat-mobile/templates/realm-identity-provider-weixin.html\n/opt/keycloak/themes/base/admin/resources/partials</p>\n<p>COPY idps/wecom/keycloak-services-social-wechat-work.jar\n/opt/keycloak/providers/\nCOPY idps/wecom/templates/realm-identity-provider-wechat-work.html\n/opt/keycloak/themes/base/admin/resources/partials\nCOPY idps/wecom/templates/realm-identity-provider-wechat-work-ext.html\n/opt/keycloak/themes/base/admin/resources/partials</p>\n<p>#COPY  temp/* /opt/keycloak/themes/base/admin/resources/partials\nCOPY  ui/font_iconfont /opt/keycloak/themes/keycloak/common/resources/lib/font_iconfont\nCOPY  ui/theme.properties /opt/keycloak/themes/keycloak/login/\nCOPY  target/keycloak-justauth-12.0.1-jar-with-dependencies.jar /opt/keycloak/providers/</p>\n<p>COPY  target/keycloak-justauth-12.0.1-jar-with-dependencies.jar /opt/keycloak/deployments/</p>\n<p>ENV KC_HOSTNAME_STRICT=false\nENV KC_HOSTNAME_STRICT_HTTPS=false\nENV KC_HTTP_ENABLED=true</p>\n<p>CMD [start-dev, --hostname-strict=false, --http-port=$PORT, --proxy=passthrough, --db=postgres, --db-url=$DB_URL, --db-username=$DB_USERNAME, --db-password=$DB_PASSWORD]</p>\n<p>推送代码前，由于使用的环境变量命名和之前老版本的启动脚本中指定的不一样，所以同步修改了 Heroku 上的环境变量：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/711c680048cff92c84fcbf4439dc2e73/6bfbb/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABe0lEQVR42oWRWa7bMAxFs/9N9bu7SN2X1wweJVkjpVNQcYJ8FCiBC1KEdXRNnjZjMNZincOHQM6FlPM7hxjx4SmtU8q9/1JWldKl51PJlVIqmqU0qjSkVHIWUhasT7iQe95jIQuUCqU9lSuEWPq3RRqnKpXWGvO8cbtNTMuG2SMNkBgx39+kZUa8R/ad7BxpXUjTSJon/P2OXRwh5M45cURM6iTippF4GSAG6m55DAN2HJ+AaWS//uF+PvO4XLj9/mIcfiF+R6paaJyUqnrHMsLPH3A5U/3O+hgJ4Zhdyr2epxmzGoxx2HGiOPcEtgOo8QK3o9aoKXIfBtyykK0lWcu+LMzXK9FYso7AGiQmitSnw7ezl8sD2oEN5tX0uUZdklR8yviYydLePXVXivQ7/wa+HNbK4zExzQsp6SYLuw9sxvatxj6Ggi5WusNP4Ed8ApfVsG62zysXYfcR63z/RX1Ae1EfS+X/QM1FhFpbh+tZDjdaa19zPNwr8C+whA2TuG1S3AAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/711c680048cff92c84fcbf4439dc2e73/fcda8/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png\"\n        srcset=\"/static/711c680048cff92c84fcbf4439dc2e73/12f09/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 148w,\n/static/711c680048cff92c84fcbf4439dc2e73/e4a3f/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 295w,\n/static/711c680048cff92c84fcbf4439dc2e73/fcda8/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 590w,\n/static/711c680048cff92c84fcbf4439dc2e73/efc66/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 885w,\n/static/711c680048cff92c84fcbf4439dc2e73/c83ae/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 1180w,\n/static/711c680048cff92c84fcbf4439dc2e73/6bfbb/1680865915270-cc3c136c-3dcb-4999-a425-858e2c779699.png 1514w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=AVjlX></a></p>\n<h1>步骤 2 到 n：修改客户端的配置</h1>\n<p>服务跑起来了，但是在之前和它对接的客户端全挂了，这就是由于那个 /auth 从新版 Keycloak 的端点中拿掉的结果。这一步是个长期过程，因为实在没有那么多时间来一个一个地改，就用到哪个时，顺手改掉。\n<a name=B7mth></a></p>\n<h2>Keycloak 的客户端修改</h2>\n<p>拿 <a href=\"https://umi-ckeditor5.brickverse.dev/\">https://umi-ckeditor5.brickverse.dev/</a> 举例子，它对接了 Keycloak 登录，是 Keycloak 的客户端。相应的改动提交见： <a href=\"https://github.com/Jeff-Tian/umi-ckeditor5/commit/4622e6a11525d601a47b0ccddd23710475b766eb\">https://github.com/Jeff-Tian/umi-ckeditor5/commit/4622e6a11525d601a47b0ccddd23710475b766eb</a>。</p>\n<p>它是一个 umijs 前端项目，使用了 oauth2Client，只需要将它的配置中的 /auth 同步去掉即可（.umirc.js）。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.94594594594594%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKUlEQVR42p3T2a7jNgyAYb//67VzluQkXrRZtiTL+xInf2HjtJ2LAh2MgQ8kKIgXpJzUoeFySxHKkBaSQmq6YaIf59+SaG1Q2jCME7HtiG3PtKys2866PVjWjXnZmNdfkzTe4Z2ndh7nj+joup5t25jmmX3feQGv1+uXJOPQ08YGazRNaPBH09oRY8TVjnVdj268ns/T838kpn3waUfu0mJci3SRqpvw04YbN6puxrbTt5l6WM+6G34y/iuRcefmd6oJUjfybkZutkP6HjeshGkjLDt+XGnmB8OT/9Tv0D0gaV1JZwVbH+i6gR9XzfuXJM0UjQ90sSUe43Ce4Juzdggu/JPH0DAPHWzHln2BsFd8NMQh8pEL/rwXXIVElBppDUV+I1eCzCgKo8lP6oyZVgh73A2MS0tiXIa0F0LUdGPDtRB8ZjkfacZXkXOXguvHG5f0zmeWcfn2kabcRHGeS6tpB8+0RJJ+HAhtZN0WmnHlj8yTao+ygUzXyNJzFxZVBeqmw/r2jFVoGeflfKuPfefx3NmPLVdOoPWV2BjaPvJ2K3i7ZWRSkkuFNIb860JWFORKIbSm0OrM/1YoRVmXjFMkqXyBLq+0bUk/Ri654O1ekGuFsgZdlajsC6HEOT/x7WgqjUaVBllqXFMxHzO0vSX3Ga6riHPPuzBcpCG3JdLVmOBRx3Iqi6hrlKvPuvwp18HRLR3zPpJsxz+7Hh5M88q2w/7k974X/AUwYyeiZWkScgAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/0e23d8a04f7d44478f29455fd4f72d55/fcda8/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png\"\n        srcset=\"/static/0e23d8a04f7d44478f29455fd4f72d55/12f09/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png 148w,\n/static/0e23d8a04f7d44478f29455fd4f72d55/e4a3f/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png 295w,\n/static/0e23d8a04f7d44478f29455fd4f72d55/fcda8/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png 590w,\n/static/0e23d8a04f7d44478f29455fd4f72d55/efc66/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png 885w,\n/static/0e23d8a04f7d44478f29455fd4f72d55/a2b88/1680866273477-3490a4ee-d8cd-40ff-9b17-de64d6c32184.png 908w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=g5Cdd></a></p>\n<h2>Keycloak 的父级身份源中的配置修改</h2>\n<p>以 GitHub 登录举例，需要同步在 GitHub 的 OAuth 应用配置里，将回调 url 中的 /auth 去掉。于是，在新版的 Keycloak 中，也可以使用 GitHub 登录了：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR42pWTzYrUQBSF+wHd+lCuBZmlIKL4AC7cuBx1MaALFW27abp7kk6nUkkqlfpL1SdJmIaZxRgvnIK6dTiXcy610rpHVJK6aSc0TUtvDNZ5rHXYEHBNx/7qOdsXz/Cym3rTm/f4GGeucxNWLCnnEW/fULx6yaC6SzvFiGsVKaVLbzVeHgMpEVMi6w1liFRNy+jKJtCbDR+ePsFk2WXAvwUnYqIqxQRjLL2xWB8IqkN9+UzszcxL6XHLF8GUKM6C7FSge4OxDufm/IbpfT7+S/A2yyco1U2i40JiAB8G4h1/zHCpYJaf2B+O5KcCpTXORNRQU6o1qRLQtXOGiy2XAiFreuOIHs5hR5Z+ERsBxx1JFKRhWC5YNw2VlEhZ81Nds+1vZo8PapHgEBO/dzk/1ge+b7Z8vb1hn3WsjzV/jhKlLd474jLLCTfAIZccjieEVHQqULU9ZWORncf7gBuXFBdueZx8rgV7UZHXHZWyaK1RqmUI/h5/kaAJlnff3nP16TUf19cP8uXeR/gL4cz0BjSSsjIAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/8d934000bcc1e80846121ed21f1e0071/fcda8/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png\"\n        srcset=\"/static/8d934000bcc1e80846121ed21f1e0071/12f09/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 148w,\n/static/8d934000bcc1e80846121ed21f1e0071/e4a3f/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 295w,\n/static/8d934000bcc1e80846121ed21f1e0071/fcda8/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 590w,\n/static/8d934000bcc1e80846121ed21f1e0071/efc66/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 885w,\n/static/8d934000bcc1e80846121ed21f1e0071/c83ae/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 1180w,\n/static/8d934000bcc1e80846121ed21f1e0071/2bfc7/1680866419867-410a4e1f-0544-4152-aa0b-e8e46978dab9.png 1227w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=RjA1R></a></p>\n<h1>验证</h1>\n<p>使用修改过的 Client（比如那个 umi 项目），在登录时使用 GitHub，和以前的流程一样，只是登录界面更简洁了（新版 Keycloak 的改动之一）。</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}