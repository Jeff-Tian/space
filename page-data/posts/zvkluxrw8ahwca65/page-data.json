{"componentChunkName":"component---src-templates-post-js","path":"/posts/zvkluxrw8ahwca65/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/zvkluxrw8ahwca65","relativePath":"posts/zvkluxrw8ahwca65","frontmatter":{"title":"使用 vitepress + pagedjs 在浏览器中实现书籍渲染的折腾过程（之解决一个奇怪的 BUG）","stackbit_url_path":"posts/zvkluxrw8ahwca65","date":"2023-08-02T12:18:47","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p><a name=PWTS9></a></p>\n<h1>前情提要</h1>\n<p>在《<a href=\"https://zhuanlan.zhihu.com/p/640487822\">【已被采纳】基本功不好，如何做开源贡献？使用 ChatGPT 写代码实录。 - Jeff Tian的文章 - 知乎 </a> 》中提到，我使用 vitepress 打造了一个完美的写作平台。其中有一个不能嵌套包含的问题，也利用 ChatGPT 解决了，该贡献最终在 vitepress 1.0.0-beta.6 的发布中带上去了。<br />虽然可以在一屏中展示书籍的所有内容，但是展示的形式仍然不完美，即和真正的纸书呈现形式相差太大。调研了 pagedjs、pandoc、vitepress-export-pdf、<a href=\"https://github.com/vivliostyle/vivliostyle.js\">vivliostyle.js</a> 等等，发现各自有各自的优势，结合自己的使用场景是在浏览器上拥有纸质书籍的阅读体验，同时希望拥有最少的代码侵入，最终决定还是使用 pagedjs 来在浏览器进行书籍页面渲染。\n<a name=KLJbN></a></p>\n<h1>惊艳的效果</h1>\n<p>通过 pagedjs 的官网指引，在 vitepress 里引入了它，并加上了一些额外的 css 样式后，在开发模式下，完美渲染！<br />引入的方式是在 docs.vitepressconfig.ts文件中的 head 区增加如下内容：\ntypescript\nexport default withMermaid(\ndefineConfig({\nhead: [\n[\nscript,\n{\ntype: text/javascript,\nasync: true,\ndefer: true,\nsrc: <a href=\"https://unpkg.com/pagedjs/dist/paged.polyfill.js\">https://unpkg.com/pagedjs/dist/paged.polyfill.js</a>\n}\n],\n]\n})\n)</p>\n<p>然后，在 main.md 文件中增加相应的 style：\nmarkdown</p>\n<style lang=css>\n\n@page {\n    size: A5 portrait;\n    background-color: white;\n\n    @top-left {\n        content: 数字身份认证技术与实践;\n        font-size: smaller;\n        color: #979797;\n        text-align: left;\n        white-space: nowrap;\n    }\n\n    @top-right {\n        content: string(title);\n        text-transform: uppercase;\n        color: gold;\n        white-space: nowrap;\n        font-size: smaller;\n        text-align: right;\n        margin-right: 1em;\n    }\n\n    @bottom-left {\n        content: 从概念到实战的深入理解;\n        text-transform: capitalize;\n        color: gold;\n        white-space: nowrap;\n        word-break: keep-all;\n        font-size: smaller;\n    }\n\n    @bottom-right-corner {\n        content: counter(page)  /  counter(pages);\n        white-space: nowrap;\n        margin-left: -2em;\n    }\n\n    @bottom-center {\n        content: string(title);\n        text-transform: uppercase;\n    }\n}\n</style>\n<p>注意以上的 @page 指令，它将书籍页面左右展示，并在页眉和页脚中增加一个额外的文本，yarn docs:dev 执行后的效果如下：<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4795f99ddcff5da6f100c2e0410be1f8/91608/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMUlEQVR42lWS62rbQBCF9WZpEwhxnYSmOLgNpa/aH4VCCyW2jK+y7OgW27JsSdZtJXn1FclNSQYOs9ezZ86O0ul0uL25od2+pt1uc3l5ycXFBefn75t8ddWi1Wo147Ozd9x+uOLrp2s+3t3xcH9Dp3PPt4cvfO526Xa7KFEUYdkWk+mU8XjMZDKh3+8x17RmXu/VZ/b7PfO5hm3brDcbXNdtsNvt2G63hGFIHMcoZVliWiaGaWCZJk+GgbNes9pscFYr9KclIs/xti6j0ZDhaMhsNmM4HDZnNW2GOhiwXq+RUqIIIRr2mriOqs7+HhlHyCSmOoRUWYrneRiG0SgNggDPO6kKfL9RWqvL8+Kk8MRUUdU5Tal+/YQ/v+HHdxj0G8IojhmPhvR6PdS+Su/xkb6qMlBVVHXA4RBSFK8Iq9coihNEdlIMbF23seTZcbAsm7k2ZzabslgsGkRJQlGWKKXIoL6c18ihyKEsqF4U1w9ISZKkHOXLytuovatyQZ5lKOXKgc0SXB08h9LdIIwniKP/ZFkmQGYgD8giIIkjgjDE9/1/NiWUlkFiWyhZGCIOPsLfIvw96X5PuvMQSYIoCkRekGYZQqTkedrkNE2bT6jbqe6APEnIAp8k8FHy+hcdG16XIyWYOjgTKlPlaC3JlgvShU620JGb9cmSqmrKlWWJtA1EGKCUWYZvmcynUxzbRtd1rLonNQ17oeM9O+TRgWOasrXt5hLHI2/crKrGolrpX52WHfEaTES+AAAAAElFTkSuQmCC'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/4795f99ddcff5da6f100c2e0410be1f8/fcda8/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png\"\n        srcset=\"/static/4795f99ddcff5da6f100c2e0410be1f8/12f09/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 148w,\n/static/4795f99ddcff5da6f100c2e0410be1f8/e4a3f/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 295w,\n/static/4795f99ddcff5da6f100c2e0410be1f8/fcda8/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 590w,\n/static/4795f99ddcff5da6f100c2e0410be1f8/efc66/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 885w,\n/static/4795f99ddcff5da6f100c2e0410be1f8/c83ae/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 1180w,\n/static/4795f99ddcff5da6f100c2e0410be1f8/91608/1690781125588-c60796ad-c792-476d-8be6-12335e7433af.png 1251w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=aATE6></a></p>\n<h1>奇怪的 BUG</h1>\n<p>然而，奇怪的是，一旦发布上线，以上效果全没了…… 只剩下了 pagedjs 将页面分割成多页展示，却没有页眉页脚了。</p>\n<p><a name=OW71b></a></p>\n<h1>分析</h1>\n<p>看起来，vitepress 在本地开发模式下是启动了一个 Web 服务器来托管整个站点，但是一旦打包成静态页面文件，这个打包过程中会做一些事情，破坏了 pagedjs 的工作流。<br />说实话，我只想无脑使用这个工具，比如 vitepress 也好、pagedjs 也好，我能用就行，至于它们是怎么设计的，原理是什么，我没有兴趣知道。<br />然而现实是，我一用就发现不好用，有可能是姿势不对，但不去了解原理，就无法得知到底哪里不对，因为并没有现成的文档。vitepress 文档写得很好，然而没有也不应该专门为 pagedjs 的集成写相关的文档；对 pagedjs 来说也是如此，它已经有很完善的文档了，但却没有也不应该专门为在 vitepress 中的使用写相关的文档。<br />一般我是不建议阅读所谓框架或者库的源码的，毕竟只要会使用就可以了。但在使用过程中发现了问题，不得不去读一点源码。在开始阅读源码之前，我做了一些分析。<br />因为在开发者服务器运行时，一切正常。而打包完成后，不工作了。所以<strong>这很可能是由于打包过程中破坏（重建）了某些文件结构，导致最终 pagedjs 运行时找不到相关的文件</strong>。\n<a name=nXPmT></a></p>\n<h1>排查</h1>\n<p>顺着这个思路，我对比了一下 vitepress 开发者服务器运行时渲染的 html 和打包完成后的 html，发现在开发者服务器运行时下，html 中的 css 和 script 基本上和自己在 markdown 文件中引入的非常接近，而打包后则属于是面目全非，特别是 css 和 scripts 全部被重新命名并且以一种特别的方式引入。就连在 markdown 文件中内联的 css 样式，都被打包到独立文件中去了。<br />所以我怀疑 pagedjs 没有办法找到相关的样式文件，导致了最终渲染出来的内容缺失（通过 page 指令渲染的内容全没了）。<br />于是我去看了一下 pagedjs 的源码，了解到 preview 函数接收 3 个参数，其中第 2 个果然是接收一个 css 文件。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b9d6994f6ec86294f7b43cecad032afd/88820/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABeUlEQVR42m2Sy24TQRRE/f/fAGzYsQkrJG8ICGJeisDkYcWO8ljYcSYej/s1Pd23uw+acQQiUNJV9eqoqtSjYmb49RdcdUxsTvHeECQRJJMCECH3nqDI3oMIkgsFKAVyLuTeC4xo59jlBLuagL0g2EDsoJXIrZ5zeP+K8foln5vXHFUH/Ni8Y/YwRVvBh/1JgpgKkgojp25Q6ynV4i1Ndca1OeanH/PeP+PQPWf88IJP1QEL95V7fUullhin8K3HOUsIHXsNeRl5dY2rz1ievmF19YG5+shdvMSKRlIiecgepANvO2KXeKpSylC9DJX9gtCc4O4mSHOCuA4ypKFCxjrHtqlpfUvKhRgDIvIIKMP9gZZ+wwV+O8NV3+nfrdeEKMQkREkobdhsNmjjsM5jjCGE8BvyVANQzJz65oiwnRJDOySTnIaRtd1vZV37mKyQc/4r2T/AqC9Qq29kfU7oLNJ/mZyJkmmUZ6c0Sjua3W5IW9c1KaX/An8BfAJl66CzPjAAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/b9d6994f6ec86294f7b43cecad032afd/fcda8/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png\"\n        srcset=\"/static/b9d6994f6ec86294f7b43cecad032afd/12f09/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 148w,\n/static/b9d6994f6ec86294f7b43cecad032afd/e4a3f/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 295w,\n/static/b9d6994f6ec86294f7b43cecad032afd/fcda8/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 590w,\n/static/b9d6994f6ec86294f7b43cecad032afd/efc66/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 885w,\n/static/b9d6994f6ec86294f7b43cecad032afd/c83ae/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 1180w,\n/static/b9d6994f6ec86294f7b43cecad032afd/88820/1690973410656-f8324c11-a861-4f50-b167-5c5add694d42.png 2564w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>又通过其文档看到 css 规则的确是会被解析并最终应用在页眉页脚等地。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c5fbc08529397ebbfc60069340ade071/0ff19/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACUUlEQVR42oWUW2/jNhBG/f9/0+7jBuhL+9ACbe3Ekig5Wutu8SJSlHgK0mmaRb0IocEMxeHhpyGpwzBOvL7WNG1H2/V0fU/X9YzjRNcPyeLYtWmTr79fubYd0zwnm6XiJhXTbUZqw4EHbQdOWcb5fMZay7IsSClZ1zV57z3OuTS2bVuKtVZp7iFMAwwtQSvComHsCGOPEWfcsmCMYZombrdbipVSDMPAPM8JHvsRGlsIgUM4/kF4+kr49oXw9IXw9+/w7Sv8+pSSIux4PHI6naiqinEcE7BtW/q+T/193z8A15UwRFUdYZ5gXbF9zm5kSnLOIucZrRTOWsK+J0CcHON/++/Aj7ULb37B8Lz9giN+okFUFfX1yqWuKasLoiypXl+5vJlZlg8K40pvRvJ7Inc+46p+wzYDTXFmqASdyJkuFUMp6MsivRsrgVXyJwoTND4BPDBLpvZK+Xwi++tP6jyjennmcn5JVpyOjJcStExf9xCYoCnewRp0c6XJz7RFnhQ1eUYrctoiS3FfCna/Plb4CDxLyfemYbEWFY+NMalmernHSusfj83/YfftiRvnfcD7uIvhh5xth7eNvZco8C7g8EhdbNYFpA6sHvwW/Z5ssQGld6y7g/0Ga1x4+wQY1W3O4527n6cA+xZYHHjnWZTGGos1C95tKT8m/QQYiGWRN0Vd1+nKGW3SROdBzZqX5xfKsqQoCuRNcy/jJ8BxuCFEgSgFpRDYxSWglposy8jznDzP0sKfAmPRu3ZIdzj+dbJz9h9QmQQTQlBVJUqad+A/2AnVH3mJ/poAAAAASUVORK5CYII='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/c5fbc08529397ebbfc60069340ade071/fcda8/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png\"\n        srcset=\"/static/c5fbc08529397ebbfc60069340ade071/12f09/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 148w,\n/static/c5fbc08529397ebbfc60069340ade071/e4a3f/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 295w,\n/static/c5fbc08529397ebbfc60069340ade071/fcda8/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 590w,\n/static/c5fbc08529397ebbfc60069340ade071/efc66/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 885w,\n/static/c5fbc08529397ebbfc60069340ade071/c83ae/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 1180w,\n/static/c5fbc08529397ebbfc60069340ade071/0ff19/1690973637836-693af133-c462-468d-aaa1-db8a3d583c8d.png 2084w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a name=KLAio></a></p>\n<h1>实验</h1>\n<p>之前使用的是引入 CDN 的 polyfill 文件，该文件自动完成所有的工作。现在，我需要使用调用 preview 函数的方式引入 pagedjs，从而为后面调参打好基础。于是删除 docs.vitepressconfig.ts 文件中的 head 部分。\ndiff\nexport default withMermaid(\ndefineConfig({\nhead: [</p>\n<ul>\n<li>\n<pre><code>           [\n</code></pre>\n</li>\n<li>\n<pre><code>               script,\n</code></pre>\n</li>\n<li>\n<pre><code>               {\n</code></pre>\n</li>\n<li>\n<pre><code>                   type: text/javascript,\n</code></pre>\n</li>\n<li>\n<pre><code>                   async: true,\n</code></pre>\n</li>\n<li>\n<pre><code>                   defer: true,\n</code></pre>\n</li>\n<li>\n<pre><code>                   src: https://unpkg.com/pagedjs/dist/paged.polyfill.js\n</code></pre>\n</li>\n<li>\n<pre><code>               }\n</code></pre>\n</li>\n<li>\n<pre><code>           ],\n      ]\n</code></pre>\n})</li>\n</ul>\n<p>)</p>\n<p>然后将 pagedjs 安装到 node_modules 里：</p>\n<p>shell\nyarn add pagedjs</p>\n<p>接着直接在 markdown 文件里添加\nmarkdown</p>\n<script setup>\nimport { onMounted } from vue; \nimport {Previewer} from pagedjs; \n\nonMounted(() => {\n    setTimeout(()=>{\n        let paged = new Previewer();\n      \n        let flow = paged.preview()\n            .then((flow) => {\n                console.log(Rendered, flow.total, pages.);\n            })\n            .catch((err) => {\n                console.error(paged error);\n                console.error(err);\n            })\n        ;\n    }, 3000);\n});\n</script>\n<p>验证了在开发模式工作正常，在打包静态化后重现了之前的问题。</p>\n<p><a name=OBO6V></a></p>\n<h1>调参</h1>\n<p>以上实验证明了使用 Previewer 和直接从 CDN 引入 polyfill 是一样的。不过，Previewer 允许自定义参数，现在是默认的。<br />我将 markdown 内联的样式重新放在一个文件里，为了在编译打包后仍然能引用它，我将它放在了 public 目录下。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/14b3ea69ee60d8b98efbc603d33a4556/2dc7d/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAADUUlEQVR42m2U6YrcRhSF+/1fJIG8QCB/kkBsSGbiDPZ4ZtyL1ta+b6Xa9BmppyfuOAcKJCgd3Xu+W7U7nHy+HDyKqqesB/KyJcsrwrTBC1PCMKCpS7KixQty8qwiylo+fA54etlz9CLSLCULnkiiiF0/znhBzNHxcb2Qc5zRj5JRaLQxiAmK2iC1QRmLWRSjhrhdSBpF2lm6eQErWZaFnRQNTRHiHj4SBXvGPkcMBfM8sGjIjYNTpZxTS1B2uFVO2ZRIMXLRsq3l9W2nRUFfekSnB8YmRM8lasqwWjKqgT/lD3Sypx9BSINWYNWCmjVXrZVd126aDd0gidKKMMrIioZx1lgFH8UvdEuKEuAmE248M9iJYDwTdhHnPibps83oarybpULMiuPRwfV8pNIYCWf5wrH/G8y61dKOlnOh+e39O+5f7unVgFCCWc+3hl0/0nYDcdawP7o4ToCXehyGe8SoNjCrys7iJDO/v/vAs/OMXSzf6mq6q+qOvGy4f0r44/0dDw+PfDp+pmobjLmEbY2mGw1JvRKFWjaUY7XxuGZ30/IkLV5UEvgeddNR1QNCSMxrdbM0GGO31kHxvZa3p92a3yAMj27DyyEkyWritGIYJ/TFj2nWeMnMPpQUHSSlICpa+mm8obwZzmJgnEaCKCM6h1RVQZ6nGyglEqydXzMEP205Pf1I0YzEXUE+lBhrbjM0IqEufCLnH6LjX+TnR/raZ/2R0T2L1VtLzbAQlyPZ+VeauaCXw3dALi1LQ1G1HI4uJycgTkuqZkDMEqXXVi4ZJZXmk6c5ZfCYPZP1+Y3ZW4Vra20/cXJ9/OBMmlXkRcM0zRuULR9rNsp5ayg7TTUMTOu0r5jW8Vkuh2+jLKSmqmvc4x7vdCQKA/KiZhjFN5T1K+XllfR/GS9voHdCLtS5Q+gdSOKYMAxJs5JxEih12TVMGicW7ENF0iqOlcupdvHbkHMX3Va4zmFVK/Zf9rinA2makWyGEqNqrL3MXS8gbwSR/zN51xEPyXaeO9HdjM4Gpa8qDofTdh96/lphgZgNes5ZrNw+SCrFwU9xnn+iGDKqqeb/tJuVJUlC7u7u+Pz0wjlKSdKSum4Zp39PRdf3xGlC2RrSISMfiptr61rhVzcisDeaLpkgAAAAAElFTkSuQmCC'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/14b3ea69ee60d8b98efbc603d33a4556/fcda8/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png\"\n        srcset=\"/static/14b3ea69ee60d8b98efbc603d33a4556/12f09/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 148w,\n/static/14b3ea69ee60d8b98efbc603d33a4556/e4a3f/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 295w,\n/static/14b3ea69ee60d8b98efbc603d33a4556/fcda8/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 590w,\n/static/14b3ea69ee60d8b98efbc603d33a4556/efc66/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 885w,\n/static/14b3ea69ee60d8b98efbc603d33a4556/c83ae/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 1180w,\n/static/14b3ea69ee60d8b98efbc603d33a4556/2dc7d/1690974002187-13e8bb82-7fd1-4398-97dc-eddb66be6c6c.png 1760w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>由于 css 文件是第二个参数，为了不改动第一个参数和第三个参数，我将它们置为 undefined：\ndiff</p>\n<script setup>\nimport { onMounted } from vue; \nimport {Previewer} from pagedjs; \n\nonMounted(() => {\nsetTimeout(()=>{\n\tlet paged = new Previewer();\n\n-        let flow = paged.preview()\n+        let flow = paged.preview(undefined, [/pagedjs.css], undefined)\n\t\t\t\t\t.then((flow) => {\n\t\t\t\t\t\tconsole.log(Rendered, flow.total, pages.);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\tconsole.error(paged error);\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t})\n\t\t\t\t\t;\n\t}, 3000);\n});\n</script>\n<p><a name=T5TsM></a></p>\n<h1>问题解决</h1>\n<p>到此问题已经解决！完整源代码见： <a href=\"https://github.com/Jeff-Tian/AllAboutIdentity\">https://github.com/Jeff-Tian/AllAboutIdentity</a><br />在线体验链接： <a href=\"https://identity.jefftian.dev/main.html\">https://identity.jefftian.dev/main.html</a><br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.94594594594594%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACVklEQVR42q1Ta08aQRTdv9MmrYkp1vRDkzZp+t+aVtviF0El9KFNf0RLUmwCKBKIoiwojwVBHrvIPnAfnOZc3FT80E+d5GbOnblz5tw7d5Rk8hN2d/fw+ctXbO8kEI9vIR7fFovdYs6bm/G5xe7Yrc8ziUQSe9++Q8F/Hsr19TVM08LZ2Rmq1SoqlYoYMU3TNIzHY3iet3Bw6jgwdH1hzXVdKJZlYTqdotfrCWmj0UCz2cTx8TFOT09xfn6O4XAIYzzGRiyG9egG1qJRvH3/AW/W1rEW3cC7j1HEdhLQDQOK4ziioFAo4OLiAvl8XsjoHx4e4ujoCFqrhZamYfnlCzyMrODxyioeRZ5iKbKKpdVneLD8BM9fvUZT06DYtg2qPDk5QblcRrFYFFyv1yXlUqkk2PU8FEpF/Eqnkd7/jUw2i/T+Pn6mUviRSiFfKODm5mZOaJqm1I2ETJskJCU511ln1kdVVfEZw2yqqoparQpVraDX7cL3vHkNGXx5eSnB4SEeoDL67XYbvu+j2+2K6k6nI/FXV1cYDAYys85eSEiVtVpNNvk4DNB1XXySEDNGFUU1eTg+FjuAxsdrtVp/CQlms9k/+4tZUCk7gJdSJS/r9/uCR6ORZKGwfgQcJL1vQRDIHgvOdNkFuVwOBwcHyGazgjOZjFzG2HuEcwtHSMrB9hoMhjAtG5OJKYpoYWkmk0mo0ILv8xd4wIxzIDfdLQExUw73MZvvh0IWfgoJXXeKwDXguwYC34FtO5IiiWn8SY5tIfDG8F0dlqlD1w2pJR+LMcyA+A8PjfWF4fbHUAAAAABJRU5ErkJggg=='); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/1e0fdab9e650a823485b9f35aeec97d2/fcda8/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png\"\n        srcset=\"/static/1e0fdab9e650a823485b9f35aeec97d2/12f09/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 148w,\n/static/1e0fdab9e650a823485b9f35aeec97d2/e4a3f/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 295w,\n/static/1e0fdab9e650a823485b9f35aeec97d2/fcda8/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 590w,\n/static/1e0fdab9e650a823485b9f35aeec97d2/efc66/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 885w,\n/static/1e0fdab9e650a823485b9f35aeec97d2/c83ae/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 1180w,\n/static/1e0fdab9e650a823485b9f35aeec97d2/6cb28/1690978001787-8e415eee-209e-4e4f-9404-40adacebf879.png 2430w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}