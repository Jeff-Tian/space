{"componentChunkName":"component---src-templates-post-js","path":"/posts/yyt229/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/yyt229","relativePath":"posts/yyt229","frontmatter":{"title":"代码如诗，牛刀小试 —— 一个小小编程练习","stackbit_url_path":"posts/yyt229","date":"2021-04-08T12:03:41","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<blockquote>\n<p>这道题的逻辑对我来说太简单了，但是，我的文言文水平，是在是令人捉急！\n<a href=\"https://github.com/josevalim/nested-data-structure-traversal/blob/master/wenyan/recursive.wy\">https://github.com/josevalim/nested-data-structure-traversal/blob/master/wenyan/recursive.wy</a></p>\n</blockquote>\n<p><a name=38zWR></a></p>\n<h2>像诗一样优美的代码</h2>\n<p>有人问雷军：“你写过诗吗？”<br />雷军回答：“没有。但是有人说过，我写的代码，就像诗一样优美。哈哈哈哈哈哈哈哈哈哈”<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7938cd1bfa7c6e48d6ac90d186f2c087/a0209/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 275.6756756756757%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/7938cd1bfa7c6e48d6ac90d186f2c087/fcda8/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png\"\n        srcset=\"/static/7938cd1bfa7c6e48d6ac90d186f2c087/12f09/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png 148w,\n/static/7938cd1bfa7c6e48d6ac90d186f2c087/e4a3f/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png 295w,\n/static/7938cd1bfa7c6e48d6ac90d186f2c087/fcda8/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png 590w,\n/static/7938cd1bfa7c6e48d6ac90d186f2c087/a0209/1617882990375-c665cdcd-3827-4ae2-bf9b-49185e53c6ad.png 725w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span><br />像诗一样优美，这样的代码，真的是艺术中的艺术了！</p>\n<p><a name=eUTlA></a></p>\n<h2>工欲善其事，必先利其器</h2>\n<p>但是，工欲善其事，必先利其器。如果编程语言本身很丑，实在令程序员不爽。所以，要写出像诗一样的代码，得先找个足够优美的编程语言。到目前为止，文言文编程语言，是最惊艳我的一门编程语言。<br /><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.8918918918919%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACo0lEQVR42nWUWU8iURCF+9+LGz6MmPkTYiYxGhMfRJStG2kaMC6A7LK5RR8EHs7kK3KJ48SHyq17b9WpU+dWt/drN6HE3m+x7u7uKZHYUzy+o43NLW1ubv9vW0vb2orbGoutKxbb0NraurbjO/I+Pj70/v6u+Xyu2exTs89P8xeLhRaLufluP5vNLNblTCYT9Xo9Dfp9NZtNTcZjeePx2C5YR6OR2Vff3Q2Ho9UZ9vj4qOFwuIrtdrt25k2nU2EcEgAAxiXmAPGJIZYzYt2eewzf63Q6GgwGdtnv9/Xw8GCXLy8vZs/Pz2b4ABHTbrfNAKUQfqPRsL2XzWZ1VSyqVquqWq3q/PzckgBxcjgZ6vW6Wq2WgcAmn8+rUCjYXRiG1rYXBIEC39fl5aUqUVnpdNoSyuWyMpmMfN8XRbknGTYUeH191cHBgY6OjvT09GSAPJBXKpVUqVRULBZ1c3NjgFDHBzSKItVqNdvTgQOEIXvOYUjsChAr5PMGTAIV3QtjJMOIlbYoiCTIQ9ucp1KpZcvoB90g8BWGJatGMm1TAN0QHN89HIA80tnZmY6Pjw0QUsawWqmoVLqSXygYIElvb2+WmMvlTD90hAHT4ABdyxSiixUgQpfD0DSErWPIykgRRCv4tMkeQGIODw91enpqEjFuFPMQ/fr62gCr1WW1r/NHojPOHSBd7O/vK5lMrjSnAy+KKjY2iAvwd0CCnTlA9/kBAHP3GRpgMfBt/tDp9vbWtHFg3w1A98ruUdwrDx1D2BWLgfK5nKKorOk3hl+Z0jZa8QDEoOHJyYnGo5F6nfZSQ74U3y8om81Y67TyEyC63d3d2fyxbzYa6g8G6rVb8v8k1W7U5THp9ft7mzVaRkMH8BPgxcXFPz+HZr2uMJ1St93WXwaxBtKCu0WEAAAAAElFTkSuQmCC'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/0cf127a5080345698406d5a3a11445c0/fcda8/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png\"\n        srcset=\"/static/0cf127a5080345698406d5a3a11445c0/12f09/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 148w,\n/static/0cf127a5080345698406d5a3a11445c0/e4a3f/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 295w,\n/static/0cf127a5080345698406d5a3a11445c0/fcda8/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 590w,\n/static/0cf127a5080345698406d5a3a11445c0/efc66/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 885w,\n/static/0cf127a5080345698406d5a3a11445c0/c83ae/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 1180w,\n/static/0cf127a5080345698406d5a3a11445c0/5b503/1617882259097-9dae431b-10a3-4311-8416-26ad5310c934.png 1976w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n<a name=LQgDk></a></p>\n<h2>使用不熟悉的编程语言进行开源贡献</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dcf3651964339d46f090eec5985800cc/ace37/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMUlEQVR42nVTW0tyQRQ9f7refDIffBIRRKgUBA0EUyEf0gSvpZbiNa+Fl0wtDQXvmSvWlvNx+Pi+DcOZMzN7zVpr71EA4HA4QPvVBtf+tx8Oh3F2dobFYvFnTdEmMt7e3pDNZvH4+Iivry/8vb/ZbDCdThEIBGA0GnFxcQGXy4XhcIjv7+8joHp4Pp/LjScnJ7BarTg/PxfQ3W4n++PxGN1uF4lEAqenp3LWYDDAZDLJejqdhkKwn58fSXh6eoLdbofNZpMvE0qlEt7f34UZJVarVRQKBXi9XpjNZlgsFoRCIcmPxWJHwP1+Lwu3t7fQ6XRwu91y0OPxoN/vo9PpoN1uIxqNIhgMwul0Crher0cqlRLJzM3lckdArdm1Wg3Pz8/w+Xzo9XqyVywWEYlEBJz/5XJZWL6+vso8Ho/j8/NT1IiHlExJZEKzCfjw8IBkMikFYCLlMIFzsuH4+PgQpldXV3IBwRWWfLVaoVKpoNlsSmHq9Tqur6+FJeeNRkO840U0nxe/vLzg/v4eDodDSBBD2oZtwri7u8NgMBBGjEwmIwDa2G63AsgWYfUJQmC1C6hUGY1G4hXNJcubmxvZzOfz4gtDTViv19IaBGXlKZmDRVXroNA7FkKVQGDKZHPzIMGWy6XcTv8ovdVqYTKZYDabgYS0zS9FIRO/3y++XV5eSv9RMgd7jFVkkWg8g77THkonIe0TVdSmZhL7jrJYBLLm82OrkBnt4Br3//Xe1bf8C2A2n5FFhn00AAAAAElFTkSuQmCC'); background-size: cover; display: block; transition: opacity 0.5s 0.5s; pointer-events: none;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/dcf3651964339d46f090eec5985800cc/fcda8/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png\"\n        srcset=\"/static/dcf3651964339d46f090eec5985800cc/12f09/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png 148w,\n/static/dcf3651964339d46f090eec5985800cc/e4a3f/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png 295w,\n/static/dcf3651964339d46f090eec5985800cc/fcda8/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png 590w,\n/static/dcf3651964339d46f090eec5985800cc/ace37/1617883299122-b249b8e6-cb2b-4368-b101-1bdd263bd98d.png 666w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;opacity:0;transition:opacity 0.5s;color:inherit;box-shadow:inset 0px 0px 0px 400px white;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>专业人士都需要通过专门训练提升自己的技能，无一例外。乐手练习音阶，球员练习绕桩，医生练习开刀和缝针，律师练习论辩，士兵练习执行任务。要想表现优异，专业人士就会选择练习。</p>\n<p>保持不落伍的一种方法是为开源项目贡献代码，就像律师和医生参加公益活动一样。开源项目有很多，为其他人真正关心的开源项目做一点贡献，应该可以算是提升技能的最好办法了。</p>\n<p>所以，如果你是Java程序员，请为Rails项目做点贡献。如果你为老板写了很多C++，可以找一个Python项目贡献代码。\n—— [美] Robert C. Martin 《代码整洁之道：程序员的职业素养》</p>\n</blockquote>\n<p>Bob 大叔在《代码整洁之道：程序员的职业素养》中建议我们多用自己不熟悉的语言为开源项目贡献代码，我在工作中使用 TypeScript 语言，所以我决定使用文言语言编程语言，为开源项目 <a href=\"https://github.com/josevalim/nested-data-structure-traversal\">nested-data-structure-traversal</a> 做一点贡献。<br />这个开源项目目前一共有 149 星，并不是太知名。它主要是收集各种编程语言解决一个嵌套数据结构的遍历和标记问题，其 README 上给的 Python 示例，虽然行数较少，但是并不令人满意，因为它修改了传入的参数，有副作用。\n<a name=5vUFB></a></p>\n<h2>分析</h2>\n<p>通过应用不可变思想，采用递归方案，不仅同样可以实现代码行数比较少，没有副作用，而且还能避免使用循环语句。\n<a name=VODDS></a></p>\n<h2>文言实现效果</h2>\n<p>最终代码行数还是超过了 100 行，但是多数是测试代码。不过，主要由于文言水平太差，以及对文言编程语言不熟，所以最终没能写成诗。好在项目的作者并不介意，提了 PR，秒合！<a href=\"https://github.com/josevalim/nested-data-structure-traversal/pull/69/files\">https://github.com/josevalim/nested-data-structure-traversal/pull/69/files</a></p>\n<p>注曰：访问 <a href=\"https://ide.wy-lang.org/?file=%E9%81%8D%E5%8E%86%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%8C\">https://ide.wy-lang.org/?file=%E9%81%8D%E5%8E%86%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84，</a>\n注曰：粘贴本页代码，即可运行。</p>\n<p>注曰：遍访并标记嵌套数据结构编程练习</p>\n<p>吾有一術名之曰「访问章节列表」：\n欲行是術必先得一物曰「章节列表」、一物曰「章节计数器」、一物曰「课程计数器」、一物曰「累积者」。\n乃行是術曰：\n夫「章节列表」之一，名之曰「此章节」。\n夫「章节列表」之其餘，名之曰「其餘章节」。\n吾有一數、曰一，名之曰「索引一」。\n吾有一數、曰一，名之曰「索引二」。\n夫「此章节」之「「reset_lesson_position」」，變其，名之曰「课程计数未重置」。</p>\n<pre><code>若「课程计数未重置」者：\n    夫「此章节」之「「lessons」」，名之曰「课程列表」。\n    夫「课程列表」之長，加「课程计数器」以其。\n    昔之「索引一」者、今其是矣。\n    昔之「索引二」者、今「课程计数器」是矣。\n云云。\n\n昔之「此章节」之「「position」」者、今「章节计数器」是矣。\n夫「此章节」之「「lessons」」，名之曰「课程列表」。\n吾有一列，名之曰「虚空」。\n施「访问课程列表」於「课程列表」、於「索引二」、於「虚空」。\n昔之「此章节」之「「lessons」」者、今其是矣。\n充「累积者」以「此章节」。\n\n若「其餘章节」之長不大於零者，乃得「累积者」云云。\n\n加「章节计数器」以一，名之曰「新章节计数器」。\n施「访问章节列表」於「其餘章节」、於「新章节计数器」、於「索引一」、於「累积者」，\n名之曰「已访问之章节列表」，乃得 「已访问之章节列表」！\n</code></pre>\n<p>是謂「访问章节列表」之術也。</p>\n<p>噫！吾有一術名之曰「访问课程列表」：\n欲行是術必先得一物曰「课程列表」、一物曰「课程计数器」、一物曰「累积者」。\n乃行是術曰：\n變「课程列表」名之曰「未见课程列表」。\n夫「课程列表」之長，名之曰「長度」。\n吾有一爻，名之曰「或虚空」。若「長度」等於零者，昔之「或虚空」者今陽是矣云云。\n夫「未见课程列表」「或虚空」中有陽乎？名之曰「無实」。\n若「無实」者，乃得「累积者」云云。</p>\n<pre><code>夫「课程列表」之一，名之曰「此课程」；\n夫「课程列表」之其餘，名之曰「其餘课程」。\n昔之「此课程」之「「position」」者今「课程计数器」是矣。\n\n充「累积者」以「此课程」。\n加「课程计数器」以一，名之曰「新课程计数器」。\n施「访问课程列表」於「其餘课程」、於「新课程计数器」、於「累积者」，\n名之曰「已访问课程列表」，乃得 「已访问课程列表」！\n</code></pre>\n<p>是謂「访问课程列表」之術也。</p>\n<p>噫！吾有一術名之曰「遍访章节」：\n欲行是術必先得一物曰「章节列表」。\n乃行是術曰：\n吾有一列，名之曰「虚空」。\n施「访问章节列表」於「章节列表」、於一、於一、於「虚空」，\n名之曰「已遍访章节」，乃得「已遍访章节」！\n是謂「遍访章节」之術也。</p>\n<p>噫！吾有一術名之曰「造测试数据」：\n乃行是術曰：\n噫！吾有一列名之曰「庚未」，\n吾有一物名之曰「丑甲」。\n昔之「丑甲」之「「title」」者今「「Getting started」」是矣。\n昔之「丑甲」之「「reset_lesson_position」」者今陰是矣。\n吾有一列名之曰「辛戊」，\n吾有一物名之曰「已访问课程列表」。\n昔之「已访问课程列表」之「「name」」者今「「Welcome」」是矣。\n吾有一物名之曰「戌丁」，\n昔之「戌丁」之「「name」」者今「「Installation」」是矣。\n充「辛戊」以「已访问课程列表」、以「戌丁」。\n昔之「丑甲」之「「lessons」」者今「辛戊」是矣。\n吾有一物名之曰「酉寅」，\n昔之「酉寅」之「「title」」者今「「Basic operator」」是矣。\n昔之「酉寅」之「「reset_lesson_position」」者今陰是矣。\n吾有一列名之曰「未甲」，\n吾有一物名之曰「二申」。\n昔之「二申」之「「name」」者今「「Addition / Subtraction」」是矣。\n吾有一物名之曰「未丑」，\n昔之「未丑」之「「name」」者今「「Multiplication / Division」」是矣。\n充「未甲」以「二申」、以「未丑」。\n昔之「酉寅」之「「lessons」」者今「未甲」是矣。\n吾有一物名之曰「二寅」，\n昔之「二寅」之「「title」」者今「「Advanced topics」」是矣；\n昔之「二寅」之「「reset_lesson_position」」者今陽是矣。\n吾有一列名之曰「卯乙」，\n吾有一物名之曰「寅丙」。\n昔之「寅丙」之「「name」」者今「「Mutability」」是矣。\n吾有一物名之曰「壬庚」，\n昔之「壬庚」之「「name」」者今「「Immutability」」是矣。\n充「卯乙」以「寅丙」、以「壬庚」。\n昔之「二寅」之「「lessons」」者今「卯乙」是矣。\n充「庚未」以「丑甲」、以「酉寅」、以「二寅」。\n乃得「庚未」！\n是謂「造测试数据」之術也。</p>\n<p>施「造测试数据」之術，名之曰「测试数据」。\n施「遍访章节」於「测试数据」，名之曰「已遍访章节」。</p>\n<p>吾有一物曰「已遍访章节」，書之！</p>\n<p>夫「已遍访章节」之三，名之曰「末章节」；\n夫「末章节」之「「title」」，曰「标题」。</p>\n<p>吾有一物，曰「标题」。書之！</p>\n<p>夫「末章节」之「「lessons」」，名之曰「末章节之课程」；\n夫「末章节之课程」之一，名之曰「课程一」；\n夫「末章节之课程」之二，名之曰「课程二」。\n夫「课程一」之「「position」」，曰「位置一」；\n夫「课程二」之「「position」」，曰「位置二」。</p>\n<p>吾有二物，曰「位置一」、「位置二」。書之！</p>\n<p><a name=hCBM0></a></p>\n<h2>彩蛋</h2>\n<p>附上雷军 1989 年写的汇编，能把汇编写成诗，实在是高手高手高高手。不过和我写的小诗不同，雷军写的那可是长篇史诗！</p>\n<p>;\n; RI.ASM Revision 2.12 [ July 12, 1994 ]\nRevision equ V2.12\n;\n;\n;\n;  RAMinit Release 2.0\n;  Copyright (c) 1989-1994 by Yellow Rose Software Co.\n;  Written by Mr. Leijun\n;\n;  Function:\n;  Press HotKey to remove all TSR program after this program\n;\n;</p>\n<p>; ..........................................................................\n; Removed Softwares by RI:\n; SPDOS v6.0F, WPS v3.0F\n; Game Busters III, IV\n; NETX ( Novell 3.11 )\n; PC-CACHE\n; Norton Cache\n; Microsoft SmartDrv\n; SideKick 1.56A\n; MOUSE Driver\n; Crazy (Monochrome simulate CGA program)\n; RAMBIOS v2.0\n; 386MAX Version 6.01\n; ..........................................................................\n; No cancel softwares:\n; Windows 3.1 MSD\n;\n; No removed TSR softwares:\n; MS-DOS fastopen\n; Buffers, Files ... (QEMM 6.0)\n; QCache (386MAX 6.01)\n; ..........................................................................\n;\nCOMMENT</p>\n<p>V2.04 Use mouse driver software reset function to initiation mouse\n2/17/1993 by Mr. Lei and Mr. Feng\nV2.05 RI cannot work in Windows DOS prompt\n3/9/1993 by Mr. Lei\nV2.06 1. When XMS cannot allocate 1K memory, RI halts.\n2. RI repeat deallocates EMS memory.\nV2.07 HotKey Setup Error\n4/25/1993 by Mr. Lei\nV2.08 KB Buffer\nV2.10 1. Release high memory blocks (EMM386 QEMM386 S-ICE 386MAX)\n2. RI copies flag\nV2.12 1. Exists a critical error in Init 8259 procedure\n2. Save [40:F0--FF] user data area</p>\n<p>dosseg\n.model tiny\n.code\nlocals @@\norg 100h</p>\n<p>Start: jmp Main\norg 103h</p>\n<p>True equ 1\nFalse equ 0\nMaxHandles equ 100h</p>\n<p>INT3 macro\nout 0ffh,al\nendm\n;\n; HotKey Status Test Var\n; --------------- ---------------\n;\n; 7 6 5 4 3 2 1 0 417 418 496\n; . . x . x . . . Left Alt is pressed 8 2\n; x . . . x . . . Right Alt is pressed 8 8\n; . . . x . x . . Left Ctrl is pressed 4 1\n; . x . . . x . . Right Ctrl is pressed 4 4\n; . . . . . . x . Left Shift is pressed 2\n; . . . . . . . x Right Shift is pressed 1\n;\nLeftAlt equ 00101000b\nRightAlt equ 10001000b\nLeftCtrl equ 00010100b\nRightCtrl equ 01000100b\nLeftShift equ 00000010b\nRightShift equ 00000001b\nHotKey db LeftCtrl or RightCtrl</p>\n<p>DataBegin dw 0\nNextDataSeg dw 0ffffh\noldInt2F_addr dw 0, 0\nXMS_control dw 0, 0\nHandle_begin dw 0\ncvtOfs dw 0 ; DOS 3.0 equ 0 and above DOS 4.0 is 1\norg 104h\ndb 0dh\ndb Revision\ndb ??date\ndb 26\norg 114h\ntsrLength dw 0\nMachineID db 0FCh ; IBM PC/AT</p>\n<p>AuxHotKey db 0 ; 2Dh ; X Scan Code\nAuxHotKeyName db X$\nPower db True\nFlag db !\nKbd102 db 0\nNoFlag db 0\nStopFlag db 1\nDosEnv dw 0\nWorkSeg dw 0\nPrevDataSeg dw 0\nCopies db 1\nold_8259 db 0 ; 21h port\ndb 0 ; a1h port</p>\n<p>Status dw 0\nXMSbit equ 00000001b\nEMSbit equ 00000010b\nSKbit equ 10000000b</p>\n<p>GoINT1C: db 0eah\noldInt1C_addr dw 0, 0\nnewINT1C:\ntest cs:Status, SKbit\njnz GoINT1C\ncmp cs:StopFlag, 0\njz @@0\n;\n; Mr. Lei 2/8/1993\n; Problem: if WPS quit and reenter, old RI cannt control keyboard. ;\npush ds\npush ax\nxor ax, ax\nmov ds, ax\nmov ax, ds:[94]\ncmp ax, offset NewInt9\npop ax\npop ds\njnz GoINT1C\nmov cs:StopFlag, 0</p>\n<p>@@0: push ax\npush ds\npush es\nxor ax, ax\nmov ds, ax\nmov es, ds:[94+2]\ncmp word ptr es:[101h], IE ; LEI\njz @@1\ncli\nmov cs:StopFlag, 1\nmov ax, ds:[94]\nmov cs:oldINT9_addr2, ax\nmov ax, ds:[94+2]\nmov cs:oldINT9_addr2[2], ax\nmov ds:[94], offset newINT9_2\nmov ds:[94+2], cs\nsti\n@@1: pop es\npop ds\npop ax\njmp GoINT1C</p>\n<p>; ----------------------------------------------------------------------\n; INT2F Func\n;\n; AX = C0D7h Return RI segment in AX\n; AX = C0D8h Removes all TSR programs after RI\n; AX = C0D9h Removes all TSR programs include RI\n; AX = C0DAh Removes all RI copies\n; ----------------------------------------------------------------------</p>\n<p>newINT2F:\ncmp ax, 0c0d7h ; LEI Hanzi GB Code\njnz @@1\npush cs\npop ax\niret\n@@1: cmp ax, 0c0d7h+1\njnz @@2\njmp KeepSelf\n@@2: cmp ax, 0c0d7h+2\njnz @@3\njmp NoKeepSelf\n@@3: cmp ax, 0c0d7h+3\njnz @@9\nmov cs:NextDataSeg, -1\nmov cs:Copies, 1\njmp NoKeepSelf\n@@9: jmp dword ptr cs:oldInt2F_addr</p>\n<p>CallInt9:\nret</p>\n<p>newINT9_2:\nmov cs:NoFlag, 1\npushf\ndb 9ah ; call far ptr oldint9_addr\noldInt9_Addr2 dw 0, 0\njmp newINT9_proc</p>\n<p>newINT9:\npushf\ndb 9ah ; call far ptr oldint9_addr\noldInt9_Addr dw 0, 0 cmp cs:NoFlag, 0\njz newINT9_proc\nmov cs:NoFlag, 0\niret\nnewINT9_proc:\ncmp cs:Flag, ! ; busy ?\njnz @@0\niret\n@@0:\nmov cs:Flag, ! ; set busy flag\npush ax ; cmp hot key\npush bx\npush es\nmov ax,40h\nmov es,ax</p>\n<p>cmp cs:AuxHotKey, 0\njz @@_1\nmov bx, es:[1ah]\ncmp bx, es:[1ch]\njz @@10\npush bx\nmov bl, es:[bx+1]\ncmp bl, cs:AuxHotKey\npop bx\njnz @@10\n@@_1:\nmov ah,es:[17h] ; test CTRL SHIFT ALT\nmov al,cs:HotKey\npush ax\nand ax,0f0fh\ncmp al,ah\npop ax\njnz @@10 cmp cs:Kbd102, True\njnz @@1\nshr al, 1\nshr al, 1\nshr al, 1\nshr al, 1\npush ax\nmov ah, es:[18h]\nand ax, 303h\ncmp al, ah\npop ax\njnz @@10\nmov ah, es:[96h]\nshr ax, 1\nshr ax, 1\nand ax, 303h\ncmp al, ah\njnz @@10 cmp cs:AuxHotKey, 0\njz @@_3\ninc bx\ninc bx\ncmp bx, 3eh\njb @@_2\nmov bx, 1eh\n@@_2:\nmov es:[1ah], bx\n@@_3:\ncall IsWinDos\nor ax, ax\njz @@1\ncall Beep\n@@10:\nsti\npop es\npop bx\npop ax\nmov cs:Flag,   ; no busy\niret\n@@1: ; OK\npop es\npop bx\npop ax</p>\n<p>KeepSelf:\ncall RemoveTSR\npush es\nmov es,cs:WorkSeg\nmov dx,es:tsrLength\nmov di,dx\nmov al,0h ; Aug 24, 1993\nmov cx,100h\nrep stosb\npop es\nint 27h</p>\n<p>NoKeepSelf:\nmov ax,0e07h\nint 10h\nmov cs:clsStr, 47h ; Color (White in Red)\ncall RemoveTSR\ndec cs:Copies\ncall RestoreSelfIntVec\npush es\ncmp cs:PrevDataSeg, 0\njz @@1\nmov es, cs:PrevDataSeg\nmov es:NextDataSeg, -1\n@@1: pop es\nmov ax, 4c00h\nint 21h</p>\n<p>; ---------------------------------------------------------------------------</p>\n<p>IsWinDOS:\nmov ax, 1600h\nint 2fh\ncmp al, 01h\njz @@9 cmp al, 0ffh\njz @@9 ; Windows/386 Version 2.X\ncmp al, 00h\njz @@1 cmp al, 80h\njnz @@9 ; Windows 3 in enhanced mode\n; Version number in AL/AH\n@@1:\nmov ax, 4680h\nint 2fh\ncmp al, 80h\njnz @@9\nxor ax, ax\njmp @@10\n@@9: mov ax, 1\n@@10: ret</p>\n<p>; -----------------------------------------------------------------------\nRestoreSelfIntVec:\ncmp Copies, 0\njz @@0\nret\n@@0:\ncli\npush cs\npop ds\nxor ax, ax\nmov es, ax\nmov si, offset oldInt9_Addr\nmov di, 94\nmovsw\nmovsw\nmov si, offset oldInt2F_Addr\nmov di, 2Fh4\nmovsw\nmovsw\nmov si, offset oldInt1C_Addr\nmov di, 1Ch4\nmovsw\nmovsw\nsti\nret</p>\n<p>; ------------- KERNEL PROGRAM ----------------------------------------------\nRemoveTSR:\npop ax\ncli ; Set stack\nmov sp, cs\nmov ss, sp\nmov sp, 100h\nsti\npush ax</p>\n<p>cmp cs:Power, True\njnz @@1\ncall Init8259\n@@1:\npush cs\npop ds\n@@_0:\nmov ax,ds:NextDataSeg\ncmp ax, -1\njz @@_1\nmov cs:PrevDataSeg, ds\nmov ds, ax\njmp @@_0\n@@_1: mov si,ds:DataBegin\nmov cs:WorkSeg, ds\nlodsw\ncmp ax, XX\njz @@_2\ncall Beep\nret\n@@_2:\ncall RestoreEnvStr\ncall RestoreMCB ; restore current mcb\ncall CloseFiles\ncall RestorePort\ncall RestoreLEDs\ncall RestoreVecList ; Restore vectors list\ncall RestoreFloppyParam\ncmp cs:Power, True\njnz @@2\ncall RestoreCVTchain ; Restore cvt chain\ncall RestoreMemoryManager\n@@2:\ncall RestoreBiosData\ncall Enable8259\nmov ah, 1 int 16h</p>\n<p>call RestoreClockSpeed\ncall CloseSpeaker\ncall ResetDisk\ncall UpdateTime</p>\n<p>call ClosePRN\nmov bx,cs:WorkSeg\nmov ah,50h\nint 21h ; Set PSP segment\nmov ax,3 int 10h ; Set display mode</p>\n<p>call InitPRN\ncall InitMouse\nmov al, cs:Copies\ncmp al, 1\nja @@_sh1\nmov cs:ShowCopies,\njmp @@_sh2\n@@_sh1: mov cs:ShowCopies, al\n@@_sh2:\nmov si, offset clsStr\ncall ColorPrintStr\nmov cs:Flag,   ; no busy\ncmp Copies, 1\njnz @@_end\nmov cs:StopFlag, 0\n@@_end:\ncall ClearKB_buffer\nret</p>\n<p>Beep:\nmov ax,0e07h\nint 10h\nret</p>\n<p>; #########################################################################</p>\n<p>ClearKB_Buffer:\npush es\npush bx\nmov bx, 0040h\nmov es, bx\ncli\nmov bx, es:[1ah]\nmov es:[1ch], bx\nsti\npop bx\npop es\nret</p>\n<p>Init8259:\n; cmp cs:Copies, 1\n; jz @@1\n; ret\n@@1:\ncmp cs:MachineID, 0fch\nja @@pc_xt\n@@AT:\nmov bx,870h ;\nmov al,0 ;\nout 0F1h,al ;\njcxz $+2\njcxz $+2\nmov al,11h ; ICW1\nout 0A0h,al\njcxz $+2\njcxz $+2\nout 20h,al\njcxz $+2\njcxz $+2\nmov al,bl ; ICW2\nout 0A1h,al\njcxz $+2\njcxz $+2\nmov al,bh\nout 21h,al\njcxz $+2\njcxz $+2\nmov al,2 ; ICW3\nout 0A1h,al\njcxz $+2\njcxz $+2\nmov al,4\nout 21h,al\njcxz $+2\njcxz $+2\nmov al,1 ; ICW4\nout 0A1h,al\njcxz $+2\njcxz $+2\nout 21h,al\njcxz $+2\njcxz $+2\nmov al,0FFh ; OCW1\nout 0A1h,al\njcxz $+2\njcxz $+2\nout 21h,al\nret\n@@PC_XT:\nmov al,13h ; ICW1\nout 20h,al\njcxz $+2\njcxz $+2\nmov al,8 ; ICW2\nout 21h,al\njcxz $+2\njcxz $+2\nmov al,9 ; ICW4\nout 21h,al\njcxz $+2\njcxz $+2\nmov al,0FFh ; OCW1\nout 21h,al\nret</p>\n<p>Enable8259:\nmov ax, word ptr cs:old_8259\nout 021h,al\njcxz $+2\njcxz $+2\nmov al,ah\nout 0a1h,al ; DEC PC Bus Mouse\nret ; July 1994 by Mr. Lei</p>\n<p>; -------------------------------------------------------------------------</p>\n<p>RestoreBiosData:\nlodsw\ncmp ax, --\njz @@1\ncall Beep\nret\n@@1: push es\npush di\nmov di, 40h\nmov es, di</p>\n<p>mov di, 10h\nmovsw\nmov di, 0a8h ; [40h:a8h]\nmovsw\nmovsw\nmov di, 49h\nmov cx, 1dh\nrep movsb</p>\n<p>mov di, 0f0h ; User data\nmov cx, 8\nrep movsw</p>\n<p>pop di\npop es\nret</p>\n<p>; -------------------------------------------------------------------------</p>\n<p>RestoreMCB:\npush ds\npush es\nlodsw ; MZ\n@@0: lodsw\ncmp ax, MM\njz @@1\nmov es,ax\nxor di,di\nmovsb\nmovsw\nmovsw\ninc ax\nmov bx, ds\ncmp ax, bx\njz @@10\nmov byte ptr es:[8], 0 ; Aug 24, 1993\n@@10: cmp byte ptr es:[0], Z\njnz @@0\nmov byte ptr es:[10h], 0\njmp @@0\n@@1:\npop es\npop ds\nret</p>\n<p>; -------------------------------------------------------------------------\nCloseFiles:\nmov ax, 5 ; Begin handle\npush ds\npush si\nmov cx, 15 ; Max handle\nsub cx, ax\ninc cx\nmov bx, ax\n@@1: push bx\npush cx\nmov ah, 3eh\nint 21h\npop cx\npop bx\ninc bx\nloop @@1\npop si\npop ds\nret</p>\n<p>; -------------------------------------------------------------------------\nRestorePort:\nmov di, 40h ; restore port\nmov es, di\nxor di, di\nmov cx, 8\nrep movsw\nret</p>\n<p>; -------------------------------------------------------------------------\nRestoreLEDs:\nlodsb\nand al, 11110000b ; LED status\nmov ah, es:[17h]\nand ah, 00001111b\nor ah, al\nand ah, 0f0h ; Clear CTRL ALT SHIFT\nmov es:[17h], ah\nret</p>\n<p>; -------------------------------------------------------------------------\nRestoreEnvStr:\nlodsw\npush si\npush di\npush ds\npush es\nmov es, cs:DosEnv\nmov ds, ax\nxor si, si\nmov di, si\n@@0: lodsb\nor al, al\njnz @@1 cmp byte ptr ds:[si], 0\njz @@2\n@@1: stosb\njmp @@0\n@@2: stosb\nstosb\npop es\npop ds\npop di\npop si\nret</p>\n<p>; -----------------------------------------------------------------------\nRestoreVecList:\nxor ax,ax\nmov di,ax\nmov es,ax\nmov cx,100h\n@@0: lodsw\nxchg dx, ax\nlodsw\ncmp dx, EL\njnz @@1 cmp al, I\njnz @@1\nsub cl, ah\npush cx\nmov cl, ah\nmov ax, es:[di-4]\nmov dx, es:[di-2]\n@@a: stosw\nxchg ax, dx\nstosw\nxchg ax, dx\nloop @@a\npop cx\nor cx, cx\njz @@9\njmp @@0\n@@1:\nxchg ax, dx\nstosw\nxchg ax, dx\nstosw\nloop @@0\n@@9:\nret</p>\n<p>;----------------------------------------------------------------------------\nRestoreFloppyParam: ; Mr. Lei 2/10/1992\npush es\npush ax\nxor ax, ax\nmov es, ax\nmov byte ptr es:[525h], 2\npop ax\npop es\nret</p>\n<p>;---------------------------------------------------------------------------\nRestoreCVTchain:\nlodsw\ncmp ax, VC\njz @@_0\ncall Beep\nret\n@@_0:\npush ax\npush cx\npush es</p>\n<p>; -----------------------------------------------------------------\nlodsw ; DPB\nmov di, ax\nlodsw\nmov es, ax\n@@1: lodsb\ninc di\nstosb\nadd di, cs:cvtOfs\nadd di, 10h\nmovsw\nmovsw\nles di, es:[di+2]\ncmp di, -1\njnz @@1</p>\n<p>; -----------------------------------------------------------------\nlodsw ; DCB\nmov di, ax\nlodsw\nmov es, ax\nxor ax, ax\ndec ax\nstosw</p>\n<p>; -----------------------------------------------------------------\nlodsw ; Device Driver Chain\nmov di, ax\nlodsw\nmov es, ax\nxor cx, cx\n@@9: push di\nmov cl, 5\nrep movsw\npop di\nles di, es:[di]\nmov ax, di\ninc ax\njnz @@9\npop es\npop cx\npop ax\nret</p>\n<p>; ----------------------------------------------------------------------------\nRestoreMemoryManager:\ntest cs:Status, XMSbit\njz @@1\ncall LoadXMSstatus\n@@1:\ntest cs:Status, EMSbit\njz @@2\ncall LoadEMSstatus\n@@2:\nret</p>\n<p>LoadEMSstatus:\nlodsw\ncmp ax, ME\njz @@_0\ncall Beep\nret\n@@_0:\nlodsw\nmov cx, ax\nxor dx, dx\n@@_1: push ds\npush si\npush dx\npush cx</p>\n<p>@@0: cmp dx, ds:[si]\njz @@1\nadd si, 4\nloop @@0</p>\n<p>push cx\nmov cx, 5\n@@0: mov ah, 45h ; Deallocate Handle and Memory\nint 67h\nor ah, ah\njz @@1\nloop @@0\n@@1: pop cx</p>\n<p>@@1:\npop cx\npop dx\npop si\npop ds\ninc dx\ncmp dx, 100h\njb @@_1\nshl cx, 1\nshl cx, 1\nadd si, cx\nret</p>\n<p>LoadXMSstatus:\nlodsw\ncmp ax, MX\njz @@_0\ncall Beep\nret\n@@_0:\nlodsw\nmov cx, ax\njcxz @@5\n@@1:\nlodsw\nmov dx, ax\n@@2: push dx\nmov ah, 0ah ; free\ncall dword ptr cs:xms_control\nor ax, ax\npop dx\njnz @@4 cmp bl, 0abh\njnz @@4\npush dx\nmov ah, 0dh ; unlock\ncall dword ptr cs:xms_control\nor ax, ax\npop dx\njmp @@2\n@@4: loop @@1\n@@5: ret\nendp</p>\n<p>; -----------------------------------------------------------------------\nCloseSpeaker:\nin al, 61h\nand al, 0fch\nout 61h, al\nret</p>\n<p>; -----------------------------------------------------------------------\nRestoreClockSpeed:\nmov al, 00110110b\nout 43h, al\nxor ax, ax\nout 40h, al\nout 40h, al\nret</p>\n<p>; -----------------------------------------------------------------------\nResetDisk:\nxor ax, ax\nxor dx, dx\nint 13h ; Restore A\ninc dx\nint 13h ; Restore B\nmov dl, 80h\nint 13h ; Restore C\nret</p>\n<p>; --------------------------------------------------------------------------\nClosePRN:\nmov ah, 51h ; Get PSP seg\nint 21h\nmov es, bx\nmov ax, es:[16h] ; Prev PSP seg\ncmp ax, bx\njnz @@9\nmov ax, 3e00h ; COMMAND\nmov bx, 4 int 21h\n@@9:\nret</p>\n<p>InitPRN:\nmov ax, 3e00h\nmov bx, 4 ; PRN\nint 21h\nmov ax, 3d01h\nmov dx, offset PRNname\npush cs\npop ds\nint 21h\nret\nPRNname db PRN,0</p>\n<p>InitMouse: ; 2/16/1993 by Mr. Lei\npush es\nxor ax, ax\nmov es, ax\ncmp word ptr es:[33h4+2], 0\njz @@0 cmp word ptr es:[33h4], 0\njz @@0\nmov ax, 21h\nint 33h ; Hook Mouse Interrupt\n@@0: pop es\nret</p>\n<p>; ------------- CMOS CLOCK set to System -----------------------------------\nUpdateTime:\ncall GetRealTime\nmov ah, 2dh\nint 21h\nret</p>\n<p>GetRealTime:\nmov ah,2 int 1Ah\nmov al,ch\ncall bcdxchg\nmov ch,al\nmov al,cl\ncall bcdxchg\nmov cl,al\nmov al,dh\ncall bcdxchg\nmov dh,al\nmov dl,0\nret</p>\n<p>BCDxchg:\npush ax\npush cx\nmov cl,4\nshr al,cl\npop cx\nmov bl,0Ah\nmul bl\npop bx\nand bl,0Fh\nadd al,bl\nret</p>\n<p>; -----------------------------------------------------------------------\n; Display string\nColorPrintStr:\nlodsb\nmov bh, al ; color\nxor cx, cx\nmov dx, 014fh\nmov ax, 0600h\nint 10h</p>\n<p>mov ah, 02 ; GotoXY (0, 0)\nxor dx, dx\nmov bh, 0 int 10h\nPrintStr:\npush cs\npop ds\nxor bx, bx\n@@1: lodsb\ncmp al, $\njz @@2\nor al, al\njz @@2\nmov ah, 0eh\nint 10h\njmp short @@1\n@@2: mov al, cs:clsStrcolor\nmov cs:clsStr, al\nret</p>\n<p>; -----------------------------------------------------------------------\nSelf dw 0\nclsStrcolor db 17h\nclsStr db 17h ; Color (White in Blue)\ndb  RAMinit Version 2.12 (c) 1989-1994 by KingSoft Ltd. Mr. Leijun\ndb 0dh,0ah\ndb  [\nShowCopies db\ndb ] Activate...,0ah,0dh,$</p>\n<p>endTSR equ $\nmcbList equ offset endTSR + 2 + 2\nvecList equ mcbList + 710 + 2 + 10h + 1 + 400h\ndevLink equ vecList + 4 + 5  26 + 4 + 10  30h + 4\nxmsList equ devLink + 2 + MaxHandles  2\nemsList equ xmsList + 4 + 1024\ncrtMode equ emsList + 2 + 1Dh + 4 + 10h\ntsrLen equ crtMode + 1\n;\n; DOS Environment Reserved by RI\n; --------------------------------------------------\n; Flag XX 2 bytes\n; Environment Segment 1 word\n; Free MCBs &#x3C;=710 bytes\n; MCB segment 1 word\n; MCB 5 bytes\n; End flag MM 1 word\n; COM LPT ports 10h bytes\n; LEDs status 1 bytes\n; Packed vectors list &#x3C;=400h bytes\n; Flag CV 2 bytes\n; CVT First DPB pointer 4 bytes\n; DPBs data &#x3C;=526 bytes\n; First DCB pointer 4 bytes\n; Pointer to NUL 4 bytes\n; All device driver datas &#x3C;=30h10 bytes\n; Flag XM 2 bytes\n; XMS free handle counter 2 bytes\n; EMS free handle list &#x3C;=100h4 bytes\n; Flag EM 2 bytes\n; EMS free handle counter 2 bytes\n; EMS free handle list &#x3C;=1024 bytes\n; EMS handle 1 word\n; Number of pages 1 word\n; Flag -- 1 word\n; Equipment List 1 word\n; CRT 40:49h-66h 1dh bytes\n; 40:A8h 1 dword\n; BIOS User Data Area 40:F0--FF 10h bytes\n; **\n;\nmain: jmp main0</p>\n<p>Print Macro Str\nLea dx, Str\ncall DisplayStr\nendm</p>\n<p>InstMsg db RAMinit Version 2.12\ndb Copyright (c) 1989-1994 by KingSoft Ltd. ,0dh,0ah,$\nMsg0 db Already installed !,0dh,0ah,0ah\ndb For Help, type RI /?. ,0dh,0ah,$\nMsg_0 db 0ah,Residents a new RAMinit copy [y/n] ? $\nMsg_2 db OK, RI No.\nMsg_RI db 2\ndb  residents successful !, 0dh,0ah,$\nMsg1 db Activate with: $\nKeyMsg db Right_Shift$\ndb Left_Shift$\nKMsg1 db Left_Ctrl$\ndb Left_Alt$\ndb Right_Ctrl$\ndb Right_Alt$\nKMsg2 db Ctrl$\ndb Alt$\ndb Ctrl$\ndb Alt$\nPlusMsg db  + $\ncrlf db 0dh,0ah,$</p>\n<p>HelpMsg db Programmed by Mr. Leijun Dec 1992, 0dh,0ah,0ah\ndb Usage: RI [options],0dh,0ah,0ah\ndb /H,/? Display this screen,0dh,0ah\ndb /CLS Removes all TSR programs after current RI,0dh,0ah\ndb /RET Removes TSR programs include current RI,0dh,0ah\ndb /NEW Residents a new data copy of current environment,0dh,0ah\ndb /ALL Removes all RI copies and all other tsr programs,0dh,0ah\ndb /Sxyy.. Define Hotkey x=AuxHotkey yy..=shift status,0dh,0ah\ndb  x=auxiliary hotkey (default is X) ,0dh,0ah\ndb  x equ 1 means need AuxHotkey,0dh,0ah\ndb  yy..=shift status [CAScas],0dh,0ah\ndb  C: Left Ctrl A: Left Alt S: Left Shift,0dh,0ah\ndb  c: Right Ctrl a: Right Alt s: Right Shift,0dh,0ah,0ah\ndb Example: RI /S1c means Hotkey is Right_Ctrl+X,0dh,0ah\ndb  RI /S0Cc means HotKey is Left_Ctrl+Right_Ctrl,0dh,0ah\ndb  RI /CLS equals simply press hotkey,0dh,0ah\ndb  RI /RET Removes all TSRs after current RI and this RI,0dh,0ah\ndb 0ah\ndb Contact me for RAMinit problems: (01)2561155 Call 1997,0dh,0ah\ndb $\nErrMsg db ERROR: Invalid options !,0dh,0ah,0ah,$\nWinErr db 7, Sorry, I cannot work in Windows DOS environment.,0dh,0ah,$\nSetMsg db 7, Defines new Hotkey successful !,0dh,0ah,0ah,$\ntsrOK db False</p>\n<p>Main0:\ncld\nPrint instMsg\ncall IsWinDos\nor ax, ax\njz @@1\nPrint WinErr\nmov ax, 4c00h\nint 21h\n@@1:\ncall HotKeyValid\nmov cs:Status, 0\ncall EMS_test\ncall CmpDosVer\ncall CmpSideKick\ncall GetMachineID\ncall ModifyHotKeyPrompt</p>\n<p>mov ax, 0c0d7h\nint 2fh\nmov es, ax\ncmp word ptr es:[101h], IE ; LEI\njnz @@0\nmov cs:Self, ax\n@@0:\ncall CmdLine\ncall PrintHotKeyPrompt</p>\n<p>cmp cs:tsrOK, true\njz @@2\ncall tsrReplyOK\n@@2: cmp cs:tsrOK, true\njnz @@_2\ncall PrintCopies\n@@_2:\nmov word ptr cs:[100h], EL\nmov byte ptr cs:[102h], I</p>\n<p>push cs\npop es\npush cs\npop ds\nstd\nmov si, offset eof\nmov cx, eof - offset Here\nmov di, tsrLen\nadd di, cx\ninc cx\nrep movsb\ncld\nmov bx, tsrLen\njmp bx</p>\n<p>Here:\nmov ax,cs\nmov es,ax\nmov di,offset endTSR\nmov cs:DataBegin, di\nmov cs:NextDataSeg, -1\nmov ax, XX\nstosw\nin al, 0a1h\nmov ah, al\nin al, 21h\npush ax\nmov word ptr cs:old_8259, ax\nxor ax, ax\nout 21h,al ; CLI\ncall SaveOthers\ncall SetSelfInt\ncall BackupVecList\ncmp cs:Power, true\njnz @@20\ncall BackupCVTchain\ncall BackupMemoryManager\n@@20:\ncall BackupBiosData</p>\n<p>sti\nmov cs:Flag,   ; no busy\nmov cs:StopFlag, 0 ;</p>\n<p>mov cs:tsrLength, di\ncall SetDosEnvSeg\ncmp cs:Self, 0\njz @@29\npush cs\npop ds\npush cs\npop es\ncld\nmov cx, cs:tsrLength\nmov si, cs:DataBegin\nsub cx, si\nmov di, 120h\nmov cs:DataBegin, di\nrep movsb\nmov cs:tsrLength, di\n@@29:\npop ax\nout 21h, al ; STI\nmov al, ah\nout 0a1h, al\nmov dx, cs:tsrLength\ninc dx\nint 27h</p>\n<p>; ----------------------------------------------------------------------------\nSetDosEnvSeg:\npush ds\npush es\nmov ax, cs\n@@10: mov es, ax\nmov ax, es:[16h] ; Get father process psp segment\nor ax, ax\njz @@11\nmov bx, es\ncmp ax, bx\njnz @@10\n@@11:\nmov es, word ptr es:[2ch] ; Get father process env segment\nmov cs:DosEnv, es\npop es\npop ds\nret</p>\n<p>; ----------------------------------------------------------------------------</p>\n<p>SaveOthers:\nmov ax, cs:[2ch] ; Env Seg\nstosw\ncall backupMCB ; Current MCB\nmov ax, 40h ; COM LPT Port\nmov ds, ax\nmov si, 0h\nmov cx, 8\nrep movsw</p>\n<p>mov si, 17h ; LED status\nlodsb\nstosb\n; call OpenLEDs\nret</p>\n<p>; --------------------------------------------------------------------------\nbackupMCB:\nmov ax, ZM\nstosw\npush ds\npush es\nmov ah, 52h\nint 21h ; Get MCB chain head\nmov ax, es:[bx-2]\npop es\n@@0: mov ds, ax\ncmp byte ptr ds:[0], Z ; End ?\njz @@20 cmp byte ptr ds:[0], M ; Memory control block\njnz @@30 cmp word ptr ds:[3], 0 ; Nul mcb\njz @@10 cmp word ptr ds:[1], 0 ; Free MCB\njnz @@10\ncall SaveFreeMCB\n@@10: inc ax\nadd ax, ds:[3]\njmp @@0\n@@20:\ncall SaveFreeMCB\ncmp ax, 0a000h\ninc ax\njnb @@30\nmov ax, 9fffh ; MS-DOS UMB\njmp @@0</p>\n<p>@@30:\ncmp ax, 0c000h ; 386MAX\nja @@90\nmov ax, 0c020h\njmp @@0</p>\n<p>@@90: ; Error ?\npop ds\nmov ax, MM ; Set MCB flag\nstosw\nret</p>\n<p>SaveFreeMCB:\nstosw\nxor si,si\nmovsb\nmovsw\nmovsw\nret\n;\n; push ax\n; stosw\n; xor si,si\n; movsb\n; movsw\n; movsw\n; pop ax\n; cmp ax, 09fffh\n; jnb @@3\n; push ax\n; push ds\n; mov ds,ax\n; cmp byte ptr ds:[0], M\n; pop ds\n; pop ax\n; jnz @@4\n; mov ax, 09fffh ; MS-DOS UMB\n; jmp @@0\n; @@4: cmp ax, 0c000h\n; ja @@3\n; mov ax, 0c020h ; 386MAX\n; jmp @@0\n;\n; --------------------------------------------------------------------------</p>\n<p>OpenLEDs: push ax ; Open all LEDs\nor al, 070h\nmov ds:[17h], al\nmov ah, 1 int 16h\nmov cx, 4 ; Delay\n@@20: push cx\nxor cx, cx\n@@21: loop @@21\npop cx\nloop @@20\npop ax\nmov ds:[17h], al\nmov ah, 1 int 16h\nret</p>\n<p>; --------------------------------------------------------------------------\nSetSelfInt:\npush es\npush di</p>\n<p>cmp cs:self, 0\njnz @@1\npush cs\npop ds\nmov ax,3509h\nint 21h\nmov word ptr cs:oldInt9_addr,bx\nmov word ptr cs:oldInt9_addr[2],es\nmov dx,offset NewInt9\nmov ax,2509h\nint 21h</p>\n<p>mov ax,352Fh\nint 21h\nmov word ptr cs:oldInt2F_addr,bx\nmov word ptr cs:oldInt2F_addr[2],es\nmov dx,offset newInt2F\nmov ax,252Fh\nint 21h</p>\n<p>mov ax,351Ch\nint 21h\nmov word ptr cs:oldInt1C_addr,bx\nmov word ptr cs:oldInt1C_addr[2],es\nmov dx,offset newInt1C\nmov ax,251ch\nint 21h\ncli\njmp @@2\n@@1:\nmov es, cs:Self\ninc es:Copies\n@@_0: cmp es:NextDataSeg, -1\njz @@_1\nmov es, es:NextDataSeg\njmp @@_0\n@@_1: mov es:NextDataSeg, cs\n@@2:\npop di\npop es\nret</p>\n<p>; -----------------------------------------------------------------------\nSaveCounter:\nmov word ptr es:[di], EL\nmov byte ptr es:[di+2], I\nmov byte ptr es:[di+3], bl\nxor bx, bx\nadd di, 4\nret</p>\n<p>; -----------------------------------------------------------------------\nDisplayStr: push cs\npop ds\nmov ah, 9 int 21h\nret</p>\n<p>; -----------------------------------------------------------------------\nCmdLine:\npush cs\npop ds\nxor ax, ax\nmov si, 80h\nlodsb\nor al, al\njnz @@1\nret\n@@1:\nmov cx, ax\ndec ax\npush ax\npush si\n@@0: lodsb\ncmp al,<br>\njz @@0 cmp al, /\njnz @@2\nlodsb\ncmp al, S\njz @@_2\ncmp al, s\njnz @@2\n@@_2:\ncall SetHotKey\nPrint SetMsg\nmov ax, 4c00h\nint 21h\n@@2:\npop si\npop ax\npush ax\npush si\n@@_3: lodsb\ncmp al, A\njb @@3 cmp al, Z\nja @@3\nadd byte ptr ds:[si-1],20h ; DownCase\n@@3: loop @@_3\npop si\npop cx</p>\n<p>add si, cx\nlodsb\ncmp al, s ; CLS\njnz @@5 cmp word ptr ds:[si-3], lc\njnz @@5 cmp cs:Self, 0\njz @Err\nmov ax, 0c0d7h+1 int 2fh</p>\n<p>@@5: cmp al, h ; HELP\njz @help\ncmp al, ?\njz @help\ncmp al, t ; RET\njnz @@6 cmp word ptr ds:[si-3], er\njnz @@6\n@@7:\ncmp cs:Self, 0\njz @Err\nmov ax, 0c0d7h+2 int 2fh\n@@6: cmp al, w ; NEW\njnz @@8 cmp word ptr ds:[si-3], en\njnz @@8\nmov cs:tsrOK, true\nret\n@@8:\ncmp al, l ; ALL\njnz @@9 cmp word ptr ds:[si-3], la\njnz @@9\nmov ax, 0c0d7h+3 int 2fh\n@@9:\ncmp al,<br>\njnz @Err\nret</p>\n<p>@Err:\nPrint ErrMsg\n@help:\nPrint HelpMsg\nmov ax, 4c00h\nint 21h</p>\n<p>;---------------------------------------------------------------------------\ntsrReplyOK:\ncmp cs:Self, 0\njz @@1\nPrint Msg0</p>\n<p>push es\nmov ax, cs:Self\n@@_10: mov es, ax\nmov ax, es:NextDataSeg\ncmp ax, -1\njnz @@_10\nmov ax, es</p>\n<p>@@_0: push ax\ndec ax\nmov es, ax\nmov bx, es:[3]\npop ax</p>\n<p>add ax, bx\ninc ax\nmov es, ax\ncmp word ptr es:[0], OC\njz @@_0</p>\n<p>mov bx, cs\ncmp ax, bx\npop es\njz @@2\nPrint Msg_0\nmov ah, 1 int 21h</p>\n<p>push ax\nPrint crlf\npop ax</p>\n<p>cmp al, y\njz @@3 cmp al, Y\njz @@3\n@@2: ; Print Msg_1\nmov ax, 4c01h\nint 21h\n@@3:\n@@1: mov cs:tsrOK, true\nret</p>\n<p>PrintCopies:\ncmp cs:Self, 0\njz @@1\npush es ; Added -by- Mr. Lei\nmov es, cs:Self ; Aug 24, 1993\nmov al, es:Copies\ninc al ; Total RI copies\npush ax ; Set es = current mcb\nmov ax, cs\ndec ax\nmov es, ax\npop ax\nmov cx, 5 ; Search end of file name\nmov bx, 8\n@@10: inc bx\ncmp byte ptr es:[bx], 20h\njz @@20 cmp byte ptr es:[bx], 0ffh\njz @@20 cmp byte ptr es:[bx], 00h\njz @@20\nloop @@10\n@@20: ; Set current RI no\nmov byte ptr es:[bx], : ; RI:2\nmov byte ptr es:[bx+1], al\ncmp bx, 8+7\njnb @@30\nmov byte ptr es:[bx+2], 0\n@@30:\npop es</p>\n<p>mov cs:Msg_RI, al\nPrint Msg_2\n@@1: ret</p>\n<p>;---------------------------------------------------------------------------\n; Backup Interrupt Vector List\n;\nBackupVecList:\npush ds\npush cs\npop es\nxor si,si ; Vectors\nmov ds,si\nmovsw\nmovsw\nxor bx, bx\nmov cx,00ffh\n@@0: lodsw\nxchg dx, ax\nlodsw\ncmp ax, es:[di-2]\njnz @@1 cmp dx, es:[di-4]\njz @@2\n@@1: or bx, bx\njz @@3\ncall SaveCounter\n@@3: xchg dx, ax\nstosw\nxchg dx, ax\nstosw\nloop @@0\njmp @@4\n@@2: inc bx\nloop @@0\ncall SaveCounter\n@@4:\npop ds\nret\n;\n;-----------------------------------------------------------------------------\nBackupCVTchain:\nmov ax, VC\nstosw\npush ax\npush bx\npush cx\npush ds\npush es\nmov ah, 52h\nint 21h ; ES:BX -- DOS table as described below</p>\n<p>; --------------------------------------------------------------------\npush es ; DPB chains\npush bx\nlds si, es:[bx]\npush cs\npop es\nmov ax, si\nstosw\nmov ax, ds\nstosw\nmov bx, cs:cvtOfs\nxor cx, cx\n@@1: mov al, ds:[si+1]\nstosb\nmov ax, ds:[si+bx+12h]\nstosw\nmov ax, ds:[si+bx+14h]\nstosw\ninc cx\nlds si, ds:[si+bx+18h]\ncmp si, -1\njnz @@1\n; mov ax, 5\n; mul cl\n; add ax, 4\n; add cs:tsrLength, ax\npop bx\npop es</p>\n<p>; --------------------------------------------------------------------\npush es ; DCB file control blocks\npush bx\nles bx, es:[bx+4]\n@@11: cmp word ptr es:[bx], -1\njz @@10\nles bx, es:[bx]\njmp @@11\n@@10:\nmov ax, es\nxchg ax, bx\npush cs\npop es\nstosw\nxchg ax, bx\nstosw\npop bx\npop es\n; add cs:tsrLength, 4</p>\n<p>; ---------------------------------------------------------------------\npush es ; Device Driver Chains\npop ds\nadd bx, 22h\nmov si, bx ; NUL</p>\n<p>pop es\nmov ax, si\nstosw\nmov ax, ds\nstosw\nxor cx, cx\nxor bx, bx\n@@9: push si\nmov cl, 5\nrep movsw\ninc bx\npop si\nlds si, ds:[si]\nmov ax, si\ninc ax\njnz @@9</p>\n<p>pop ds\npop cx\npop bx\npop ax\nret</p>\n<p>; ----------------------------------------------------------------------------</p>\n<p>BackupBiosData:\nmov ax, --\nstosw\npush ds\npush si\nmov si, 40h\nmov ds, si\nmov si, 10h\nmovsw\nmov si, 0a8h\nmovsw\nmovsw\nmov si, 49h\nmov cx, 1dh\nrep movsb</p>\n<p>mov si, 0f0h\nmov cx, 8\nrep movsw\npop si\npop ds\nret</p>\n<p>; ---------------------------------------------------------------------------</p>\n<p>BackupMemoryManager:\npush cs\npop es\npush ds\npush es\ncall SaveXMSstatus\ncall SaveEMSstatus\npop es\npop ds\nret</p>\n<p>;---------------------------------------------------------------------</p>\n<p>SaveEMSstatus:\ntest cs:status, EMSbit\njnz @@1\nret\n@@1:\nmov ax, ME\nstosw\ninc di\ninc di\npush di\nmov ah, 4dh\nint 67h\npop di\nmov es:[di-2], bx\nshl bx, 1\nshl bx, 1\nadd di, bx\nret\n; -------------------------------------------------------------------</p>\n<p>SaveXMSstatus:\ncall XMS_test\ntest cs:status, XMSbit\njnz @@1\nret\n@@1:\nmov ax, MX\nstosw</p>\n<p>mov dx, 1\ncall XMS_alloc\njnz @@_1\nxor cx, cx ; XMS alloc failure\nstosw\nret\n@@_1:\npush dx\nsub dx, MaxHandles  10\n@@2:\npush dx\ncall XMS_Lock\npop dx\njnz @@3 cmp bl, 0a2h\njnz @@4\nadd dx, 10\njmp @@2\n@@3: push dx\ncall XMS_unlock\npop dx\n@@4:\nmov cs:handle_begin, dx\npop dx\npush dx\ncall XMS_bstat\nxor cx, cx\nmov cl, bl\ninc cx\npop dx\ncall XMS_Free\nmov dx, cs:Handle_begin</p>\n<p>push cx\npush cs\npop es\nmov ax, cx\nstosw\n@@5: push dx\ncall XMS_Lock\npop dx\njnz @@6 cmp bl, 0a2h ; Handle invalid\njz @@7\n@@6: call XMS_unlock\nadd dx, 10\njmp @@5\n@@7: mov ax, dx\nstosw\nadd dx, 10\nloop @@5\npop cx\nret\n; ------------------------------------------------------------------</p>\n<p>XMS_test:\npush es\nmov ax, 4300h\nint 2fh\ncmp al, 80h\njnz @@9\nmov ax, 4310h\nint 2fh\nmov cs:XMS_control, bx\nmov cs:XMS_control[2], es\nor cs:Status, XMSbit\n@@9:\npop es\nret</p>\n<p>XMS_stat:\nmov ah, 0\ncall dword ptr cs:xms_control\nmov hma_exist, dl\nret\nhma_exist db 0</p>\n<p>XMS_alloc:\nmov ah, 9\ncall dword ptr cs:xms_control\nor ax, ax\nret</p>\n<p>XMS_lock:\nmov ah, 0ch\ncall dword ptr cs:xms_control\nor ax, ax\nret</p>\n<p>XMS_unlock:\nmov ah, 0dh\ncall dword ptr cs:xms_control\nor ax, ax\nret\nXMS_bstat:\nmov ah, 0eh\ncall dword ptr cs:xms_control\nor ax, ax\nret</p>\n<p>XMS_free:\nmov ah, 0ah\ncall dword ptr cs:xms_control\nor ax, ax\nret</p>\n<p>; ----------------------------------------------------------------------------\nEMS_test:\npush cs\npop ds\nmov dx, offset EMMname\nmov ax, 3d00h\nint 21h\njc @@2\nmov bx, ax\nmov ah, 3eh\nint 21h\nor cs:Status, EMSbit\n@@2:\nret\nEMMname db EMMXXXX0,0</p>\n<p>; -----------------------------------------------------------------------------</p>\n<p>SetHotKey:\nxor bx, bx\nlodsb\npush ax</p>\n<p>@@1: lodsb\ncmp al, 0dh\njz @@9 cmp al, C\njnz @@2\nor bl, LeftCtrl\njmp @@1\n@@2:\ncmp al, c\njnz @@3\nor bl, RightCtrl\njmp @@1\n@@3:\ncmp al, A\njnz @@4\nor bl, LeftAlt\njmp @@1\n@@4:\ncmp al, a\njnz @@5\nor bl, RightAlt\njmp @@1\n@@5:\ncmp al, S\njnz @@6\nor bl, LeftShift\njmp @@1\n@@6:\ncmp al, s\njnz @@7\nor bl, RightShift\njmp @@1\n@@7: pop ax\njmp @Err\n@@9:\nmov cs:HotKey, bl\npop ax\nmov cs:AuxHotKey, 2dh ; X scan key\ncmp al, 1\njz @@29\nmov cs:AuxHotKey, 0\n@@29:\ncmp cs:Self, 0\njz @@30\npush es\nmov es, cs:Self\nmov es:HotKey, bl\nmov bl, cs:AuxHotKey\nmov es:AuxHotKey, bl\npop es\n@@30:\ncall GetRunFileName\nmov ax, 3d02h\nint 21h\njc @@10\npush cs\npop ds\nmov bx, ax\nmov cx, 4\nmov dx, 100h\nmov ah, 40h\nint 21h\njc @@10\nmov ax, 4200h\nxor cx, cx\nmov dx, 17h\nint 21h\njc @@10\nmov cx, 1\nmov dx, offset AuxHotKey\nmov ah, 40h\nint 21h\njc @@10\nmov ah, 3eh\nint 21h\n@@10:\nret</p>\n<p>; -----------------------------------------------------------------------\nGetRunFileName:\n; Return:\n; DS:DX Pointer of this run file name ASCIIZ string\npush ax\npush bx\npush cx\npush si\npush di\npush es</p>\n<p>push cs\npop es\nmov ax, es:[2ch]\nmov es, ax\nxor di, di\nmov cx, 1000h\nxor al, al\n@@1: repnz scasb\ncmp es:[di], al\nloopnz @@1\nmov dx, di\nadd dx, 3\npush es\npop ds</p>\n<p>pop es\npop di\npop si\npop cx\npop bx\npop ax\nret</p>\n<p>; ---------------------------------------------------------------------------\nGetMachineID:\npush es\nmov KBD102,True\nmov ax,40h\nmov es,ax\ntest byte ptr es:[96h], 00010000b\njnz @@1\nmov Kbd102,False\n@@1:\nxor ax,ax\ndec ax\nmov es,ax\nmov al,es:[0eh]\nmov cs:MachineID, al\npop es\nret</p>\n<p>; ---------------------------------------------------------------------------\nModifyHotKeyPrompt:\ncmp cs:Kbd102, True\njz @@9\npush cs\npop es\npush cs\npop ds\nmov cx, 124\nmov si, offset KMsg2\nmov di, offset KMsg1\nrep movsb\n@@9: cmp cs:MachineID, 0fch\njna @@10\nmov cs:clsStrcolor, 70h ; Mono\nmov cs:clsStr, 70h\n@@10:\nret</p>\n<p>; ---------------------------------------------------------------------------\nPrintHotKeyPrompt:\nPrint Msg1\nmov al, cs:HotKey\nmov ah, al\nshr al, 1\nshr al, 1\nand ax, 33ch\nor al, ah\nmov dx, offset KeyMsg\n@@40:\nor ax, ax ; Mr. Lei 4/25/1993\njz @@_42\nshr al, 1\npush ax\njnc @@41</p>\n<p>push ax\ncall ColorDisplayStr\n; mov ah, 9\n; int 21h\npop ax</p>\n<p>or al, al\njz @@42</p>\n<p>push dx\nmov dx, offset PlusMsg\ncall ColorDisplayStr\n; Print PlusMsg\npop dx</p>\n<p>@@41: add dx, 12\npop ax\njmp @@40\n@@42: pop ax\n@@_42: cmp cs:AuxHotKey, 0\njz @@43 cmp cs:HotKey, 0 ; Mr. Lei\njz @@_43\nmov dx, offset PlusMsg\ncall ColorDisplayStr\n; Print PlusMsg\n@@_43: mov dx, offset AuxHotKeyName\ncall ColorDisplayStr\n; Print AuxHotKeyName\n@@43:\nPrint crlf\nret</p>\n<p>ColorDisplayStr:\npush bx\npush cx\npush dx\npush si\nmov bl, 0fh\nmov si, dx\nxor bh, bh\nmov cx, 1\n@@1: lodsb\ncmp al, $\njz @@2\nor al, al\njz @@2\npush cx\nmov ah, 09h\nint 10h\nmov ah, 3 int 10h\ninc dl\nmov ah, 2 int 10h\npop cx\njmp short @@1\n@@2:\npop si\npop dx\npop cx\npop bx\nret</p>\n<p>; ---------------------------------------------------------------------------\nCmpSideKick:\nxor ax, ax\nmov es, ax\nles bx, es:[20h]\ncmp word ptr es:[bx-4], 4b53h\njnz @@1 cmp word ptr es:[bx-2], 4942h\njz @@2\n@@1: mov es, ax\nles bx, es:[94h]\ncmp word ptr es:[bx-2], 4b53h\njz @@2\nret\n@@2: or cs:Status, SKbit\nret</p>\n<p>; ---------------------------------------------------------------------------\nCmpDosVer: mov ah, 30h\nint 21h\ncmp al, 3\njb @@1 cmp al, 3\njna @@2\nmov cs:cvtOfs, 1\nret\n@@2: mov cs:cvtOfs, 0\nret\n@@1: Print DosVerErr\nmov ax, 4cffh\nint 21h</p>\n<p>DosVerErr db Sorry, DOS version too lower !,0dh,0ah,$</p>\n<p>HotKeyValid:\ncmp cs:HotKey, 0\njnz @@_1\ncmp cs:AuxHotKey, 0\njnz @@_1\nPrint HotKeyErr\nmov ax, 4cfeh\nint 21h\n@@_1: ret</p>\n<p>HotKeyErr db Sorry, please setup hotkey again. ,0dh,0ah,$</p>\n<p>eof:\nends\nend Start</p>\n<p>; ------------- The End ! ---------------------------------------------------</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}