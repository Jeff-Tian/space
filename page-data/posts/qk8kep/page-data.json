{"componentChunkName":"component---src-templates-post-js","path":"/posts/qk8kep/","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/qk8kep","relativePath":"posts/qk8kep","frontmatter":{"title":"webview 复用微信小程序获取用户信息的解决方案","stackbit_url_path":"posts/qk8kep","date":"2021-12-16T12:07:32","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p><a name=y8N9x></a></p>\n<h1>简介</h1>\n<p>详细讨论如何通过迭代演进，最终实现一个以微信小程序作为认证媒介的 OAuth 2 验证流程，在保证安全的前提下，为网页提供获取系统用户信息的能力。</p>\n<p>本文最终探讨了如何将微信小程序作为系统的 OAuth 认证媒介，而不是讲述如何在微信小程序中对接微信登录。\n<a name=zXNeV></a></p>\n<h1>前提</h1>\n<p>整篇讨论都限于通过企业认证的微信小程序，个人版的微信小程序不适用！</p>\n<p>企业的微信小程序和微信的对接已经完成。\n<a name=ykEWo></a></p>\n<h1>背景</h1>\n<p>企业基于微信小程序开发了完整的登录注册、用户档案等功能。随后，企业的运营方不断地在营销活动中复用微信小程序的登录注册和用户信息获取的能力，这种营销活动页面，通常外包给第三方开发，以 webview 的形式嵌入在微信小程序中，本质上是一个 html 网页。\n<a name=RZhtq></a></p>\n<h1>复用价值</h1>\n<p><a name=YjNk9></a></p>\n<h2>节省开发成本</h2>\n<p>这种活动页面成百上千，由不同的外包服务商独立开发，每次都要独立开发登录注册的话，成本太大。从 DRY 原则上说，这些活动页面只需要关注每次活动的具体变化的内容即可（通常是一个不同的网页小游戏）。\n<a name=QGgJs></a></p>\n<h2>提升用户体验</h2>\n<p>登录注册时，要求用户提供手机号，这十分普遍。但是，在网页中实现这个功能，一般都是通过用户填写手机号，接收验证码，再填入验证码由服务器验证。这个过程比较耗时，需要用户的多次输入。相反，微信小程序可以利用微信的能力，只需要用户点击一次授权按钮，即可获得手机号。</p>\n<p>通过重用微信小程序的用户登录注册功能，用户感受更方便快捷。</p>\n<p><a name=COiti></a></p>\n<h1>需求分析</h1>\n<p>这些活动页面，最终需要的用户信息，多数情况下，只有一个，那就是用户在系统中的唯一标识。这样，在随后的互动中，就可以区分不同的用户来。比如，在游戏互动中，用户中奖了，就需要记录是谁中了什么奖。因为这些互动方式都是第三方开发的，由他们来存储这些中奖信息很自然。但最终要关联到内部系统的用户，就需要这个用户身份标识。</p>\n<p>所以，终极问题是，<strong>微信小程序的 webview 里的网页，如何获取到微信小程序的用户唯一身份标识？</strong></p>\n<p><a name=W4F97></a></p>\n<h1>方案零（客户端明文传输用户身份标识，可以立即否决）</h1>\n<p>在 webview 里的互动进行到某个时机，网页调起微信小程序的登录注册功能，用户完成登录注册之后，微信小程序通过 url 回调网页，在 query string 中，带上 userId。\n<a name=y74ER></a></p>\n<h2>安全性</h2>\n<p>不安全！\n<a name=woTbI></a></p>\n<h2>开发周期</h2>\n<p>最短\n<a name=Q4oXs></a></p>\n<h2>修改范围</h2>\n<ul>\n<li>微信小程序客户端，回调网页 url 功能</li>\n<li>网页端，接收回调并读取 userId 参数的功能</li>\n</ul>\n<p><a name=XjMhE></a></p>\n<h2>解决了什么？</h2>\n<p>webview 中的网页获取不到 userId 的问题\n<a name=r5Qqa></a></p>\n<h2>不能解决什么？</h2>\n<p>没有安全性可言。如果通过伪造 userId 直接调用网页的 url，在该网页的域中，用户身份信息就被伪造了。\n<a name=ERT4V></a></p>\n<h2>补救措施</h2>\n<p>一旦发现这种行为，网页端能做的是改版，不展示任何用户信息；但是数据库里存放的错误映射关系，没有办法恢复了，不能再被使用。\n<a name=I5zi6></a></p>\n<h2>流程</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/__puml/257ec4a6b36b6892eafbbd7fdb745e29.svg#lake_card_v2=eyJ0eXBlIjoicHVtbCIsImNvZGUiOiJAc3RhcnR1bWxcblxuYXV0b251bWJlclxuXG5hY3RvciBcIueUqOaIt1wiIGFzIFVzZXJcbnBhcnRpY2lwYW50IFwid2Vidmlld1wiIGFzIHdlYnZpZXdcbnBhcnRpY2lwYW50IFwi5b6u5L-h5bCP56iL5bqPXCIgYXMgd21wXG5cbmFjdGl2YXRlIFVzZXJcblxuVXNlciAtPiB3bXA6IOi_m-WFpea0u-WKqOmhtemdolxuXG53bXAgLT4gd2Vidmlldzog5Yqg6L295rS75Yqo572R6aG1IHVybFxuYWN0aXZhdGUgd2Vidmlld1xuXG53ZWJ2aWV3IC0-IHdlYnZpZXcgOiDkupLliqhcblxud2VidmlldyAtPiB3bXA6IOinpuWPkeeZu-W9leazqOWGjO-8iOS4reWlluS6hu-8ge-8iVxuXG53bXAgLT4gd21wIDog5a6M5oiQ55m75b2V5rOo5YaMXG5cbndtcCAtPiB3ZWJ2aWV3OiDlm57osIPnvZHpobUgdXJs77yM5bim5LiKIHVzZXJJZFxuXG53ZWJ2aWV3IC0-IHdlYnZpZXc6IOS_neWtmCAodXNlcklkLCDlh6DnrYnlpZYpIOetieS_oeaBr1xuZGVhY3RpdmF0ZSB3ZWJ2aWV3XG5AZW5kdW1sIiwidXJsIjoiaHR0cHM6Ly9jZG4ubmxhcmsuY29tL3l1cXVlL19fcHVtbC8yNTdlYzRhNmIzNmI2ODkyZWFmYmJkN2ZkYjc0NWUyOS5zdmciLCJpZCI6IkhGRzJGIiwibWFyZ2luIjp7InRvcCI6dHJ1ZSwiYm90dG9tIjp0cnVlfSwiY2FyZCI6ImRpYWdyYW0ifQ==\" alt=\"\"><a name=nCJFv></a></p>\n<h2>结论</h2>\n<p>不能使用！\n<a name=vREhr></a></p>\n<h1>方案一（jwt，不推荐）</h1>\n<p>由于前端 url 的传递参数容易修改，所以需要避开使用前端在不同系统间直接明文传递 userId 的方式。一个很自然的想法就是使用 jwt，将 userId 包装在 jwt 里，由小程序传给 webview。网页端接收到 jwt 后，需要验证 jwt 是否有效。由于 jwt 一旦被篡改，就通不过校验，从而可以防止任意伪造 userId 的情况。\n<a name=IeqHy></a></p>\n<h2>安全性</h2>\n<p>较不安全\n<a name=iVYJT></a></p>\n<h2>开发周期</h2>\n<p>很短\n<a name=eOJYO></a></p>\n<h2>修改范围</h2>\n<ul>\n<li>微信小程序前端，直接传递小程序后端的 jwt 给到 webview</li>\n<li>网页端后端，验证 jwt</li>\n</ul>\n<p><a name=cRfL1></a></p>\n<h2>解决了什么</h2>\n<p>方案零的安全问题。在方案零中，任何人都可以通过猜测 userId，遍历所有网页端保存过的用户信息。采用这个方案，猜测的 userId 会通不过网页端后端的验证。\n<a name=V9Qjg></a></p>\n<h2>不能解决什么</h2>\n<p>被捕获的 jwt，在有效期内，可以被重放攻击。用户 Bob 仍然可以通过拿到用户 Alice 的 jwt，打开网页 url，看到 Alice 的信息。\n<a name=Em7Od></a></p>\n<h2>补救措施</h2>\n<p>同方案零\n<a name=oBq64></a></p>\n<h2>流程</h2>\n<p><img src=\"https://cdn.nlark.com/yuque/__puml/23647a084e1215fe7420ce5146faa2b7.svg#lake_card_v2=eyJ0eXBlIjoicHVtbCIsImNvZGUiOiJAc3RhcnR1bWxcblxuYXV0b251bWJlclxuXG5hY3RvciBcIueUqOaIt1wiIGFzIFVzZXJcbnBhcnRpY2lwYW50IFwid2Vidmlld1wiIGFzIHdlYnZpZXcgI09yYW5nZVxucGFydGljaXBhbnQgXCLnvZHpobXlkI7nq69cIiBhcyB3ZWJ2aWV3X3NlcnZpY2UgI09yYW5nZVxucGFydGljaXBhbnQgXCLlvq7kv6HlsI_nqIvluo9cIiBhcyB3bXBcbnBhcnRpY2lwYW50IFwi5b6u5L-h5bCP56iL5bqP5ZCO56uvXCIgYXMgd21wX3NlcnZpY2VcblxuYWN0aXZhdGUgVXNlclxuXG5Vc2VyIC0-IHdtcDog6L-b5YWl5rS75Yqo6aG16Z2iXG5cbndtcCAtPiB3ZWJ2aWV3OiDliqDovb3mtLvliqjnvZHpobUgdXJsXG5hY3RpdmF0ZSB3ZWJ2aWV3XG5cbndlYnZpZXcgLT4gd2VidmlldyA6IOS6kuWKqFxuXG53ZWJ2aWV3IC0-IHdtcDog6Kem5Y-R55m75b2V5rOo5YaM77yI5Lit5aWW5LqG77yB77yJXG5cbndtcCAtPiB3bXBfc2VydmljZSA6IOeZu-W9leazqOWGjFxud21wIDwtIHdtcF9zZXJ2aWNlIDogand0XG5cbndtcCAtPiB3ZWJ2aWV3X3NlcnZpY2U6IOWbnuiwg-e9kemhtSB1cmzvvIzluKbkuIogand0XG53ZWJ2aWV3X3NlcnZpY2UgLT4gd2Vidmlld19zZXJ2aWNlIDogIOmqjOivgSBqd3RcbmFsdCDmiJDlip_mg4XlhrVcblx0d2Vidmlld19zZXJ2aWNlIC0-IHdlYnZpZXdfc2VydmljZTog5L-d5a2YICh1c2VySWQsIOWHoOetieWllikg562J5L-h5oGvXG5lbHNlIGp3dCDpqozor4HlpLHotKVcblx0d2Vidmlld19zZXJ2aWNlIC0-IHdlYnZpZXc6IOaTjeS9nOWksei0pe-8jOeUqOaIt-WPr-eWkVxuZW5kXG5kZWFjdGl2YXRlIHdlYnZpZXdcbkBlbmR1bWwiLCJ1cmwiOiJodHRwczovL2Nkbi5ubGFyay5jb20veXVxdWUvX19wdW1sLzIzNjQ3YTA4NGUxMjE1ZmU3NDIwY2U1MTQ2ZmFhMmI3LnN2ZyIsImlkIjoidnhsRGYiLCJtYXJnaW4iOnsidG9wIjp0cnVlLCJib3R0b20iOnRydWV9LCJjYXJkIjoiZGlhZ3JhbSJ9\" alt=\"\"><a name=qKr4Z></a></p>\n<h2>前提</h2>\n<p>这个方案由于使用了 jwt，并且要求网页服务器端做验证，所以需要微信小程序后端和网页后端共享颁发 jwt 的密钥。\n<a name=mXUEk></a></p>\n<h2>结论</h2>\n<p>不推荐！<br />因为很难把控第三方开发们，一定做了验证操作。而且，要共享密钥，这不可行。\n<a name=sIT71></a></p>\n<h1>方案二（OAuth 2 客户端凭据许可模式）</h1>\n<p>由于方案零和方案一，本质上都是通过客户端传递 userId，只是一个通过明文，一个通过 jwt。综上所述，这都不安全，所以可以再进一步，去掉客户端交流用户信息的渠道，而改为服务器端来进行 userId 的查询。即让网页端的服务器端来向小程序服务器端查询 userId，但这要求网页服务器端在查询时带上用户的另一信息。考虑到都是在微信生态，可以让网页服务器端查询系统的 userId 时，带上unionId。\n<a name=OTgYk></a></p>\n<h2>安全性</h2>\n<p>较安全\n<a name=UlYMQ></a></p>\n<h2>开发周期</h2>\n<p>较短\n<a name=yy2uh></a></p>\n<h2>修改范围</h2>\n<ul>\n<li>微信小程序后端，OAuth 2 client_credential 授权功能；以及改造原有微信小程序的登录注册流程，在原有的登录注册流程之后，保存一下 unionId, userId 的映射关系，并对受信任的客户端（对微信小程序后端是客户端，但实现上通常是服务器端）开放查询接口。</li>\n<li>网页后端，这个方案需要服务器和服务器间的沟通；另外网页后端要对接微信服务，实现 unionid 的获取功能</li>\n</ul>\n<p><a name=kzobE></a></p>\n<h2>解决了什么</h2>\n<p>由于 url 上不用带上明文或者加密的 userId，用户 Bob 没有机会伪造用户 Alice 的身份，更不能通过猜测 userId 遍历系统用户了。\n<a name=uTIU5></a></p>\n<h2>不能解决什么</h2>\n<p>一旦网页端服务器获取到了服务器端信任的令牌，就可以从微信小程序后端查询任意用户的 userId（不需要用户授权）。所以这个方案并不能防止网页端服务器来遍历会员信息。\n<a name=CITNP></a></p>\n<h2>补救措施</h2>\n<p>一旦发现网页端本身存在不安全的行为，可以立即吊销用于建立服务器端信任的 client id 和 secret，使得网页端服务器不能再使用 userId 的查询接口。</p>\n<p><a name=rgxxu></a></p>\n<h2>流程</h2>\n<ol>\n<li>网页授权拿到了用户的 unionId</li>\n<li>网页服务器端用 unionId，向小程序服务器查询userId （server to server talk 的方式）</li>\n<li>查到直接做后续操作</li>\n<li>没查到拉起小程序登录注册，然后小程序回调网页（webview 方式）</li>\n<li>网页的逻辑回到 2，再次查询。得到 userId，进行后续操作</li>\n</ol>\n<p><a name=x9m7J></a></p>\n<h2>前提</h2>\n<p>网页端使用和小程序在相同的开发平台里绑定到同一公众号主体的账号，授权获取 unionid。\n<a name=KRhh3></a></p>\n<h2>结论</h2>\n<p>在工期紧急的情况下，推荐使用</p>\n<p><a name=mJCoT></a></p>\n<h1>方案三（OAuth 2 授权码许可模式）</h1>\n<p>方案二要求系统信任网页端，从而开放 userId 查询权限给到网页端。注意当把用户的 userId 给到网页端时，不需要经过用户的同意，因为采用了客户端凭据许可模式。</p>\n<p>本方案更进一步，网页端要获取用户的 userId，需要经过用户显式同意，即采用 OAuth 2 的授权码许可模式。</p>\n<p><a name=TWuDL></a></p>\n<h2>安全性</h2>\n<p>更安全\n<a name=vxqR4></a></p>\n<h2>开发周期</h2>\n<p>最长\n<a name=pnubE></a></p>\n<h2>修改范围</h2>\n<ul>\n<li>微信小程序后端采用 OAuth 2 的授权码许可模式</li>\n<li>微信小程序前端增加用户授权第三方查看其信息的页面</li>\n<li>网页端服务器对接 OAuth 2 的流程</li>\n</ul>\n<p><a name=v6FCa></a></p>\n<h2>解决了什么</h2>\n<p>这个方案解决了方案二不能防止网页端遍历系统用户的问题，因为只有用户显式授权，它才能拿到用户信息。\n<a name=bl0hJ></a></p>\n<h2>不能解决什么</h2>\n<p>一旦用户同意，userId 就“泄露”给了网页端。这个网页应用自己保存的（userId, 中奖信息）这个映射关系，由这个网页应用自己负责保证安全。\n<a name=zDP4K></a></p>\n<h2>补救措施</h2>\n<p>如果发现网页端应用本身存在不安全的行为，可以吊销其 clientid/secret，使得该网页端不能再访问微信小程序后端接口。\n<a name=KndtZ></a></p>\n<h2>流程</h2>\n<ol>\n<li>网页端的已有流程（方案二中的网页端要求用户授权，拿用户的 unionid，这一步可以去掉）<br /><strong>2. 网页端拉起小程序，用户登录/注册</strong><br />和小程序自己内部的登录/注册要多一步，即展示一个页面，明确告知用户：该网页应用想使用你的凭据，以获取你的用户信息。措词可以相应修改<br />3. 用户拒绝登录/注册，流程结束<br />4. 用户如果同意，在小程序完成了登录注册流程，那么小程序回调webview，在 url query string 里带上一个后端颁发的临时 code，有效期 5 分钟（防止重放，有效期必须很短，而且限制只能被使用一次）<br />5. 网页端服务器向小程序后端请求授权（client_credential）<br />6. 授权失败，流程结束<br />7. 授权成功，使用server trust access_token 作为凭据，用 code 换取用户的 access_token，scope: userinfo<br />8. 换取失败，流程结束<br />9. 换取成功，使用该用户 access_token，向小程序后端查询用户信息（userId 等等）</li>\n</ol>\n<p><img src=\"https://cdn.nlark.com/yuque/__puml/3e806ec1e530fe1d899bb60f4aa3244f.svg#lake_card_v2=eyJ0eXBlIjoicHVtbCIsImNvZGUiOiJAc3RhcnR1bWxcblxuYXV0b251bWJlclxuXG5hY3RvciBcIueUqCDmiLdcXG7vvIjotYQg5rqQIOaLpSDmnIkg6ICF77yJXCIgYXMgVXNlclxucGFydGljaXBhbnQgXCJ3ZWJ2aWV3XFxu77yI56ysIOS4iSDmlrnvvIlcIiBhcyB3ZWJ2aWV3ICNPcmFuZ2VcbnBhcnRpY2lwYW50IFwi572RIOmhtSDlkI4g56uvXFxu77yI56ysIOS4iSDmlrnvvIlcIiBhcyB3ZWJ2aWV3X3NlcnZpY2UgI09yYW5nZVxucGFydGljaXBhbnQgXCLlvq4g5L-hIOWwjyDnqIsg5bqPXFxu77yI5o6IIOadgyDmnI0g5YqhIOWJjSDnq6_vvIlcIiBhcyB3bXBcbnBhcnRpY2lwYW50IFwi5b6uIOS_oSDlsI8g56iLIOW6jyDlkI4g56uvXFxu77yI5o6IIOadgyDmnI0g5YqhIOWQjiDnq6_vvIlcIiBhcyB3bXBfc2VydmljZVxucGFydGljaXBhbnQgXCJDUk1cXG7vvIjlj5cg5L-dIOaKpCDotYQg5rqQ77yJXCIgYXMgY3JtXG5cbmFjdGl2YXRlIFVzZXJcblxuVXNlciAtPiB3bXA6IOi_myDlhaUg5rS7IOWKqCDpobUg6Z2iXG5cbndtcCAtPiB3ZWJ2aWV3OiDliqAg6L29IOa0uyDliqgg572RIOmhtSB1cmxcbmFjdGl2YXRlIHdlYnZpZXdcblxud2Vidmlld19zZXJ2aWNlIC0-IHdtcF9zZXJ2aWNlOiAg5L2_IOeUqCBhcHBpZC9zZWNyZXQg5o2iIOWPliBzZXJ2ZXIgdHJ1c3QgYWNjZXNzIHRva2VuXG53ZWJ2aWV3X3NlcnZpY2UgPC0gd21wX3NlcnZpY2U6IGFjY2Vzc190b2tlbiwgcmVmcmVzaF90b2tlblxuXG5cbndlYnZpZXcgLT4gd2VidmlldyA6IOS6kiDliqhcblxud2VidmlldyAtPiB3bXA6IOivtyDmsYIg6KemIOWPkSDnlKgg5oi3IOeZuyDlvZUg5rOoIOWGjO-8iOW4piDkuIogYWNjZXNzX3Rva2Vu77yJXG53bXAgLT4gd21wX3NlcnZpY2U6IGFjY2Vzc190b2tlbiDnmoQg5pyNIOWKoSDlmagg56uvIOivtyDmsYIg5bGVIOekuiDnlKgg5oi3IOaOiCDmnYMg6aG1IOmdolxuXG5hbHQg55SoIOaItyDlnKgg5bCPIOeoiyDluo8g5pivIOW3siDnmbsg5b2VIOeKtiDmgIFcbmVsc2Ug55SoIOaItyDlnKgg5bCPIOeoiyDluo8g5pivIOacqiDnmbsg5b2VIOeKtiDmgIFcblx0d21wIC0-IHdtcCA6IOeZuyDlvZUg5rOoIOWGjFxuXHR3bXAgLT4gd21wX3NlcnZpY2U6IGFjY2Vzc190b2tlbiDnmoQg5pyNIOWKoSDlmagg56uvIOivtyDmsYIg5bGVIOekuiDnlKgg5oi3IOaOiCDmnYMg6aG1IOmdolxuZW5kXG5cbndtcF9zZXJ2aWNlIC0-IHdtcF9zZXJ2aWNlOiDpqowg6K-BIGFjY2Vzc190b2tlbiDlr7kg5bqUIOWuoiDmiLcg56uvIOeahCDlkIgg5rOVIOaApyDlj4og55SoIOaItyDnmbsg5b2VIOeKtiDmgIEg44CBIOeUnyDmiJAg5o6IIOadgyDnoIEgY29kZSDlgLxcbndtcF9zZXJ2aWNlIC0-IHdtcDog6YCaIOi_h--8jOWQjCDmhI8g5bGVIOekuiDmjogg5p2DIOmhtSDpnaIg77yMIOmZhCDluKYgICBjb2RlIOWAvFxud21wIC0-IHdtcDog55SoIOaItyDngrkg5Ye7IOWQjCDmhI9cbndtcCAtPiB3ZWJ2aWV3OiDlm54g6LCDIOe9kSDpobUg77yMdXJsIHF1ZXJ5IHN0cmluZyDluKYg5LiKIGNvZGUg5YC8XG5cbndlYnZpZXdfc2VydmljZSAtPiB3bXBfc2VydmljZTog6YCaIOi_hyAgY29kZSDmjaIg5Y-WIOeUqCDmiLcg55qEICBhY2Nlc3NfdG9rZW5cbndtcF9zZXJ2aWNlIC0-IHdtcF9zZXJ2aWNlOiDnlJ8g5oiQIOeUqCDmiLcg57qnIOiuvyDpl64g5LukIOeJjCBhY2Nlc3NfdG9rZW4gXG53ZWJ2aWV3X3NlcnZpY2UgPC0gd21wX3NlcnZpY2U6IOi_lCDlm54g55SoIOaItyDnuqcg6K6_IOmXriDku6Qg54mMIGFjY2Vzc190b2tlblxuXG53ZWJ2aWV3X3NlcnZpY2UgLT4gY3JtOiDkvb8g55SoIOeUqCDmiLcg57qnIGFjY2Vzc190b2tlbiDorr8g6ZeuIHVzZXJJZCDvvIjlj68g6IO9IOi_mCDmmK8g6YCaIOi_hyDlsI8g56iLIOW6jyDlkI4g56uvIOS7oyDnkIbvvIlcbndlYnZpZXdfc2VydmljZSA8LSBjcm06IHVzZXJJZO-8iOWPryDog70g6L-YIOaYryDpgJog6L-HIOWwjyDnqIsg5bqPIOWQjiAg56uvIOS7oyDnkIbvvIlcbndlYnZpZXdfc2VydmljZSAtPiB3ZWJ2aWV3X3NlcnZpY2U6IOS_nSDlrZggKHVzZXJJZCwg5YegIOetiSDlpZYgKSDnrYkg5L-hIOaBr1xuXG5kZWFjdGl2YXRlIHdlYnZpZXdcbkBlbmR1bWwiLCJ1cmwiOiJodHRwczovL2Nkbi5ubGFyay5jb20veXVxdWUvX19wdW1sLzNlODA2ZWMxZTUzMGZlMWQ4OTliYjYwZjRhYTMyNDRmLnN2ZyIsImlkIjoiUlpIcnQiLCJtYXJnaW4iOnsidG9wIjp0cnVlLCJib3R0b20iOnRydWV9LCJjYXJkIjoiZGlhZ3JhbSJ9\" alt=\"\">\n<a name=iuvD6></a></p>\n<h2>结论</h2>\n<p>在时间允许的情况下，最推荐使用这个方案！</p>\n<p><a name=zoinJ></a></p>\n<h1>总结</h1>\n<p>本文列举了在webview中复用微信小程序的登录注册功能以换取用户信息的 4 种方案，今天就写到这里。如果有考虑不周的地方，后面再发文修补，再有时间甚至可以分享关键代码，或者做一个开源代码库。</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","author":"@zizhujy","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[],"slicesMap":{}}