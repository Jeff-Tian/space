{"componentChunkName":"component---src-templates-post-js","path":"/posts/wg2o9o","result":{"data":{"sitePage":null},"pageContext":{"url":"posts/wg2o9o","relativePath":"posts/wg2o9o","frontmatter":{"title":"使用 tplant 快速概览代码的领域模型","stackbit_url_path":"posts/wg2o9o","date":"2021-07-14T12:31:30","excerpt":"","tags":[],"categories":[],"template":"post"},"html":"<p><a name=hImbC></a></p>\n<h1>接地气的 DDD</h1>\n<p>看到技术雷达发表的《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》文章，非常开心，因为它使用了 TypeScript 来做落地说明，这是一个非常接地气的 DDD。</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1626260360282-d973c0bf-a020-4e77-83b4-08eb2fad6275.png#clientId=uca78bb18-1316-4&#x26;from=paste&#x26;height=708&#x26;id=u679523d3&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=945&#x26;originWidth=795&#x26;originalType=binary%E2%88%B6=1&#x26;size=106301&#x26;status=done&#x26;style=none&#x26;taskId=u91e74d28-7e47-450d-84f7-33d53f8f107&#x26;width=596\" alt=\"image.png\"><br />有不接地气的 DDD 吗？参考《领域驱动设计》这本书和相关（主观的）评价：</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1626261980697-99a75daa-6c8b-4dfa-bb5e-6ec9f71fdcbe.png#clientId=uca78bb18-1316-4&#x26;from=paste&#x26;height=520&#x26;id=u4a6cbc7b&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=2079&#x26;originWidth=960&#x26;originalType=binary%E2%88%B6=1&#x26;size=884693&#x26;status=done&#x26;style=none&#x26;taskId=uf01c920a-a3d8-4f68-85a0-2acbaac0658&#x26;width=240\" alt=\"image.png\"><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1626262001643-f55b9ebe-bd63-4ea9-aa0a-b0d3d75b0db7.png#clientId=uca78bb18-1316-4&#x26;from=paste&#x26;height=520&#x26;id=u9868e391&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=2079&#x26;originWidth=960&#x26;originalType=binary%E2%88%B6=1&#x26;size=631969&#x26;status=done&#x26;style=none&#x26;taskId=ubbc78d31-3fa4-4708-b062-89ac7c77276&#x26;width=240\" alt=\"image.png\"></p>\n<p>为什么说《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》就非常接地气了呢？因为采用了 TypeScript。TypeScript 是 JavaScript 语言的超集，既有 JavaScript 所有的好处，又避免了 JavaScript 饱受诟病的动态类型带来的问题。JavaScript 是很强大的，借浏览器这个宿主打遍天下无敌手，又借 NodeJs 渗透到服务器端。如果一定要纠结学习编程从哪门语言开始的话，那么当然是从学习 JavaScript 开始，没有第二种更好的选择。</p>\n<p>TypeScript  基于 JavaScript 构建了类型系统，而《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》则很好地演示了如何通过 TypeScript 的类型系统来设计领域模型。就是说，通过 TypeScript 的类型系统，实现了<strong>代码和领域模型的等价</strong>，不仅能够用它在敏捷开发过程中进行沟通，而且保证跑着的系统真的就是使用了这样的领域模型，也就是说，把<strong>领域驱动设计</strong>落了地。</p>\n<p>如果只设计，不落地，那其实就是在吹牛嘛，不能当真的。多少团队画出的设计图和实际代码天差地别的？我想有经验的程序员心理都清楚。</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1626263737369-9f1ea8a9-00df-4db9-bff8-67b398e25af1.png#clientId=uca78bb18-1316-4&#x26;from=paste&#x26;height=429&#x26;id=uedc84fd3&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=1714&#x26;originWidth=960&#x26;originalType=binary%E2%88%B6=1&#x26;size=655068&#x26;status=done&#x26;style=none&#x26;taskId=u026bbf80-6ef1-4861-b2ff-82e2ec389cc&#x26;width=240\" alt=\"image.png\"></p>\n<p><a name=kwpc5></a></p>\n<h1>到底什么是设计？</h1>\n<p>很多人倾向所谓的设计先行，写代码前先写设计文档，画图。这里隐含的意思是，代码是实现，而不是设计。但是《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》纠正了这一观点：<strong>代码才是设计</strong>。</p>\n<p><a name=ejm6M></a></p>\n<h2>代码=设计=模型=文档</h2>\n<blockquote>\n<p>实际上代码比较擅长表达设计内容，从本质上讲，源代码是一个文档，可以完美地描述产品的每个当前设计决策。</p>\n</blockquote>\n<p>代码是真正的设计，其他只是 PPT。但是《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》也说了，虽然代码是设计，但是领域专家可不一定能读懂代码（虽然 TypeScript 的语法简单易学，但是我估计多数领域专家甚至某些 Java 程序员，是从本能上排斥的），这制约了<strong>代码=模型</strong>这样的等式，存在鸿沟。这也是为什么统一建模语言（UML）大行其道的原因，它是一门表达软件产品的图形化语言。</p>\n<p>既然 UML 是沟通利器，然而容易和代码脱节，正如作者说的：</p>\n<blockquote>\n<p>我还记得我的第一份工作，每当有代码或者设计改动时，都要去更新UML类图以及数据库设计文档。这些文档大概充当着共享模型的作用，但是最终这些设计类图和文档都慢慢变得不可信，因为没有任何手段保证文档会被及时跟新。</p>\n</blockquote>\n<p><a name=CFRty></a></p>\n<h1>终极解决方案</h1>\n<p>UML 是一种视图。就像任何编程语言，其实本质上只是二进制指令的一种高级视图。既然最终运行的软件跑的是二进制指令，而我们可以用高级语言去查看，那么同样我们也可以把源代码已一种图形化的方式去查看。也就是说，将人工绘制 UML 图，变成自动生成，那么就不存在代码和 UML 图脱节的问题了。想用 UML 视图查看源代码哪个版本，就基于该版本生成一份 UML 图就好。</p>\n<p><a name=vmm9W></a></p>\n<h2>tplant</h2>\n<p>如果我们使用 TypeScript 来做开发，那么已经有开源工具可以自动从 TypeScript 代码生成 UML 图了，这个工具就是本人参与开发的 tplant！</p>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/png/221736/1626264833396-17bda686-ae76-4913-9bf3-01093fbdcdce.png#clientId=uca78bb18-1316-4&#x26;from=paste&#x26;height=617&#x26;id=u4a4eef8c&#x26;margin=%5Bobject%20Object%5D&#x26;name=image.png&#x26;originHeight=823&#x26;originWidth=783&#x26;originalType=binary%E2%88%B6=1&#x26;size=111063&#x26;status=done&#x26;style=none&#x26;taskId=ucb6f62a4-c2f7-4c7b-a82b-f86c4a3593a&#x26;width=587\" alt=\"image.png\"></p>\n<p><a name=rPOTa></a></p>\n<h3>使用录屏</h3>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2021/gif/221736/1626265392155-bdcfac7c-afae-49b3-aac9-4d8da3f22ea8.gif#clientId=uca78bb18-1316-4&#x26;from=ui&#x26;id=u766e60c7&#x26;margin=%5Bobject%20Object%5D&#x26;name=ezgif-6-2c40c759e0f7.gif&#x26;originHeight=422&#x26;originWidth=600&#x26;originalType=binary%E2%88%B6=1&#x26;size=9037162&#x26;status=done&#x26;style=none&#x26;taskId=uac47f979-5597-46d5-a75a-23d7dc073f1\" alt=\"ezgif-6-2c40c759e0f7.gif\"></p>\n<p><a name=r2x7y></a></p>\n<h3>文字版使用说明</h3>\n<p>shell\nnpm install --global tplant\ncd your-typescript-project-folder\ntplant --input src/**/*.ts --output output.svg\nopen output.svg</p>\n<p><a name=tuNI4></a></p>\n<h1>总结</h1>\n<p>尽管《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》使用了 TypeScript 将 DDD 落地，但是在和不愿意看代码的人之间仍然存在沟通鸿沟。本文厚着脸皮推荐了自己参与开发的一个开源工具 tplant，将 TypeScript 自动转成 UML，弥补了《<a href=\"https://zhuanlan.zhihu.com/p/388845844\">使用函数式语言建立领域模型</a>》唯一的缺憾。</p>\n<p>如果有人说连 UML 都不愿意看，说只想看 PPT，那么请他自行开发一个将代码转成 PPT 的工具吧。总之，不要相信 PPT，一切文档都应该基于代码生成。</p>","pages":[],"site":{"siteMetadata":{"title":"Jeff Tian","description":"A wild full stack developer","palette":"yellow","header":{"title":"Jeff Tian","tagline":"A wild developer","logo_img":"https://images.ctfassets.net/qixg1o8tujmf/7z1ua3nTOC5B7DwwzAki8I/4e1a05f8db770c285a492eeb1eaa398f/imageedit_3_2509022194.png","background_img":"https://images.ctfassets.net/qixg1o8tujmf/7m0jrKYaDBwEvlc5lo8nt6/6d50a5050d9cdc0d4d2047e35feac292/10648733_696750647079056_2800539603462658695_o.jpg","has_nav":true,"nav_links":[{"label":"Home","url":"/","style":"link","type":"action"},{"label":"About","url":"/about","style":"link","type":"action"},{"label":"关于","url":"https://ggyy.pa-pa.me/about","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"},{"label":"Contact","url":"/contact","style":"link","type":"action"},{"label":"Support Me","url":"/support-me","style":"link","type":"action"},{"label":"叽叽歪歪","url":"https://ggyy.pa-pa.me/","style":"link","icon_class":"lorem-ipsum","new_window":true,"type":"action"}],"has_social":true,"social_links":[{"label":"Twitter","url":"https://twitter.com/zizhujy","style":"icon","icon_class":"fa-twitter","new_window":true,"type":"action"},{"label":"Instagram","url":"https://www.instagram.com/jefftian5","style":"icon","icon_class":"fa-instagram","new_window":true,"type":"action"},{"label":"GitHub","url":"https://github.com/jeff-tian","style":"icon","icon_class":"fa-github","new_window":true,"type":"action"},{"label":"LinkedIn","url":"https://www.linkedin.com/jeff~tian","style":"icon","icon_class":"fa-linkedin","new_window":true,"type":"action"},{"label":"DEV","url":"https://dev.to/jefftian","style":"icon","icon_class":"fa-dev","new_window":true,"type":"action"},{"label":"知乎","url":"https://www.zhihu.com/people/jefftian","style":"icon","icon_class":"fa-zhihu","new_window":true,"type":"action"}],"type":"header"},"footer":{"content":"&copy; All rights reserved.","links":[{"label":"Made with Stackbit.","url":"https://www.stackbit.com","style":"link","new_window":true,"type":"action"},{"label":"紫竹叽歪","url":"https://zizhujy.apphb.com","style":"link","icon_class":"http://zizhujy.apphb.com/Content/Images/logo.png","new_window":true,"type":"action"}],"type":"footer"}},"pathPrefix":"","data":{"data":{"author":{"name":"Jeff Tian","avatar":"https://res.cloudinary.com/practicaldev/image/fetch/s--a5qDZLv3--/c_fill,f_auto,fl_progressive,h_640,q_auto,w_640/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/318420/3bfd2d99-430c-4049-8dd5-e2adc961e1e0.png"},"social":{"devto":{"username":"jefftian"},"twitter":{"username":"zizhujy"},"github":{"username":"Jeff-Tian"}}}}},"menus":{}}},"staticQueryHashes":[]}